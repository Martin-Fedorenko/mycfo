"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[3381],{12043:(e,s,t)=>{t.d(s,{A:()=>a});var r=t(14057),n=t(70579);const a=(0,r.A)((0,n.jsx)("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2"}),"MoreVert")},38915:(e,s,t)=>{t.d(s,{A:()=>g});var r=t(79722),n=t(35644),a=t(29296),o=t(13658);const i=r.A.create(),l=o.A.PRONOSTICO,c={UserPoolId:"sa-east-1_lTMNrWW7R",ClientId:"3ksssqtg3r49rf6js1t1177hrd"};let d=null,u=!1;const p=e=>Boolean(e&&l&&String(e).startsWith(String(l))),h=e=>{try{return sessionStorage.getItem(e)}catch(s){return console.warn("No se pudo leer sessionStorage:",s),null}},m=(e,s)=>{try{void 0!==s&&null!==s&&sessionStorage.setItem(e,s)}catch(t){console.warn("No se pudo escribir en sessionStorage:",t)}},A=()=>{if(!u){u=!0;try{sessionStorage.clear()}catch(e){}null!==a.m&&void 0!==a.m&&a.m.limpiarSesion&&a.m.limpiarSesion(),"undefined"!==typeof window&&(window.location.href="/#/signin")}},x=()=>{const e=h("refreshToken"),s=(()=>{const e=h("email")||h("username");if(!e||!c.UserPoolId||!c.ClientId)return null;const s=new n.NE(c);return new n.TU({Username:e,Pool:s})})();if(!e||!s)return Promise.reject(new Error("No hay datos para renovar la sesi\xf3n."));const t=new n.c9({RefreshToken:e});return new Promise((e,r)=>{s.refreshSession(t,(s,t)=>{if(s)return void r(s);const n=t.getAccessToken().getJwtToken(),a=t.getIdToken().getJwtToken(),o=t.getRefreshToken().getToken();m("accessToken",n),m("idToken",a),o&&m("refreshToken",o),e(n)})})};i.interceptors.request.use(e=>{const s=sessionStorage.getItem("accessToken");if(p(e.url)){var t;e.headers=null!==(t=e.headers)&&void 0!==t?t:{},s&&(e.headers.Authorization="Bearer ".concat(s));const r=sessionStorage.getItem("sub");r&&(e.headers["X-Usuario-Sub"]=r)}return e}),i.interceptors.response.use(e=>e,async e=>{const{config:s,response:t}=e;if(!s||!t||401!==t.status||!p(s.url))return Promise.reject(e);if(s.__isRetryRequest)return A(),Promise.reject(e);try{var r;const e=await(d||(d=x().then(e=>(d=null,e)).catch(e=>{throw d=null,e})),d);if(!e)throw new Error("No se obtuvo un token renovado.");return s.__isRetryRequest=!0,s.headers=null!==(r=s.headers)&&void 0!==r?r:{},s.headers.Authorization="Bearer ".concat(e),i(s)}catch(n){return A(),Promise.reject(n)}});const g=i},63381:(e,s,t)=>{t.r(s),t.d(s,{default:()=>re});var r=t(65043),n=t(89379),a=t(53969),o=t(12097),i=t(86172),l=t(81341),c=t(26529),d=t(56647),u=t(55895),p=t(76943),h=t(26687),m=t(10256),A=t(3353),x=t(9446),g=t(88889),v=t(24343),b=t(91449),j=t(94527),f=t(94799),y=t(87443),C=t(34375),S=t(10756),w=t(56465),P=t(46471),N=t(38517),E=t(81911),T=t(78776),_=t(85877),R=t(80172),k=t(32911),I=t(60267),z=t(89826),M=t(29001),O=t(38915),L=t(88746),D=t(14057),U=t(70579);const W=(0,D.A)((0,U.jsx)("path",{d:"M19 4h-3.5l-1-1h-5l-1 1H5v2h14zM6 7v12c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7zm8 7v4h-4v-4H8l4-4 4 4z"}),"RestoreFromTrash");var B=t(12043),H=t(13658);const F={backgroundColor:"rgba(255, 255, 255, 0.02)","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.05)"}},V=e=>({border:"1px solid ".concat((e.vars||e).palette.divider)}),q=e=>(0,n.A)((0,n.A)({},V(e)),{},{fontWeight:600}),K=e=>({nombre:{width:"deleted"===e?"20%":"25%"},desde:{width:"deleted"===e?"20%":"25%"},hasta:{width:"deleted"===e?"20%":"25%"},eliminado:{width:"20%"},acciones:{width:"deleted"===e?"20%":"25%"}}),G=["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],X=e=>String(e).padStart(2,"0"),Y=(e,s)=>new Date(e,s,0).getDate(),Z=()=>{const e=Number({NODE_ENV:"production",PUBLIC_URL:"/mycfo",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AWS_REGION:"sa-east-1",REACT_APP_BASE_URL:"https://managers-voip-made-imperial.trycloudflare.com",REACT_APP_COGNITO_CLIENT_ID:"3ksssqtg3r49rf6js1t1177hrd",REACT_APP_COGNITO_USER_POOL_ID:"sa-east-1_lTMNrWW7R",REACT_APP_URL_ADMINISTRACION:"https://managers-voip-made-imperial.trycloudflare.com/administracion",REACT_APP_URL_IA:"https://managers-voip-made-imperial.trycloudflare.com/ia",REACT_APP_URL_NOTIFICACION:"https://managers-voip-made-imperial.trycloudflare.com/notificacion",REACT_APP_URL_PRONOSTICO:"https://managers-voip-made-imperial.trycloudflare.com/pronostico",REACT_APP_URL_REGISTRO:"https://managers-voip-made-imperial.trycloudflare.com/registro",REACT_APP_URL_REPORTE:"https://managers-voip-made-imperial.trycloudflare.com/reporte",REACT_APP_WEBSOCKET_URL:"https://managers-voip-made-imperial.trycloudflare.com/notificacion/ws"}.REACT_APP_PRESUPUESTO_RETENTION_DAYS);return Number.isNaN(e)||e<=0?90:e},J=e=>{if(!e)return"-";const s=new Date(e);return Number.isNaN(s.valueOf())?e:s.toLocaleString("es-AR",{hour12:!1})},Q=3,$="createdAt,desc",ee=()=>({content:[],totalElements:0,totalPages:0,number:0,size:Q}),se=e=>{let{label:s,ghost:t}=e;return(0,U.jsxs)(a.A,{sx:{position:"relative",display:"inline-flex"},children:[(0,U.jsx)(a.A,{"aria-hidden":!0,sx:{visibility:"hidden",pointerEvents:"none",display:"inline-flex",whiteSpace:"nowrap"},children:t}),(0,U.jsx)(a.A,{sx:{position:"absolute",inset:0,display:"grid",placeItems:"center",whiteSpace:"nowrap"},children:s})]})};function te(){var e,s,t,D,te,re,ne,ae;const oe=(0,I.A)(),ie="light"===oe.palette.mode,le=null!==(e=null===(s=oe.vars)||void 0===s?void 0:s.palette)&&void 0!==e?e:oe.palette,ce=ie?null!==(t=null===(D=le.text)||void 0===D?void 0:D.primary)&&void 0!==t?t:"#000":null!==(te=null===(re=le.common)||void 0===re?void 0:re.white)&&void 0!==te?te:"#fff",de=ie?void 0:{color:"#42897f"},ue=(0,M.Zp)(),pe=H.A.PRONOSTICO,he=r.useMemo(()=>Z(),[]),[me,Ae]=r.useState("active"),[xe,ge]=r.useState(0),[ve,be]=r.useState(ee),[je,fe]=r.useState(!1),[ye,Ce]=r.useState(null),[Se,we]=r.useState(0),[Pe,Ne]=r.useState(""),[Ee,Te]=r.useState({year:"",fromMonth:"",toMonth:""}),[_e,Re]=r.useState(""),[ke,Ie]=r.useState(""),[ze,Me]=r.useState(!1),[Oe,Le]=r.useState(!1),[De,Ue]=r.useState({open:!1,presupuesto:null}),[We,Be]=r.useState({open:!1,message:"",action:null}),[He,Fe]=r.useState(null),[Ve,qe]=r.useState({anchorEl:null,presupuesto:null}),[Ke,Ge]=r.useState(()=>{const e=(new Date).getFullYear();return[e-1,e,e+1]}),Xe=r.useRef(""),Ye=r.useRef(null),Ze=r.useCallback(e=>{if(!e)return"";const[s,t]=e.split("-"),r=Number(t)-1;return r>=0&&r<G.length?"".concat(G[r]," ").concat(s):e},[]),Je=r.useCallback(e=>{Array.isArray(e)&&0!==e.length&&Ge(s=>{const t=new Set(s);return e.forEach(e=>{var s,r;const n=Number(null===e||void 0===e||null===(s=e.desde)||void 0===s?void 0:s.split("-")[0]),a=Number(null===e||void 0===e||null===(r=e.hasta)||void 0===r?void 0:r.split("-")[0]);Number.isNaN(n)||t.add(n),Number.isNaN(a)||t.add(a)}),Array.from(t).sort((e,s)=>e-s)})},[]),Qe=r.useCallback(e=>{if(!e||"object"!==typeof e)return ee();const s=Array.isArray(e.content)?e.content:[],t=Number(e.totalElements),r=Number(e.totalPages),n=Number(e.number),a=Number(e.size);return{content:s,totalElements:Number.isFinite(t)?t:s.length,totalPages:Number.isFinite(r)?r:s.length>0?1:0,number:Number.isFinite(n)?n:0,size:Number.isFinite(a)&&a>0?a:Q}},[]),$e=r.useCallback(async(e,s)=>{Le(!0);try{const t=Pe.trim().length>=2,r=t?0:Math.max(s,0),n=t?1e3:Q,a=new URLSearchParams;a.set("status",e),a.set("page",String(r)),a.set("size",String(n)),a.set("sort",$);const o=await O.A.get("".concat(pe,"/api/presupuestos?").concat(a.toString())),i=Qe(o.data);if(!t&&s>0&&i.totalPages>0&&s>=i.totalPages)return void ge(i.totalPages-1);be(i),Je(i.content),Ie(""),t&&0!==s&&ge(0)}catch(t){console.error("Error cargando presupuestos desde el backend:",t),be(ee()),Ie("No se pudo cargar la lista de presupuestos. Intenta nuevamente.")}finally{Le(!1)}},[pe,Je,Qe,Pe]),es=r.useCallback(async(e,s,t)=>{Me(!0);try{const r=new URLSearchParams(e||"");r.set("status",s),r.set("page",String(Math.max(t,0))),r.set("size",String(Q)),r.set("sort",$);const n=await O.A.get("".concat(pe,"/api/presupuestos?").concat(r.toString())),a=Qe(n.data);if(t>0&&a.totalPages>0&&t>=a.totalPages)return void we(a.totalPages-1);Ce(a),Je(a.content),Re("")}catch(r){console.error("Error cargando presupuestos desde el backend:",r),Ce(ee()),Re("No se pudo cargar la lista filtrada. Intenta nuevamente.")}finally{Me(!1)}},[pe,Je,Qe]);r.useEffect(()=>{$e(me,xe)},[$e,me,xe]);r.useEffect(()=>{qe({anchorEl:null,presupuesto:null})},[me]);const ss=()=>{qe({anchorEl:null,presupuesto:null})},ts=r.useCallback(()=>{Ue({open:!1,presupuesto:null})},[]),rs=r.useCallback(async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Presupuesto restaurado.";if(e)try{await O.A.post("".concat(pe,"/api/presupuestos/").concat(e.id,"/restore")),await $e(me,xe),je&&Xe.current&&await es(Xe.current,me,Se),s&&Be({open:!0,message:s,action:null}),Ie("")}catch(t){console.error("Error restaurando presupuesto:",t),Be({open:!0,message:"No se pudo restaurar el presupuesto.",action:null})}},[pe,$e,es,je,xe,Se,me]),ns=r.useCallback(e=>{rs(e,"Presupuesto restaurado.")},[rs]),as=r.useCallback(async()=>{const e=Ye.current;e?(Ye.current=null,await rs(e,"Presupuesto restaurado.")):Be(e=>(0,n.A)((0,n.A)({},e),{},{open:!1}))},[rs]),os=He===(null===(ne=De.presupuesto)||void 0===ne?void 0:ne.id),is=r.useMemo(()=>G.map((e,s)=>({value:String(s+1),label:e.charAt(0).toUpperCase()+e.slice(1)})),[]),ls="deleted"===me?5:4,cs=Number(ve.totalPages)||0,ds=cs>0?ve.number+1:1,us=ye&&Number(ye.totalPages)||0,ps=us>0&&ye?ye.number+1:1,hs=r.useMemo(()=>{const e=Pe.trim().toLowerCase(),s=Array.isArray(ve.content)?ve.content:[];return e?s.filter(s=>{const t=((null===s||void 0===s?void 0:s.nombre)||"").toLowerCase(),r=((null===s||void 0===s?void 0:s.desde)||"").toLowerCase(),n=((null===s||void 0===s?void 0:s.hasta)||"").toLowerCase(),a=Ze((null===s||void 0===s?void 0:s.desde)||"").toLowerCase(),o=Ze((null===s||void 0===s?void 0:s.hasta)||"").toLowerCase();return t.includes(e)||r.includes(e)||n.includes(e)||a.includes(e)||o.includes(e)}):s},[ve.content,Pe,Ze]),ms=e=>s=>{const t=s.target.value;Te(s=>(0,n.A)((0,n.A)({},s),{},{[e]:t}))},As=e=>e.map(e=>{const s=encodeURIComponent((e.nombre||"").trim().toLowerCase().replace(/\s+/g,"-")),t="deleted"===me,r=Boolean(Ve.anchorEl)&&Ve.presupuesto&&Ve.presupuesto.id===e.id,u=r?"presupuesto-actions-menu":void 0,p="acciones-presupuesto-".concat(e.id);return(0,U.jsxs)(i.A,{sx:F,children:[(0,U.jsx)(l.A,{sx:e=>(0,n.A)((0,n.A)({},V(e)),K(me).nombre),children:e.nombre}),(0,U.jsx)(l.A,{sx:e=>(0,n.A)((0,n.A)({},V(e)),K(me).desde),children:Ze(e.desde)}),(0,U.jsx)(l.A,{sx:e=>(0,n.A)((0,n.A)({},V(e)),K(me).hasta),children:Ze(e.hasta)}),t&&(0,U.jsx)(l.A,{sx:e=>(0,n.A)((0,n.A)({},V(e)),K(me).eliminado),children:J(e.deletedAt)}),(0,U.jsx)(l.A,{sx:e=>(0,n.A)((0,n.A)({},V(e)),K(me).acciones),align:"right",children:t?(0,U.jsx)(o.A,{variant:"outlined",size:"small",startIcon:(0,U.jsx)(W,{}),onClick:()=>ns(e),children:"Restaurar"}):(0,U.jsxs)(a.A,{sx:{display:"flex",justifyContent:"flex-end",gap:1},children:[(0,U.jsx)(o.A,{variant:"outlined",size:"small",onClick:()=>ue("/presupuestos/".concat(s)),sx:de,children:"Ver detalle"}),(0,U.jsx)(c.A,{title:"M\xe1s acciones",children:(0,U.jsx)(d.A,{size:"small","aria-label":"M\xe1s acciones","aria-controls":u,"aria-haspopup":"true","aria-expanded":r?"true":void 0,id:p,onClick:s=>((e,s)=>{qe({anchorEl:e.currentTarget,presupuesto:s})})(s,e),children:(0,U.jsx)(B.A,{fontSize:"small"})})})]})})]},e.id)}),xs=r.useMemo(()=>Array.isArray(null===ve||void 0===ve?void 0:ve.content)&&ve.content.length?ve.content[0]:null,[null===ve||void 0===ve?void 0:ve.content]),gs=r.useMemo(()=>ye&&Array.isArray(ye.content)&&ye.content.length?ye.content[0]:null,[ye]),vs={nombre:(null===xs||void 0===xs?void 0:xs.nombre)||"Nombre de ejemplo",desde:Ze((null===xs||void 0===xs?void 0:xs.desde)||"2025-01"),hasta:Ze((null===xs||void 0===xs?void 0:xs.hasta)||"2025-12"),eliminado:J((null===xs||void 0===xs?void 0:xs.deletedAt)||"2025-10-14T20:21:43Z")},bs={nombre:(null===gs||void 0===gs?void 0:gs.nombre)||"Nombre de ejemplo",desde:Ze((null===gs||void 0===gs?void 0:gs.desde)||"2025-01"),hasta:Ze((null===gs||void 0===gs?void 0:gs.hasta)||"2025-12"),eliminado:J((null===gs||void 0===gs?void 0:gs.deletedAt)||"2025-10-14T20:21:43Z")};return(0,U.jsxs)(a.A,{sx:{width:"100%",p:3},children:[(0,U.jsx)(u.A,{variant:"h4",gutterBottom:!0,children:"Presupuestos"}),(0,U.jsx)(u.A,{variant:"subtitle1",gutterBottom:!0,children:"Visualiza tus presupuestos creados o genera uno nuevo"}),(0,U.jsxs)(p.A,{value:me,onChange:(e,s)=>{s!==me&&(Ae(s),ge(0),fe(!1),Ce(null),we(0),Re(""),Xe.current="")},sx:{mt:1},children:[(0,U.jsx)(h.A,{value:"active",label:"Activos",sx:{color:ce,"&.Mui-selected":{color:ce},"& .MuiTab-wrapper":{color:ce}}}),(0,U.jsx)(h.A,{value:"deleted",label:"Borrados",sx:{color:ce,"&.Mui-selected":{color:ce},"& .MuiTab-wrapper":{color:ce}}})]}),(0,U.jsx)(u.A,{variant:"caption",sx:{display:"block",mb:2,color:"text.primary"},children:"Los presupuestos se purgan de forma definitiva a los ".concat(he," d\xedas.")}),(0,U.jsxs)(a.A,{sx:{display:"flex",flexWrap:"wrap",gap:2,alignItems:"center",mt:2,mb:2},children:[(0,U.jsxs)(m.A,{size:"small",sx:{minWidth:120},children:[(0,U.jsx)(A.A,{id:"presupuesto-year-label",children:"A\xf1o"}),(0,U.jsxs)(x.A,{labelId:"presupuesto-year-label",value:Ee.year,label:"A\xf1o",onChange:ms("year"),children:[(0,U.jsx)(g.A,{value:"",children:(0,U.jsx)("em",{children:"Todos"})}),Ke.map(e=>(0,U.jsx)(g.A,{value:String(e),children:e},e))]})]}),(0,U.jsxs)(m.A,{size:"small",sx:{minWidth:150},children:[(0,U.jsx)(A.A,{id:"presupuesto-from-label",children:"Desde (mes)"}),(0,U.jsxs)(x.A,{labelId:"presupuesto-from-label",value:Ee.fromMonth,label:"Desde (mes)",onChange:ms("fromMonth"),children:[(0,U.jsx)(g.A,{value:"",children:(0,U.jsx)("em",{children:"Sin filtro"})}),is.map(e=>(0,U.jsx)(g.A,{value:e.value,children:e.label},e.value))]})]}),(0,U.jsxs)(m.A,{size:"small",sx:{minWidth:150},children:[(0,U.jsx)(A.A,{id:"presupuesto-to-label",children:"Hasta (mes)"}),(0,U.jsxs)(x.A,{labelId:"presupuesto-to-label",value:Ee.toMonth,label:"Hasta (mes)",onChange:ms("toMonth"),children:[(0,U.jsx)(g.A,{value:"",children:(0,U.jsx)("em",{children:"Sin filtro"})}),is.map(e=>(0,U.jsx)(g.A,{value:e.value,children:e.label},e.value))]})]}),(0,U.jsx)(o.A,{variant:"contained",onClick:()=>{Re("");const e=new URLSearchParams,s=Boolean(Ee.year),t=Boolean(Ee.fromMonth),r=Boolean(Ee.toMonth);if(t||r){if(!t||!r)return void Re("Debes seleccionar ambos meses para armar el rango.");const n=s?Number(Ee.year):(new Date).getFullYear(),a=Number(Ee.fromMonth),o=Number(Ee.toMonth);if(a>o)return void Re("El mes Desde no puede ser posterior al mes Hasta.");const i="".concat(n,"-").concat(X(a),"-01"),l="".concat(n,"-").concat(X(o),"-").concat(X(Y(n,o)));e.set("from",i),e.set("to",l)}else if(s){"".concat(Ee.year,"-01-01"),"".concat(Ee.year,"-12-31");e.set("year",Ee.year)}const n=e.toString();if(!n)return fe(!1),Ce(null),we(0),void(Xe.current="");fe(!0),we(0),Xe.current=n,es(n,me,0)},disabled:ze,children:"Buscar"}),(0,U.jsx)(o.A,{variant:"text",onClick:()=>{Te({year:"",fromMonth:"",toMonth:""}),Ne(""),Re(""),fe(!1),Ce(null),we(0),Xe.current=""},disabled:ze,children:"Limpiar"})]}),(0,U.jsx)(v.A,{label:"Buscar por nombre, mes o a\xf1o",variant:"outlined",size:"small",value:Pe,onChange:e=>Ne(e.target.value),sx:{mt:1,mb:2,width:{xs:"100%",sm:250}}}),_e&&(0,U.jsx)(b.A,{severity:"error",sx:{mb:2},children:_e}),je&&(0,U.jsxs)(U.Fragment,{children:[(0,U.jsxs)(a.A,{sx:{mt:4,mb:2},children:[(0,U.jsx)(u.A,{variant:"subtitle1",sx:{fontWeight:600,mb:1},children:"Resultado de la b\xfasqueda"}),(0,U.jsx)(j.A,{})]}),(0,U.jsx)(f.A,{sx:e=>({width:"100%",mb:3,overflowX:"auto",p:0,bgcolor:(0,z.X4)(e.palette.primary.main,"dark"===e.palette.mode?.12:.06),border:"1px solid ".concat((e.vars||e).palette.divider)}),children:ze?(0,U.jsx)(y.A,{children:(0,U.jsx)(C.A,{children:(0,U.jsx)(i.A,{children:(0,U.jsx)(l.A,{colSpan:ls,sx:e=>(0,n.A)((0,n.A)({},V(e)),{},{textAlign:"center",py:3}),children:"Cargando presupuestos..."})})})}):ye&&Array.isArray(ye.content)&&ye.content.length>0?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsxs)(y.A,{children:[(0,U.jsx)(S.A,{children:(0,U.jsxs)(i.A,{sx:F,children:[(0,U.jsx)(l.A,{sx:e=>(0,n.A)((0,n.A)({},q(e)),K(me).nombre),align:"left",children:(0,U.jsx)(se,{label:"Nombre",ghost:bs.nombre})}),(0,U.jsx)(l.A,{sx:e=>(0,n.A)((0,n.A)({},q(e)),K(me).desde),align:"left",children:(0,U.jsx)(se,{label:"Desde",ghost:bs.desde})}),(0,U.jsx)(l.A,{sx:e=>(0,n.A)((0,n.A)({},q(e)),K(me).hasta),align:"left",children:(0,U.jsx)(se,{label:"Hasta",ghost:bs.hasta})}),"deleted"===me&&(0,U.jsx)(l.A,{sx:e=>(0,n.A)((0,n.A)({},q(e)),K(me).eliminado),align:"left",children:(0,U.jsx)(se,{label:"Eliminados",ghost:bs.eliminado})}),(0,U.jsx)(l.A,{sx:e=>(0,n.A)((0,n.A)({},q(e)),K(me).acciones),align:"right",children:(0,U.jsxs)(a.A,{sx:{position:"relative",display:"inline-flex"},children:[(0,U.jsxs)(a.A,{"aria-hidden":!0,sx:{visibility:"hidden",pointerEvents:"none",display:"inline-flex",alignItems:"center",gap:1},children:[(0,U.jsx)(o.A,{variant:"outlined",size:"small",sx:de,children:"Ver detalle"}),(0,U.jsx)(d.A,{size:"small",children:(0,U.jsx)(B.A,{fontSize:"small"})})]}),(0,U.jsx)(a.A,{sx:{position:"absolute",inset:0,display:"grid",placeItems:"center",whiteSpace:"nowrap",fontWeight:600},children:"Acciones"})]})})]})}),(0,U.jsx)(C.A,{children:As(ye.content)})]}),us>1&&(0,U.jsx)(a.A,{mt:2,display:"flex",justifyContent:"center",children:(0,U.jsx)(w.A,{color:"primary",size:"small",count:us,page:ps,onChange:(e,s)=>{if(!je||!Xe.current)return;const t=Number(s)-1;Number.isNaN(t)||t<0||(we(t),es(Xe.current,me,t))},siblingCount:0,boundaryCount:1,"aria-label":"Paginacion de resultados de presupuestos",getItemAriaLabel:(e,s)=>{switch(e){case"page":default:return"Ir a la pagina ".concat(s," de resultados");case"previous":return"Pagina anterior de resultados";case"next":return"Pagina siguiente de resultados"}}})})]}):!_e&&(0,U.jsx)(b.A,{severity:"info",children:"No encontramos presupuestos para el rango seleccionado."})})]}),(0,U.jsxs)(a.A,{sx:{mt:4,mb:2},children:[(0,U.jsx)(u.A,{variant:"subtitle1",sx:{fontWeight:600,mb:1},children:"Listado completo"}),(0,U.jsx)(j.A,{})]}),ke&&(0,U.jsx)(b.A,{severity:"error",sx:{mb:2},children:ke}),(0,U.jsx)(f.A,{sx:{width:"100%",overflowX:"auto"},children:(0,U.jsxs)(y.A,{children:[(0,U.jsx)(S.A,{children:(0,U.jsxs)(i.A,{sx:F,children:[(0,U.jsx)(l.A,{sx:e=>(0,n.A)((0,n.A)({},q(e)),K(me).nombre),align:"left",children:(0,U.jsx)(se,{label:"Nombre",ghost:vs.nombre})}),(0,U.jsx)(l.A,{sx:e=>(0,n.A)((0,n.A)({},q(e)),K(me).desde),align:"left",children:(0,U.jsx)(se,{label:"Desde",ghost:vs.desde})}),(0,U.jsx)(l.A,{sx:e=>(0,n.A)((0,n.A)({},q(e)),K(me).hasta),align:"left",children:(0,U.jsx)(se,{label:"Hasta",ghost:vs.hasta})}),"deleted"===me&&(0,U.jsx)(l.A,{sx:e=>(0,n.A)((0,n.A)({},q(e)),K(me).eliminado),align:"left",children:(0,U.jsx)(se,{label:"Eliminados",ghost:vs.eliminado})}),(0,U.jsx)(l.A,{sx:e=>(0,n.A)((0,n.A)({},q(e)),K(me).acciones),align:"right",children:(0,U.jsxs)(a.A,{sx:{position:"relative",display:"inline-flex"},children:[(0,U.jsxs)(a.A,{"aria-hidden":!0,sx:{visibility:"hidden",pointerEvents:"none",display:"inline-flex",alignItems:"center",gap:1},children:[(0,U.jsx)(o.A,{variant:"outlined",size:"small",sx:de,children:"Ver detalle"}),(0,U.jsx)(d.A,{size:"small",children:(0,U.jsx)(B.A,{fontSize:"small"})})]}),(0,U.jsx)(a.A,{sx:{position:"absolute",inset:0,display:"grid",placeItems:"center",whiteSpace:"nowrap",fontWeight:600},children:"Acciones"})]})})]})}),(0,U.jsxs)(C.A,{children:[hs.length>0&&As(hs),0===hs.length&&!Oe&&!ke&&(0,U.jsx)(i.A,{children:(0,U.jsx)(l.A,{colSpan:ls,sx:e=>(0,n.A)((0,n.A)({},V(e)),{},{textAlign:"center",py:3}),children:"No hay presupuestos para mostrar."})}),Oe&&(0,U.jsx)(i.A,{children:(0,U.jsx)(l.A,{colSpan:ls,sx:e=>(0,n.A)((0,n.A)({},V(e)),{},{textAlign:"center",py:3}),children:"Cargando presupuestos..."})})]})]})}),cs>1&&(0,U.jsx)(a.A,{mt:2,display:"flex",justifyContent:"center",children:(0,U.jsx)(w.A,{color:"primary",size:"small",count:cs,page:ds,onChange:(e,s)=>{const t=Number(s)-1;Number.isNaN(t)||t<0||ge(t)},siblingCount:0,boundaryCount:1,"aria-label":"Paginacion de presupuestos",getItemAriaLabel:(e,s)=>{switch(e){case"page":default:return"Ir a la pagina ".concat(s," de presupuestos");case"previous":return"Pagina anterior de presupuestos";case"next":return"Pagina siguiente de presupuestos"}}})}),(0,U.jsx)(a.A,{mt:3,children:(0,U.jsx)(o.A,{variant:"contained",onClick:()=>ue("/presupuestos/nuevo"),children:"Crear nuevo presupuesto"})}),(0,U.jsx)(P.A,{id:"presupuesto-actions-menu",anchorEl:Ve.anchorEl,open:Boolean(Ve.anchorEl),onClose:ss,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},keepMounted:!0,MenuListProps:{"aria-labelledby":Ve.presupuesto?"acciones-presupuesto-".concat(Ve.presupuesto.id):void 0},children:(0,U.jsxs)(g.A,{onClick:()=>{const e=Ve.presupuesto;ss(),e&&(e=>{Fe(null),Ue({open:!0,presupuesto:e})})(e)},disabled:!Ve.presupuesto,children:[(0,U.jsx)(L.A,{fontSize:"small",sx:{mr:1}})," Eliminar"]})}),(0,U.jsxs)(N.A,{open:De.open,onClose:()=>{He||ts()},disableEscapeKeyDown:Boolean(He),maxWidth:"xs",fullWidth:!0,children:[(0,U.jsx)(E.A,{children:"Eliminar presupuesto"}),(0,U.jsx)(T.A,{dividers:!0,children:(0,U.jsx)(u.A,{variant:"body2",children:'Vas a eliminar el presupuesto "'.concat((null===(ae=De.presupuesto)||void 0===ae?void 0:ae.nombre)||"",'". Podr\xe1s restaurarlo desde la Papelera durante ').concat(he," d\xedas.")})}),(0,U.jsxs)(_.A,{children:[(0,U.jsx)(o.A,{onClick:ts,disabled:os,children:"Cancelar"}),(0,U.jsx)(o.A,{color:"error",variant:"contained",onClick:async()=>{const e=De.presupuesto;if(e){if(He!==e.id){Fe(e.id);try{await O.A.delete("".concat(pe,"/api/presupuestos/").concat(e.id)),Ye.current=e,await $e(me,xe),je&&Xe.current&&await es(Xe.current,me,Se),Be({open:!0,message:"Presupuesto eliminado.",action:(0,U.jsx)(o.A,{color:"secondary",size:"small",onClick:()=>as(),children:"Deshacer"})}),Ie("")}catch(s){console.error("Error eliminando presupuesto:",s),Be({open:!0,message:"No se pudo eliminar el presupuesto.",action:null})}finally{Fe(null),ts()}}}else ts()},disabled:os,startIcon:os?(0,U.jsx)(R.A,{size:16,color:"inherit"}):null,children:os?"Eliminando...":"Eliminar"})]})]}),(0,U.jsx)(k.A,{open:We.open,autoHideDuration:6e3,onClose:(e,s)=>{"clickaway"!==s&&Be(e=>(0,n.A)((0,n.A)({},e),{},{open:!1}))},message:We.message,action:We.action,anchorOrigin:{vertical:"bottom",horizontal:"center"}})]})}function re(e){return(0,U.jsx)(U.Fragment,{children:(0,U.jsx)(te,{})})}},88746:(e,s,t)=>{t.d(s,{A:()=>a});var r=t(14057),n=t(70579);const a=(0,r.A)((0,n.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM8 9h8v10H8zm7.5-5-1-1h-5l-1 1H5v2h14V4z"}),"DeleteOutline")}}]);
//# sourceMappingURL=3381.66670535.chunk.js.map