{"version":3,"file":"static/js/5625.f684ecf5.chunk.js","mappings":"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","sources":["registro/carga-general/components/CargaDocumento.js","shared-components/DropzoneUploader.js"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport {\r\n  Alert,\r\n  Box,\r\n  List,\r\n  ListItem,\r\n  ListItemText,\r\n  Typography,\r\n} from \"@mui/material\";\r\nimport DropzoneUploader from \"../../../shared-components/DropzoneUploader\";\r\nimport CustomButton from \"../../../shared-components/CustomButton\";\r\nimport axios from \"axios\";\r\n\r\nexport default function CargaDocumento({ tipoDoc, endpoint }) {\r\n  const [archivo, setArchivo] = useState(null);\r\n  const [error, setError] = useState(\"\");\r\n  const [subiendo, setSubiendo] = useState(false);\r\n  const [resultado, setResultado] = useState(null);\r\n\r\n  const handleFileSelected = (file) => {\r\n    setArchivo(file);\r\n    setError(\"\");\r\n    setResultado(null);\r\n  };\r\n\r\n  const handleSubmit = async () => {\r\n    if (!archivo) {\r\n      setError(\"Seleccioná un archivo Excel o CSV antes de continuar.\");\r\n      return;\r\n    }\r\n\r\n    if (!endpoint) {\r\n      setError(\"No se encontró el endpoint de carga para este tipo.\");\r\n      return;\r\n    }\r\n\r\n    const usuarioSub = sessionStorage.getItem(\"sub\");\r\n    if (!usuarioSub) {\r\n      setError(\r\n        \"No se encontró la sesión del usuario. Iniciá sesión nuevamente para continuar.\"\r\n      );\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setSubiendo(true);\r\n      setError(\"\");\r\n\r\n      if (process.env.NODE_ENV !== \"production\") {\r\n        console.debug(\"[CargaDocumento] Subiendo archivo a:\", endpoint);\r\n      }\r\n\r\n      const formData = new FormData();\r\n      formData.append(\"file\", archivo);\r\n\r\n      const endpointTrimmed =\r\n        typeof endpoint === \"string\" ? endpoint.toLowerCase() : \"\";\r\n\r\n      const shouldSendTipoMovimiento =\r\n        endpointTrimmed.includes(\"/movimientos/documento\") &&\r\n        !endpointTrimmed.includes(\"/facturas/\");\r\n\r\n      if (shouldSendTipoMovimiento) {\r\n        formData.append(\"tipoMovimiento\", tipoDoc);\r\n      }\r\n\r\n      const headers = {\r\n        \"X-Usuario-Sub\": usuarioSub,\r\n      };\r\n\r\n      const { data } = await axios.post(endpoint, formData, { headers });\r\n\r\n      setResultado(data);\r\n    } catch (err) {\r\n      console.error(\"❌ Error en envío:\", err);\r\n      const mensaje =\r\n        err.response?.data?.mensaje ||\r\n        err.response?.data?.error ||\r\n        err.message ||\r\n        \"Ocurrió un error al procesar el archivo.\";\r\n      setError(mensaje);\r\n    } finally {\r\n      setSubiendo(false);\r\n    }\r\n  };\r\n\r\n  const tipoDocLabel =\r\n    typeof tipoDoc === \"string\" && tipoDoc.length\r\n      ? tipoDoc.charAt(0).toUpperCase() + tipoDoc.slice(1)\r\n      : \"registro\";\r\n\r\n  return (\r\n    <Box sx={{ mt: 3 }}>\r\n      <Typography variant=\"subtitle1\" sx={{ mb: 1 }}>\r\n        Cargá un archivo Excel o CSV con tus {tipoDocLabel}\r\n      </Typography>\r\n\r\n      <DropzoneUploader\r\n        onFileSelected={handleFileSelected}\r\n        width=\"100%\"\r\n        height={140}\r\n        accept={{\r\n          \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\":\r\n            [],\r\n          \"application/vnd.ms-excel\": [],\r\n          \"text/csv\": [],\r\n          \"application/csv\": [],\r\n        }}\r\n      />\r\n\r\n      <CustomButton\r\n        label={subiendo ? \"Subiendo...\" : \"Subir documento\"}\r\n        width=\"100%\"\r\n        sx={{ mt: 2 }}\r\n        onClick={handleSubmit}\r\n        disabled={subiendo}\r\n      />\r\n\r\n      {error && (\r\n        <Alert severity=\"error\" sx={{ mt: 2 }}>\r\n          {error}\r\n        </Alert>\r\n      )}\r\n\r\n      {resultado && (\r\n        <Box\r\n          sx={{\r\n            mt: 3,\r\n            p: 2,\r\n            border: \"1px solid\",\r\n            borderColor: \"divider\",\r\n            borderRadius: 2,\r\n          }}\r\n        >\r\n          <Typography variant=\"subtitle1\" sx={{ mb: 1, fontWeight: 600 }}>\r\n            Resumen de la importación\r\n          </Typography>\r\n\r\n          <Typography variant=\"body2\">\r\n            Total de filas procesadas: {resultado.totalFilas ?? 0}\r\n          </Typography>\r\n          <Typography variant=\"body2\">\r\n            Movimientos guardados: {resultado.registrosCargados ?? 0}\r\n          </Typography>\r\n\r\n          {Array.isArray(resultado.errores) && resultado.errores.length > 0 && (\r\n            <Box sx={{ mt: 2 }}>\r\n              <Typography variant=\"subtitle2\" sx={{ fontWeight: 600 }}>\r\n                Errores detectados ({resultado.errores.length})\r\n              </Typography>\r\n              <List dense>\r\n                {resultado.errores.map((item, index) => (\r\n                  <ListItem key={`${item.fila}-${index}`}>\r\n                    <ListItemText\r\n                      primary={`Fila ${item.fila}: ${item.mensaje}`}\r\n                    />\r\n                  </ListItem>\r\n                ))}\r\n              </List>\r\n            </Box>\r\n          )}\r\n        </Box>\r\n      )}\r\n    </Box>\r\n  );\r\n}\r\n","import React, { useCallback, useState, useEffect } from \"react\";\r\nimport { useDropzone } from \"react-dropzone\";\r\nimport {\r\n  Box,\r\n  Typography,\r\n  Paper,\r\n  useTheme,\r\n  IconButton,\r\n} from \"@mui/material\";\r\nimport CloudUploadIcon from \"@mui/icons-material/CloudUpload\";\r\nimport DeleteIcon from \"@mui/icons-material/Delete\";\r\n\r\nexport default function DropzoneUploader({\r\n  onFileSelected,\r\n  initialFile = null,\r\n  width = \"100%\",\r\n  height = 100,\r\n  accept\r\n}) {\r\n  const theme = useTheme();\r\n  const [file, setFile] = useState(initialFile);\r\n\r\n  const onDrop = useCallback(\r\n    (acceptedFiles) => {\r\n      if (acceptedFiles.length > 0) {\r\n        const newFile = acceptedFiles[0];\r\n        setFile(newFile);\r\n        onFileSelected?.(newFile);\r\n      }\r\n    },\r\n    [onFileSelected]\r\n  );\r\n\r\n  const { getRootProps, getInputProps, isDragActive } = useDropzone({\r\n    onDrop,\r\n    multiple: false,\r\n    accept: accept || undefined\r\n  });\r\n\r\n  const handleRemove = () => {\r\n    setFile(null);\r\n    onFileSelected?.(null);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (initialFile) setFile(initialFile);\r\n  }, [initialFile]);\r\n\r\n  return (\r\n    <Box sx={{ width }}>\r\n      <Paper\r\n        variant=\"outlined\"\r\n        {...getRootProps()}\r\n        sx={{\r\n          width: \"100%\",\r\n          height: height,\r\n          p: 3,\r\n          display: \"flex\",\r\n          flexDirection: \"column\",\r\n          justifyContent: \"center\",\r\n          alignItems: \"center\",\r\n          textAlign: \"center\",\r\n          border: \"2px dashed\",\r\n          borderColor: isDragActive ? \"primary.main\" : \"grey.400\",\r\n          bgcolor: isDragActive ? \"grey.100\" : \"inherit\",\r\n          cursor: \"pointer\",\r\n          ...(theme.palette.mode === \"dark\" && {\r\n            borderColor: isDragActive ? \"primary.light\" : \"grey.700\",\r\n            bgcolor: isDragActive ? \"grey.900\" : \"inherit\",\r\n          }),\r\n        }}\r\n      >\r\n        <input {...getInputProps()} />\r\n        <CloudUploadIcon sx={{ fontSize: 60, mb: 1 }} color=\"action\" />\r\n        {isDragActive ? (\r\n          <Typography variant=\"body1\">Suelta el archivo aquí...</Typography>\r\n        ) : (\r\n          <Typography variant=\"body1\">\r\n            Arrastrá y soltá un archivo aquí o hacé clic para seleccionarlo\r\n          </Typography>\r\n        )}\r\n      </Paper>\r\n\r\n      {file && (\r\n        <Box\r\n          sx={{\r\n            mt: 2,\r\n            width: \"100%\",\r\n            display: \"flex\",\r\n            alignItems: \"center\",\r\n            justifyContent: \"space-between\",\r\n            p: 1.5,\r\n            border: \"1px solid\",\r\n            borderColor: \"grey.300\",\r\n            borderRadius: 1,\r\n            ...(theme.palette.mode === \"dark\" && {\r\n              borderColor: \"grey.700\",\r\n            }),\r\n          }}\r\n        >\r\n          <Typography variant=\"body2\">{file.name}</Typography>\r\n          <IconButton onClick={handleRemove} size=\"small\" color=\"error\">\r\n            <DeleteIcon />\r\n          </IconButton>\r\n        </Box>\r\n      )}\r\n    </Box>\r\n  );\r\n}\r\n"],"names":["CargaDocumento","_ref","_resultado$totalFilas","_resultado$registrosC","tipoDoc","endpoint","archivo","setArchivo","useState","error","setError","subiendo","setSubiendo","resultado","setResultado","tipoDocLabel","length","charAt","toUpperCase","slice","_jsxs","Box","sx","mt","children","Typography","variant","mb","_jsx","DropzoneUploader","onFileSelected","file","width","height","accept","CustomButton","label","onClick","async","usuarioSub","sessionStorage","getItem","formData","FormData","append","endpointTrimmed","toLowerCase","includes","headers","data","axios","post","err","_err$response","_err$response$data","_err$response2","_err$response2$data","console","mensaje","response","message","disabled","Alert","severity","p","border","borderColor","borderRadius","fontWeight","totalFilas","registrosCargados","Array","isArray","errores","List","dense","map","item","index","ListItem","ListItemText","primary","concat","fila","initialFile","theme","useTheme","setFile","onDrop","useCallback","acceptedFiles","newFile","getRootProps","getInputProps","isDragActive","useDropzone","multiple","undefined","useEffect","Paper","_objectSpread","display","flexDirection","justifyContent","alignItems","textAlign","bgcolor","cursor","palette","mode","CloudUploadIcon","fontSize","color","name","IconButton","handleRemove","size","DeleteIcon"],"sourceRoot":""}