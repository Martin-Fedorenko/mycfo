(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[8177],{3555:(e,t,o)=>{"use strict";o.d(t,{A:()=>a});var r=o(14057),i=o(70579);const a=(0,r.A)((0,i.jsx)("path",{d:"M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6z"}),"KeyboardArrowDown")},18177:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>Re});var r=o(89379),i=o(65043),a=o(53969),n=o(56647),s=o(55895),l=o(94799),c=o(70298),d=o(76072),u=o(76943),m=o(26687),h=o(53089),p=o(17873),v=o(26529),g=o(12097),x=o(17060),f=o(24343),A=o(10256),y=o(3353),b=o(9446),j=o(88889),S=o(94527),w=o(38517),C=o(81911),E=o(78776),M=o(85877),I=o(45847),k=o(85030),$=o(32911),D=o(91449),z=o(60267),R=o(29001),O=o(34955),N=o(67819),W=o(38915),T=o(20475),L=o(60446),P=o.n(L),_=o(69516),H=o(92275),F=o(37426),Y=o(47436),U=o(50108),B=o(16992),V=o(56102),G=o(17869),J=o(80379),K=o(70095),q=o(82291),X=o(52185),Z=o(6026),Q=o(66163),ee=o(3555),te=o(73456),oe=o(19817),re=o(14057),ie=o(70579);const ae=(0,re.A)((0,ie.jsx)("path",{d:"M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"}),"AddCircleOutline");var ne=o(88746);const se=(0,re.A)((0,ie.jsx)("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7zm2 16H5V5h11.17L19 7.83zm-7-7c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3M6 6h9v4H6z"}),"SaveOutlined"),le=(0,re.A)((0,ie.jsx)("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2M9 6c0-1.66 1.34-3 3-3s3 1.34 3 3v2H9zm9 14H6V10h12zm-6-3c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2"}),"LockOutlined"),ce=(0,re.A)((0,ie.jsx)("path",{d:"m14.06 9.02.92.92L5.92 19H5v-.92zM17.66 3c-.25 0-.51.1-.7.29l-1.83 1.83 3.75 3.75 1.83-1.83c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.2-.2-.45-.29-.71-.29m-3.6 3.19L3 17.25V21h3.75L17.81 9.94z"}),"EditOutlined"),de=(0,re.A)((0,ie.jsx)("path",{d:"m14.06 9.02.92.92-1.11 1.11 1.41 1.41 2.52-2.52-3.75-3.75-2.52 2.52 1.41 1.41zm6.65-1.98c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.2-.2-.45-.29-.71-.29s-.51.1-.7.29l-1.83 1.83 3.75 3.75zM2.81 2.81 1.39 4.22l7.32 7.32L3 17.25V21h3.75l5.71-5.71 7.32 7.32 1.41-1.41zM5.92 19H5v-.92l5.13-5.13.92.92z"}),"EditOffOutlined"),ue=(0,re.A)((0,ie.jsx)("path",{d:"M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"}),"ChevronLeft"),me=(0,re.A)((0,ie.jsx)("path",{d:"M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}),"ChevronRight");var he=o(92659),pe=o(13658),ve=o(96470);const ge=e=>"number"===typeof e?e:null==e||isNaN(Number(e))?0:Number(e),xe=pe.A.PRONOSTICO,fe={categoria:{title:"Habilitar edicion manual",body:"La categoria, tipo y monto estimado ayudan a ordenar tus analisis. Cambiarlos manualmente puede afectar reportes y automatizaciones. Queres habilitar la edicion manual?",confirmLabel:"Habilitar edicion"},real:{title:"Editar monto real",body:"El monto real refleja los registros consolidados. Para ajustarlo, edita los movimientos registrados del periodo. Te llevamos a Ver movimientos.",confirmLabel:"Habilitar edicion en movimientos"}},Ae={categoria:"la categoria, tipo y estimado",tipo:"el tipo",montoEstimado:"el estimado",real:"el monto real"},ye="#4caf50",be="#f44336",je="#a5d6a7",Se="#ef9a9a",we={fontWeight:500,bgcolor:"#FFDE70",backgroundColor:"#FFDE70",color:"#000",border:"1px solid #F5C16C","& .MuiChip-label":{color:"#000"},"& .MuiChip-icon":{color:"#000"},"&.MuiChip-filled":{backgroundColor:"#FFDE70"}},Ce={top:"50%",transform:"translate(14px, -50%) scale(1)","&.MuiInputLabel-shrink":{top:0,transform:"translate(14px, -9px) scale(0.75)"}},Ee={enero:"01",febrero:"02",marzo:"03",abril:"04",mayo:"05",junio:"06",julio:"07",agosto:"08",septiembre:"09",octubre:"10",noviembre:"11",diciembre:"12"},Me=e=>{if(!e)return"Mes desconocido";const[t,o]=e.split("-"),r=parseInt(o,10);return isNaN(r)?e:"".concat(["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"][r-1]," ").concat(t)},Ie=e=>"".concat(e,"-01"),ke=(e,t)=>{const o=[];if(!e||!t)return o;let[r,i]=e.split("-").map(Number);const[a,n]=t.split("-").map(Number);let s=r,l=i,c=0;for(;c++<600&&(o.push("".concat(s,"-").concat(String(l).padStart(2,"0"))),s!==a||l!==n);)l++,l>12&&(l=1,s++);return o},$e=e=>{var t,o,r,i,a,n,s;const l=null!==(t=null!==(o=null===e||void 0===e?void 0:e.movimientoIds)&&void 0!==o?o:null===e||void 0===e?void 0:e.movimiento_ids)&&void 0!==t?t:null===e||void 0===e?void 0:e.movementIds,c=null!==(r=null!==(i=null!==(a=null===e||void 0===e?void 0:e.movimientoId)&&void 0!==a?a:null===e||void 0===e?void 0:e.movimiento_id)&&void 0!==i?i:null===e||void 0===e?void 0:e.movementId)&&void 0!==r?r:null,d=Array.isArray(l)?l.map(e=>String(e)):null!=c?[String(c)]:[];return{id:e.id,categoria:e.categoria,tipo:ze(e.tipo),montoEstimado:null!==(n=null!==(s=e.montoEstimado)&&void 0!==s?s:e.monto_estimado)&&void 0!==n?n:0,real:0,movimientoIds:d}},De=e=>(e||"").normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim().toLowerCase(),ze=e=>{const t=(e||"").toString().toUpperCase();return"INGRESO"===t?"Ingreso":"EGRESO"===t?"Egreso":e||""};function Re(){var e,t,L,re,Re,Oe;const{nombre:Ne,mesNombre:We}=(0,R.g)(),Te=(0,R.Zp)(),Le=(0,z.A)(),Pe="light"===Le.palette.mode,_e=null!==(e=null===(t=Le.vars)||void 0===t?void 0:t.palette)&&void 0!==e?e:Le.palette,He=i.useMemo(()=>({ingresos:Pe?"hsl(120, 44%, 53%)":_e.success.light,egresos:Pe?"hsl(0, 90%, 40%)":_e.error.light,resultadoPos:Pe?"hsl(210, 98%, 42%)":_e.info.light,resultadoNeg:Pe?"hsl(45, 90%, 40%)":_e.warning.light}),[Pe,_e.error.light,_e.info.light,_e.success.light,_e.warning.light]),Fe=Pe?null!==(L=null===(re=_e.text)||void 0===re?void 0:re.primary)&&void 0!==L?L:"#000":null!==(Re=null===(Oe=_e.common)||void 0===Oe?void 0:Oe.white)&&void 0!==Re?Re:"#fff";i.useEffect(()=>{"undefined"!==typeof window&&"function"===typeof window.scrollTo&&window.scrollTo({top:0,left:0,behavior:"auto"})},[]);const[Ye,Ue]=i.useState([]),[Be,Ve]=i.useState([]),[Ge,Je]=i.useState({}),[Ke,qe]=i.useState({}),[Xe,Ze]=i.useState({open:!1,id:null,field:null,title:"",message:"",confirmLabel:"",movementIds:[]}),[Qe,et]=i.useState("Mes desconocido"),[tt,ot]=i.useState(""),[rt,it]=i.useState(null),[at,nt]=i.useState(null),[st,lt]=i.useState([]),[ct,dt]=i.useState(0),[ut,mt]=i.useState(0),ht=i.useCallback(()=>dt(1),[dt]),[pt,vt]=i.useState(!1),[gt,xt]=i.useState(null),[ft,At]=i.useState({open:!1,message:"",severity:"success"}),[yt,bt]=i.useState({categoria:"",tipo:"Egreso",montoEstimado:""}),[jt,St]=i.useState(!1),[wt,Ct]=i.useState(!1),[Et,Mt]=i.useState({ambito:"este_mes",modo:"AJUSTE_PCT",valor:10,solo:"todos",rangoDesde:"",rangoHasta:""}),[It,kt]=i.useState(!1),[$t,Dt]=i.useState({accion:"replicar",desde:"",hasta:""}),[zt,Rt]=i.useState({open:!1,id:null,categoria:"",tipo:""}),[Ot,Nt]=i.useState(he.gd),[Wt,Tt]=i.useState(!0),Lt=i.useMemo(()=>{const e=new Set;for(const t of Ye){const o=De(null===t||void 0===t?void 0:t.categoria);o&&e.add(o)}return e},[Ye]),Pt=i.useMemo(()=>{let e=Ot.filter(e=>{if("string"!==typeof e)return!1;const t=De(e);return!!t&&!Lt.has(t)});if(yt.categoria){const t=De(yt.categoria);e.some(e=>De(e)===t)||(e=[yt.categoria,...e])}return e},[Ot,Lt,yt.categoria]),{prevYm:_t,nextYm:Ht}=i.useMemo(()=>{if(!at||!st.length)return{prevYm:null,nextYm:null};const e=st.findIndex(e=>e===at);return-1===e?{prevYm:null,nextYm:null}:{prevYm:e>0?st[e-1]:null,nextYm:e<st.length-1?st[e+1]:null}},[at,st]);i.useEffect(()=>{let e=!0;return(async()=>{try{const t=await W.A.get("".concat(pe.A.REGISTRO,"/api/categorias"));if(!e)return;Array.isArray(null===t||void 0===t?void 0:t.data)&&t.data.length>0&&Nt(t.data)}catch(t){console.error("No se pudieron obtener las categor\xedas, se usan las predefinidas",t)}})(),()=>{e=!1}},[]);const Ft=i.useCallback(async function(e,t){let{skipStateUpdate:o=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e||!t)return;const r="".concat(xe,"/api/presupuestos/").concat(e,"/mes/").concat(t),i="".concat(xe,"/api/presupuestos/").concat(e,"/mes/").concat(Ie(t)),a=async e=>{try{const t=await W.A.get(e),o=null===t||void 0===t?void 0:t.data;let r=Array.isArray(o)?o:Array.isArray(null===o||void 0===o?void 0:o.lineas)?o.lineas:Array.isArray(null===o||void 0===o?void 0:o.categorias)?o.categorias:[];return r.map($e)}catch(t){return null}};let n=await a(r);n&&0!==n.length||(n=await a(i));const s=n||[];return o||Ue(s),s},[]),Yt=i.useCallback(async(e,t)=>{const o=await Ft(e,t,{skipStateUpdate:!0})||[],i="string"===typeof t?t.slice(0,7):"",a=P()("".concat(i,"-01"));if(!a.isValid()){const e=o.map(e=>(0,r.A)((0,r.A)({},e),{},{real:0}));return Ue(e),Ve([]),mt(0),e}try{const e=a.toDate(),t=(0,_.GP)((0,H.w)(e),"yyyy-MM-dd"),i=(0,_.GP)((0,F.p)(e),"yyyy-MM-dd"),[n,s]=await Promise.all([(0,Y.F)({fechaDesde:t,fechaHasta:i,tipos:"Egreso"}),(0,Y.F)({fechaDesde:t,fechaHasta:i,tipos:"Ingreso"})]),l=Array.isArray(null===n||void 0===n?void 0:n.content)?n.content:Array.isArray(n)?n:[],c=Array.isArray(null===s||void 0===s?void 0:s.content)?s.content:Array.isArray(s)?s:[],d=e=>e.reduce((e,t)=>{var o,r,i,a,n,s,l,c;const d=(null===t||void 0===t?void 0:t.categoriaNombre)||(null===t||void 0===t?void 0:t.categoria)||(null===t||void 0===t?void 0:t.categoria_id_nombre)||"Sin categor\xeda",u=De(d);if(!u)return e;const m=Math.abs(Number(null!==(o=null!==(r=null!==(i=null===t||void 0===t?void 0:t.monto)&&void 0!==i?i:null===t||void 0===t?void 0:t.montoTotal)&&void 0!==r?r:null===t||void 0===t?void 0:t.monto_total)&&void 0!==o?o:0))||0;if(!Number.isFinite(m))return e;e[u]||(e[u]={total:0,label:d||"Sin categor\xeda",movementIds:[]}),e[u].total+=m;const h=null!==(a=null!==(n=null!==(s=null!==(l=null!==(c=null===t||void 0===t?void 0:t.id)&&void 0!==c?c:null===t||void 0===t?void 0:t.movimientoId)&&void 0!==l?l:null===t||void 0===t?void 0:t.movimiento_id)&&void 0!==s?s:null===t||void 0===t?void 0:t.movimientoID)&&void 0!==n?n:null===t||void 0===t?void 0:t.idMovimiento)&&void 0!==a?a:null,p=null!=h?String(h):null;return p&&!e[u].movementIds.includes(p)&&e[u].movementIds.push(p),e},{}),u=d(l),m=d(c),h=Object.values(u).reduce((e,t)=>e+t.total,0),p=o.map(e=>{const t=De(e.categoriaNombre||e.categoria),o=(e.tipo||"").toUpperCase(),i=Array.isArray(e.movimientoIds)?e.movimientoIds.map(e=>String(e)):[];let a=0,n=i;if("INGRESO"===o){const e=m[t];a=(null===e||void 0===e?void 0:e.total)||0;const o=Array.isArray(null===e||void 0===e?void 0:e.movementIds)?e.movementIds.map(e=>String(e)):[];n=Array.from(new Set([...i,...o]))}else if("EGRESO"===o){const e=u[t];a=(null===e||void 0===e?void 0:e.total)||0;const o=Array.isArray(null===e||void 0===e?void 0:e.movementIds)?e.movementIds.map(e=>String(e)):[];n=Array.from(new Set([...i,...o]))}return(0,r.A)((0,r.A)({},e),{},{real:a,movimientoIds:n})}),v=o.reduce((e,t)=>{const o=(t.tipo||"").toUpperCase(),r=De(t.categoriaNombre||t.categoria);return e[o]||(e[o]=new Set),e[o].add(r),e},{}),g=[],x=(e,t)=>{const o=v[e]||new Set;Object.entries(t).forEach(t=>{let[r,i]=t;o.has(r)||g.push({id:"real-only-".concat(e,"-").concat(r),categoria:i.label||"Sin categor\xeda",tipo:ze(e),montoEstimado:0,real:i.total,_soloReal:!0,movimientoIds:Array.from(new Set((i.movementIds||[]).map(e=>String(e))))})})};return x("EGRESO",u),x("INGRESO",m),Ue(p),Ve(g),mt(h),p}catch(n){console.error("Error al obtener datos reales del mes:",n);const e=o.map(e=>(0,r.A)((0,r.A)({},e),{},{real:0}));return Ue(e),Ve([]),mt(0),At({open:!0,message:"No se pudieron cargar los datos reales del mes.",severity:"error"}),e}},[Ft,At]);i.useEffect(()=>{Ne&&We&&(async()=>{try{Tt(!0);const e=await W.A.get("".concat(xe,"/api/presupuestos")),t=null===e||void 0===e?void 0:e.data;let o=[];Array.isArray(t)?o=t:Array.isArray(null===t||void 0===t?void 0:t.content)&&(o=t.content);const r=decodeURIComponent(Ne||"").trim().toLowerCase().replace(/\s+/g,"-"),i=o.find(e=>((null===e||void 0===e?void 0:e.nombre)||"").trim().toLowerCase().replace(/\s+/g,"-")===r);if(null===i||void 0===i||!i.id)throw new Error("Presupuesto no encontrado");ot(i.nombre),it(i.id);const a=Ee[(We||"").toLowerCase().trim()];if(!a)throw new Error("Mes no v\xe1lido");const n=await W.A.get("".concat(xe,"/api/presupuestos/").concat(i.id,"/totales")),s=Array.isArray(n.data)?n.data:[],l=Array.from(new Set(s.map(e=>null!==e&&void 0!==e&&e.mes?String(e.mes):"").filter(Boolean))).sort((e,t)=>e.localeCompare(t));lt(l);const c=s.find(e=>String((null===e||void 0===e?void 0:e.mes)||"").endsWith("-".concat(a)));if(null===c||void 0===c||!c.mes)throw new Error("Mes no encontrado en totales");nt(c.mes),et(Me(c.mes)),await Yt(i.id,c.mes)}catch(e){console.error(e),Ue([]),lt([]),nt(null),et("Mes desconocido"),At({open:!0,message:(null===e||void 0===e?void 0:e.message)||"Error cargando mes",severity:"error"})}finally{Tt(!1)}})()},[Ne,We,Yt]);const Ut=i.useCallback(async e=>{if(e&&rt)try{Tt(!0),await Yt(rt,e),nt(e),et(Me(e))}catch(t){console.error("Error cambiando de mes",t),At({open:!0,message:"No se pudieron cargar los datos del mes seleccionado.",severity:"error"})}finally{Tt(!1)}},[rt,Yt,At]),Bt=i.useMemo(()=>[...Ye,...Be],[Ye,Be]);i.useEffect(()=>{const e={};for(const t of Bt)e[t.id]={categoria:t.categoria,tipo:t.tipo,montoEstimado:ge(t.montoEstimado),real:null===t.real||"undefined"===typeof t.real?"":ge(t.real)};Je(e),qe(e=>{const t={};for(const n of Bt){var o,r,i,a;t[n.id]={categoria:(null===(o=e[n.id])||void 0===o?void 0:o.categoria)||!1,tipo:(null===(r=e[n.id])||void 0===r?void 0:r.tipo)||!1,montoEstimado:(null===(i=e[n.id])||void 0===i?void 0:i.montoEstimado)||!1,real:(null===(a=e[n.id])||void 0===a?void 0:a.real)||!1}}return t})},[Bt]);const Vt=i.useCallback((e,t)=>{const o=fe[t]||{};if("real"===t){const r=Bt.find(t=>t.id===e),i=Array.isArray(null===r||void 0===r?void 0:r.movimientoIds)?r.movimientoIds.map(e=>String(e)):[];return i.length?void Ze({open:!0,id:e,field:t,title:o.title||"Editar monto real",message:o.body||"Esta accion habilita la edicion manual.",confirmLabel:o.confirmLabel||"Habilitar edicion en movimientos",movementIds:i}):void At({open:!0,message:"No se encontro el movimiento para editar.",severity:"error"})}Ze({open:!0,id:e,field:t,title:o.title||"Confirmar edicion manual",message:o.body||"Esta accion habilita la edicion manual.",confirmLabel:o.confirmLabel||"Habilitar",movementIds:[]})},[Bt,At]),Gt=i.useCallback(()=>{Ze({open:!1,id:null,field:null,title:"",message:"",confirmLabel:"",movementIds:[]})},[]),Jt=i.useCallback((e,t,o)=>{const i="categoria"===t?["categoria","tipo","montoEstimado"]:[t];if(qe(t=>{const a=(0,r.A)({},t),n=(0,r.A)({},a[e]||{});return i.forEach(e=>{n[e]=o}),a[e]=n,a}),!o){const o=Bt.find(t=>t.id===e);o&&Je(t=>{const a=(0,r.A)({},t[e]||{});return i.forEach(e=>{"real"===e?a[e]=null===o.real||"undefined"===typeof o.real?"":ge(o.real):"tipo"===e?a[e]=o.tipo:"montoEstimado"===e?a[e]=ge(o.montoEstimado):"categoria"===e&&(a[e]=o.categoria)}),(0,r.A)((0,r.A)({},t),{},{[e]:a})});const a=Ae[t]||t;At({open:!0,message:"Edici\xf3n manual desactivada para ".concat(a,"."),severity:"info"})}},[Bt,At]),Kt=i.useCallback(()=>{if(!Xe.open||null==Xe.id||!Xe.field)return void Ze({open:!1,id:null,field:null,title:"",message:"",confirmLabel:"",movementIds:[]});if("real"===Xe.field){const e=Bt.find(e=>e.id===Xe.id),t=Xe.movementIds&&Xe.movementIds.length?Xe.movementIds:Array.isArray(null===e||void 0===e?void 0:e.movimientoIds)?e.movimientoIds.map(e=>String(e)):[],o=t[0];if(Ze({open:!1,id:null,field:null,title:"",message:"",confirmLabel:"",movementIds:[]}),!o)return void At({open:!0,message:"No se encontro el movimiento para editar.",severity:"error"});const r=new URLSearchParams;return r.set("editMovementId",o),void Te("/ver-movimientos?".concat(r.toString()),{state:{editMovementId:o,editMovementMeta:{from:"presupuesto",presupuestoId:rt,ym:at,categoria:(null===e||void 0===e?void 0:e.categoria)||"",movimientoIds:t}}})}Jt(Xe.id,Xe.field,!0);const e=Ae[Xe.field]||Xe.field;At({open:!0,message:"Edicion manual habilitada para ".concat(e,"."),severity:"warning"}),Ze({open:!1,id:null,field:null,title:"",message:"",confirmLabel:"",movementIds:[]})},[Xe,Bt,Te,Jt,At,rt,at]),qt=i.useCallback((e,t)=>{var o;return!0===(null===(o=Ke[e])||void 0===o?void 0:o[t])},[Ke]),Xt=i.useCallback(async()=>{if(rt&&at){Tt(!0);try{await Yt(rt,at)}finally{Tt(!1)}}},[rt,at,Yt]),Zt=i.useMemo(()=>Bt.filter(e=>"INGRESO"===(e.tipo||"").toUpperCase()),[Bt]),Qt=i.useMemo(()=>Bt.filter(e=>"EGRESO"===(e.tipo||"").toUpperCase()),[Bt]),eo=Zt.reduce((e,t)=>e+ge(t.real),0),to=Qt.reduce((e,t)=>e+ge(t.real),0),oo=Number.isFinite(ut)?ut:to,ro=Zt.reduce((e,t)=>e+ge(t.montoEstimado),0),io=Qt.reduce((e,t)=>e+ge(t.montoEstimado),0),ao=eo-oo,no=Bt.reduce((e,t)=>e+ge(t.montoEstimado)*("Ingreso"===t.tipo?1:-1),0),so=Math.abs(no)>0?ao/Math.abs(no):0,lo=Ye.filter(e=>0!==ge(e.montoEstimado)&&0===ge(e.real)).length,co=Zt.map(e=>({name:e.categoria,value:ge(e.real)})),uo=Zt.map(e=>({name:e.categoria,estimado:ge(e.montoEstimado),real:ge(e.real)})),mo=Qt.map(e=>({name:e.categoria,value:ge(e.real)})),ho=Qt.map(e=>({name:e.categoria,estimado:ge(e.montoEstimado),real:ge(e.real)})),po=e=>{var t;return{categoria:e.categoria,tipo:e.tipo,montoEstimado:Number(null!==(t=e.montoEstimado)&&void 0!==t?t:0),real:""===e.real||null==e.real?null:Number(e.real)}},vo=e=>{var t;return{categoria:e.categoria,tipo:e.tipo,monto_estimado:Number(null!==(t=e.montoEstimado)&&void 0!==t?t:0),real:""===e.real||null==e.real?null:Number(e.real)}},go=async(e,t,o)=>"patch"===e?W.A.patch(t,o):W.A.put(t,o),xo=()=>{Rt(e=>(0,r.A)((0,r.A)({},e),{},{open:!1}))};return Wt?(0,ie.jsx)(a.A,{sx:{width:"100%",p:3},children:(0,ie.jsx)(ve.A,{message:"Cargando detalle del mes..."})}):(0,ie.jsxs)(a.A,{id:"mes-detalle-content",sx:{width:"100%",p:3},children:[(0,ie.jsxs)(a.A,{sx:{display:"flex",alignItems:"center",gap:1.5,mb:1.5,justifyContent:"flex-start"},children:[(0,ie.jsx)(a.A,{sx:{width:40,display:"flex",justifyContent:"flex-start"},children:(0,ie.jsx)(n.A,{size:"small",onClick:()=>_t&&Ut(_t),"aria-label":"Mes anterior",disabled:!_t,sx:{color:"#04564c","&.Mui-disabled":{color:"#04564c",opacity:.5}},children:(0,ie.jsx)(ue,{fontSize:"small"})})}),(0,ie.jsx)(s.A,{variant:"h4",fontWeight:"600",sx:{flexGrow:0,flexShrink:0,textAlign:"center",minWidth:"14ch",whiteSpace:"nowrap"},children:Qe}),(0,ie.jsx)(a.A,{sx:{width:40,display:"flex",justifyContent:"flex-start"},children:(0,ie.jsx)(n.A,{size:"small",onClick:()=>Ht&&Ut(Ht),"aria-label":"Mes siguiente",disabled:!Ht,sx:{color:"#04564c","&.Mui-disabled":{color:"#04564c",opacity:.5}},children:(0,ie.jsx)(me,{fontSize:"small"})})})]}),(0,ie.jsxs)(s.A,{variant:"subtitle1",sx:{color:"text.primary"},gutterBottom:!0,children:["Detalle de ",tt]}),(0,ie.jsx)(l.A,{sx:{p:2,mb:2},children:(0,ie.jsxs)(c.A,{direction:"row",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:2,children:[(0,ie.jsxs)(c.A,{direction:"row",spacing:2,alignItems:"center",children:[(0,ie.jsx)(d.A,{label:"Cumplimiento: ".concat((100*so).toFixed(0),"%"),color:so>=.95?"success":so>=.8?"warning":"error"}),(0,ie.jsx)(d.A,{icon:lo>0?(0,ie.jsx)(te.A,{}):void 0,label:"".concat(lo," movimientos estimados sin registrar"),variant:"filled",color:0===lo?"success":void 0,sx:0===lo?void 0:we})]}),(0,ie.jsx)(c.A,{direction:"row",spacing:1,alignItems:"center",children:(0,ie.jsx)(O.A,{onExportPdf:()=>{Promise.all([o.e(1389),o.e(74)]).then(o.t.bind(o,90074,23)).then(e=>{const t=document.getElementById("mes-detalle-content"),o={margin:1,filename:"Mes_".concat(Qe,"_").concat(Date.now(),".pdf"),image:{type:"jpeg",quality:.98},html2canvas:{scale:2},jsPDF:{unit:"in",format:"letter",orientation:"portrait"}};e.default().from(t).set(o).save()})},onExportExcel:()=>{const e=[["Categor\xeda","Tipo","Monto Estimado","Monto Registrado","Desv\xedo"],...Bt.map(e=>[e.categoria,e.tipo,ge(e.montoEstimado),ge(e.real),"Egreso"===e.tipo?ge(e.montoEstimado)-ge(e.real):ge(e.real)-ge(e.montoEstimado)])];e.push(["","","","",""]),e.push(["Resultado:","","","",ao]),Promise.all([o.e(1652),o.e(2514)]).then(o.t.bind(o,81652,23)).then(t=>{let{utils:o,writeFile:r}=t;const i=o.aoa_to_sheet(e,{cellStyles:!0}),a=o.book_new();o.book_append_sheet(a,i,"Detalle Mes"),r(a,"Mes_".concat(Qe,"_").concat(Date.now(),".xlsx"),{cellStyles:!0})})}})})]})}),(0,ie.jsx)(a.A,{sx:{display:"flex",justifyContent:"flex-start",alignItems:"center",mb:2,mt:1,gap:1,flexWrap:"wrap"},children:(0,ie.jsxs)(u.A,{value:ct,onChange:(e,t)=>dt(t),indicatorColor:"primary",children:[(0,ie.jsx)(m.A,{label:"Resumen",sx:{color:Fe,"&.Mui-selected":{color:Fe},"& .MuiTab-wrapper":{color:Fe}}}),(0,ie.jsx)(m.A,{label:"Datos brutos (editar)",sx:{color:Fe,"&.Mui-selected":{color:Fe},"& .MuiTab-wrapper":{color:Fe}}})]})}),0===ct&&(0,ie.jsxs)(ie.Fragment,{children:[(0,ie.jsxs)(h.A,{container:!0,spacing:3,mb:2,children:[(0,ie.jsx)(h.A,{item:!0,xs:12,sm:6,md:4,children:(0,ie.jsxs)(l.A,{sx:{p:3,textAlign:"center",bgcolor:He.ingresos,color:"white",height:"100%"},children:[(0,ie.jsx)(p.A,{sx:{width:56,height:56,bgcolor:"white",color:"success.main",mx:"auto",mb:1},children:"+"}),(0,ie.jsx)(s.A,{variant:"h6",children:"Ingresos"}),(0,ie.jsx)(s.A,{variant:"body2",sx:{display:"block",color:"rgba(255,255,255,0.9)"},children:"Real del mes"}),(0,ie.jsx)(s.A,{variant:"h4",fontWeight:"bold",children:(0,T.vv)(eo)}),(0,ie.jsxs)(s.A,{variant:"body2",sx:{color:"rgba(255,255,255,0.9)"},children:["Estimado: ",(0,T.vv)(ro)]})]})}),(0,ie.jsx)(h.A,{item:!0,xs:12,sm:6,md:4,children:(0,ie.jsxs)(l.A,{sx:{p:3,textAlign:"center",bgcolor:He.egresos,color:"white",height:"100%"},children:[(0,ie.jsx)(p.A,{sx:{width:56,height:56,bgcolor:"white",color:"error.main",mx:"auto",mb:1},children:"-"}),(0,ie.jsx)(s.A,{variant:"h6",children:"Egresos"}),(0,ie.jsx)(s.A,{variant:"body2",sx:{display:"block",color:"rgba(255,255,255,0.9)"},children:"Real del mes"}),(0,ie.jsx)(s.A,{variant:"h4",fontWeight:"bold",children:(0,T.vv)(oo)}),(0,ie.jsxs)(s.A,{variant:"body2",sx:{color:"rgba(255,255,255,0.9)"},children:["Estimado: ",(0,T.vv)(io)]})]})}),(0,ie.jsx)(h.A,{item:!0,xs:12,sm:6,md:4,children:(0,ie.jsxs)(l.A,{sx:{p:3,textAlign:"center",bgcolor:ao>=0?He.resultadoPos:He.resultadoNeg,color:"white",height:"100%"},children:[(0,ie.jsx)(p.A,{sx:{width:56,height:56,bgcolor:"white",color:ao>=0?"info.main":"warning.main",mx:"auto",mb:1},children:ao>=0?"\u2713":"\u26a0"}),(0,ie.jsx)(s.A,{variant:"h6",children:"Resultado"}),(0,ie.jsx)(s.A,{variant:"h4",fontWeight:"bold",children:(0,T.vv)(ao)}),(0,ie.jsx)(s.A,{variant:"body2",sx:{color:"rgba(255,255,255,0.9)"},children:ao>=0?"Super\xe1vit":"D\xe9ficit"})]})})]}),co.length>0?(0,ie.jsxs)(l.A,{sx:{p:3,mb:2},children:[(0,ie.jsx)(s.A,{variant:"h6",gutterBottom:!0,fontWeight:"600",children:"Distribuci\xf3n de Ingresos por Categor\xeda"}),(0,ie.jsx)(U.u,{width:"100%",height:300,children:(0,ie.jsxs)(B.r,{children:[(0,ie.jsx)(V.F,{data:co,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:100,label:e=>{let{name:t,percent:o}=e;return"".concat(t," ").concat((100*o).toFixed(0),"%")},children:co.map((e,t)=>(0,ie.jsx)(G.f,{fill:ye,opacity:.7+.1*t},"ing-".concat(t)))}),(0,ie.jsx)(J.m,{formatter:e=>(0,T.vv)(e)}),(0,ie.jsx)(K.s,{})]})})]}):(0,ie.jsx)(l.A,{sx:{p:3,mb:2,textAlign:"center"},children:(0,ie.jsx)(s.A,{color:"text.secondary",children:"No hay ingresos registrados este mes."})}),uo.length>0&&(0,ie.jsxs)(l.A,{sx:{p:3,mb:2},children:[(0,ie.jsx)(s.A,{variant:"h6",gutterBottom:!0,fontWeight:"600",children:"Ingresos: Estimado vs Real por Categor\xeda"}),(0,ie.jsx)(a.A,{sx:{mt:2},children:uo.map((e,t)=>{const o=ge(e.estimado),i=ge(e.real),n=1.2*Math.max(o,i)||1,l=0===o&&i>0;return(0,ie.jsxs)(a.A,{sx:{mb:3},children:[(0,ie.jsxs)(c.A,{direction:"row",spacing:1,alignItems:"center",mb:1,children:[(0,ie.jsx)(s.A,{variant:"subtitle1",fontWeight:"600",children:e.name}),l&&(0,ie.jsx)(v.A,{title:"Este movimiento no tiene un monto estimado. Hac\xe9 clic para pronosticar.",disableHoverListener:!l,children:(0,ie.jsx)(d.A,{icon:(0,ie.jsx)(te.A,{}),size:"small",label:"Movimiento sin pronosticar",sx:(0,r.A)((0,r.A)({},we),{},{cursor:"pointer"}),onClick:ht})})]}),(0,ie.jsxs)(a.A,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,ie.jsxs)(a.A,{sx:{display:"flex",alignItems:"center",gap:2},children:[(0,ie.jsx)(s.A,{variant:"body2",sx:{minWidth:80},children:"Estimado:"}),(0,ie.jsx)(a.A,{sx:{flex:1,height:30},children:(0,ie.jsx)(U.u,{width:"100%",height:30,children:(0,ie.jsxs)(q.E,{data:[{name:e.name,valor:e.estimado}],layout:"vertical",children:[(0,ie.jsx)(X.W,{type:"number",domain:[0,n],hide:!0}),(0,ie.jsx)(Z.h,{type:"category",dataKey:"name",hide:!0}),(0,ie.jsx)(J.m,{formatter:e=>[(0,T.vv)(e),""]}),(0,ie.jsx)(Q.y,{dataKey:"valor",fill:je,radius:[4,4,4,4],label:{position:"right",formatter:e=>(0,T.vv)(e)}})]})})})]}),(0,ie.jsxs)(a.A,{sx:{display:"flex",alignItems:"center",gap:2},children:[(0,ie.jsx)(s.A,{variant:"body2",sx:{minWidth:80},children:"Real:"}),(0,ie.jsx)(a.A,{sx:{flex:1,height:30},children:(0,ie.jsx)(U.u,{width:"100%",height:30,children:(0,ie.jsxs)(q.E,{data:[{name:e.name,valor:e.real}],layout:"vertical",children:[(0,ie.jsx)(X.W,{type:"number",domain:[0,n],hide:!0}),(0,ie.jsx)(Z.h,{type:"category",dataKey:"name",hide:!0}),(0,ie.jsx)(J.m,{formatter:e=>[(0,T.vv)(e),""]}),(0,ie.jsx)(Q.y,{dataKey:"valor",fill:ye,radius:[4,4,4,4],label:{position:"right",formatter:e=>(0,T.vv)(e)}})]})})})]})]})]},"".concat(e.name,"-").concat(t))})})]}),mo.length>0?(0,ie.jsxs)(l.A,{sx:{p:3,mb:2},children:[(0,ie.jsx)(s.A,{variant:"h6",gutterBottom:!0,fontWeight:"600",children:"Distribuci\xf3n de Egresos por Categor\xeda"}),(0,ie.jsx)(U.u,{width:"100%",height:300,children:(0,ie.jsxs)(B.r,{children:[(0,ie.jsx)(V.F,{data:mo,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:100,label:e=>{let{name:t,percent:o}=e;return"".concat(t," ").concat((100*o).toFixed(0),"%")},children:mo.map((e,t)=>(0,ie.jsx)(G.f,{fill:be,opacity:.7+.1*t},"egr-".concat(t)))}),(0,ie.jsx)(J.m,{formatter:e=>(0,T.vv)(e)}),(0,ie.jsx)(K.s,{})]})})]}):(0,ie.jsx)(l.A,{sx:{p:3,mb:2,textAlign:"center"},children:(0,ie.jsx)(s.A,{color:"text.secondary",children:"No hay egresos registrados este mes."})}),ho.length>0&&(0,ie.jsxs)(l.A,{sx:{p:3},children:[(0,ie.jsx)(s.A,{variant:"h6",gutterBottom:!0,fontWeight:"600",children:"Egresos: Estimado vs Real por Categor\xeda"}),(0,ie.jsx)(a.A,{sx:{mt:2},children:ho.map((e,t)=>{const o=ge(e.estimado),i=ge(e.real),n=1.2*Math.max(o,i)||1,l=0===o&&i>0;return(0,ie.jsxs)(a.A,{sx:{mb:3},children:[(0,ie.jsxs)(c.A,{direction:"row",spacing:1,alignItems:"center",mb:1,children:[(0,ie.jsx)(s.A,{variant:"subtitle1",fontWeight:"600",children:e.name}),l&&(0,ie.jsx)(v.A,{title:"Este movimiento no tiene un monto estimado. Hac\xe9 clic para pronosticar.",disableHoverListener:!l,children:(0,ie.jsx)(d.A,{icon:(0,ie.jsx)(te.A,{}),size:"small",label:"Movimiento sin pronosticar",sx:(0,r.A)((0,r.A)({},we),{},{cursor:"pointer"}),onClick:ht})})]}),(0,ie.jsxs)(a.A,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,ie.jsxs)(a.A,{sx:{display:"flex",alignItems:"center",gap:2},children:[(0,ie.jsx)(s.A,{variant:"body2",sx:{minWidth:80},children:"Estimado:"}),(0,ie.jsx)(a.A,{sx:{flex:1,height:30},children:(0,ie.jsx)(U.u,{width:"100%",height:30,children:(0,ie.jsxs)(q.E,{data:[{name:e.name,valor:e.estimado}],layout:"vertical",children:[(0,ie.jsx)(X.W,{type:"number",domain:[0,n],hide:!0}),(0,ie.jsx)(Z.h,{type:"category",dataKey:"name",hide:!0}),(0,ie.jsx)(J.m,{formatter:e=>[(0,T.vv)(e),""]}),(0,ie.jsx)(Q.y,{dataKey:"valor",fill:Se,radius:[4,4,4,4],label:{position:"right",formatter:e=>(0,T.vv)(e)}})]})})})]}),(0,ie.jsxs)(a.A,{sx:{display:"flex",alignItems:"center",gap:2},children:[(0,ie.jsx)(s.A,{variant:"body2",sx:{minWidth:80},children:"Real:"}),(0,ie.jsx)(a.A,{sx:{flex:1,height:30},children:(0,ie.jsx)(U.u,{width:"100%",height:30,children:(0,ie.jsxs)(q.E,{data:[{name:e.name,valor:e.real}],layout:"vertical",children:[(0,ie.jsx)(X.W,{type:"number",domain:[0,n],hide:!0}),(0,ie.jsx)(Z.h,{type:"category",dataKey:"name",hide:!0}),(0,ie.jsx)(J.m,{formatter:e=>[(0,T.vv)(e),""]}),(0,ie.jsx)(Q.y,{dataKey:"valor",fill:be,radius:[4,4,4,4],label:{position:"right",formatter:e=>(0,T.vv)(e)}})]})})})]})]})]},"".concat(e.name,"-").concat(t))})})]})]}),1===ct&&(0,ie.jsxs)(l.A,{sx:{p:2},children:[(0,ie.jsx)(a.A,{sx:{mb:2},children:jt?(0,ie.jsxs)(h.A,{container:!0,spacing:1,alignItems:"center",children:[(0,ie.jsx)(h.A,{item:!0,xs:12,md:4,sx:{minWidth:240},children:(0,ie.jsx)(x.A,{size:"small",fullWidth:!0,value:yt.categoria||null,onChange:(e,t)=>{bt(e=>(0,r.A)((0,r.A)({},e),{},{categoria:t||""}))},options:Pt,freeSolo:!1,disableClearable:!0,forcePopupIcon:!0,popupIcon:(0,ie.jsx)(ee.A,{}),componentsProps:{popupIndicator:{disableRipple:!0,disableFocusRipple:!0,sx:{p:0,m:0,bgcolor:"transparent",border:"none",boxShadow:"none","&:hover":{bgcolor:"transparent"},"& .MuiTouchRipple-root":{display:"none"},"& .MuiSvgIcon-root":{fontSize:24}}},clearIndicator:{sx:{display:"none"}}},sx:{"& .MuiAutocomplete-endAdornment":{right:0,top:"50%",transform:"translateY(-50%)"},"& .MuiAutocomplete-popupIndicator":{p:0},"& .MuiAutocomplete-popupIndicatorOpen .MuiSvgIcon-root":{transform:"none"}},renderInput:e=>(0,ie.jsx)(f.A,(0,r.A)((0,r.A)({},e),{},{label:"Categor\xeda",size:"small",fullWidth:!0,InputLabelProps:e.InputLabelProps}))})}),(0,ie.jsx)(h.A,{item:!0,xs:12,md:2,children:(0,ie.jsxs)(A.A,{fullWidth:!0,size:"small",sx:(0,N.i)(yt.tipo),children:[(0,ie.jsx)(y.A,{children:"Tipo"}),(0,ie.jsxs)(b.A,{label:"Tipo",value:yt.tipo,onChange:e=>bt(t=>(0,r.A)((0,r.A)({},t),{},{tipo:e.target.value})),size:"small",children:[(0,ie.jsx)(j.A,{value:"Ingreso",children:"INGRESO"}),(0,ie.jsx)(j.A,{value:"Egreso",children:"EGRESO"})]})]})}),(0,ie.jsx)(h.A,{item:!0,xs:12,md:3,children:(0,ie.jsx)(f.A,{label:"Estimado",type:"text",fullWidth:!0,size:"small",InputLabelProps:{sx:Ce},value:(0,T.F5)(yt.montoEstimado),onChange:e=>{const t=(0,T.vu)(e.target.value,{returnEmpty:!0});bt(e=>(0,r.A)((0,r.A)({},e),{},{montoEstimado:""===t?"":t}))},inputProps:{inputMode:"numeric"}})}),(0,ie.jsxs)(h.A,{item:!0,xs:12,md:3,display:"flex",gap:1,justifyContent:"flex-end",children:[(0,ie.jsx)(g.A,{variant:"outlined",onClick:()=>{St(!1),bt({categoria:"",tipo:"Egreso",montoEstimado:""})},children:"Cancelar"}),(0,ie.jsx)(g.A,{variant:"contained",onClick:async()=>{try{if(!rt||!at)return;if(!yt.categoria||!yt.tipo)return void At({open:!0,message:"Complet\xe1 Categor\xeda y tipo",severity:"warning"});const e={categoria:yt.categoria,tipo:yt.tipo,montoEstimado:Number(yt.montoEstimado||0)};await W.A.post("".concat(xe,"/api/presupuestos/").concat(rt,"/mes/").concat(at,"/lineas"),e),bt({categoria:"",tipo:"Egreso",montoEstimado:""}),St(!1),await Xt(),At({open:!0,message:"L\xednea agregada",severity:"success"})}catch(e){console.error(e),At({open:!0,message:"Error al agregar",severity:"error"})}},children:"Guardar"})]})]}):(0,ie.jsx)(g.A,{startIcon:(0,ie.jsx)(ae,{}),variant:"contained",onClick:()=>St(!0),children:"Agregar categor\xeda"})}),(0,ie.jsx)(S.A,{sx:{my:2}}),(0,ie.jsx)(a.A,{sx:{overflowX:"auto"},children:(0,ie.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,ie.jsx)("thead",{children:(0,ie.jsxs)("tr",{style:{fontWeight:"bold",borderBottom:"1px solid var(--mui-palette-divider)"},children:[(0,ie.jsx)("th",{style:{padding:12,borderRight:"1px solid var(--mui-palette-divider)"},children:"Categor\xeda"}),(0,ie.jsx)("th",{style:{padding:12,borderRight:"1px solid var(--mui-palette-divider)"},children:"Tipo"}),(0,ie.jsx)("th",{style:{padding:12,borderRight:"1px solid var(--mui-palette-divider)"},children:"Estimado"}),(0,ie.jsx)("th",{style:{padding:12,borderRight:"1px solid var(--mui-palette-divider)"},children:"Real"}),(0,ie.jsx)("th",{style:{padding:12,borderRight:"1px solid var(--mui-palette-divider)"},children:"Desv\xedo"}),(0,ie.jsx)("th",{style:{padding:12},children:"Acciones"})]})}),(0,ie.jsx)("tbody",{children:Bt.length>0?Bt.map((e,t)=>{const o=Ge[e.id]||{categoria:"",tipo:"Egreso",montoEstimado:0,real:""},i=ge(e.montoEstimado),s=o.montoEstimado,l=""===s?0:ge(s),c=""===o.real?0:ge(o.real),u=qt(e.id,"categoria"),m=Boolean(e._soloReal),h=m&&c>0&&!(u&&(""===s||l!==i)),p="Egreso"===o.tipo?l-c:c-l,g=Array.isArray(e.movimientoIds)?e.movimientoIds:[],y=Ye.findIndex(t=>t.id===e.id),S=(t,o)=>Je(i=>(0,r.A)((0,r.A)({},i),{},{[e.id]:(0,r.A)((0,r.A)({},i[e.id]),{},{[t]:o})}));return(0,ie.jsxs)("tr",{style:{borderBottom:"1px solid var(--mui-palette-divider)"},children:[(0,ie.jsx)("td",{style:{padding:12,borderRight:"1px solid var(--mui-palette-divider)",minWidth:215},children:(0,ie.jsx)(a.A,{display:"flex",alignItems:"center",gap:1,children:u?(()=>{const t=o.categoria||"",i=De(t),a=new Set(Bt.filter(t=>t.id!==e.id).map(e=>{var t,o,r;return null!==(t=null!==(o=null===(r=Ge[e.id])||void 0===r?void 0:r.categoria)&&void 0!==o?o:e.categoria)&&void 0!==t?t:""}).map(e=>De(e)).filter(Boolean));let n=Ot.filter(e=>{if("string"!==typeof e)return!1;const t=De(e);return!!t&&(t===i||!a.has(t))});return t&&!n.some(e=>De(e)===i)&&(n=[t,...n]),(0,ie.jsx)(x.A,{size:"small",fullWidth:!0,value:o.categoria||null,onChange:(e,t)=>{S("categoria",t||"")},options:n,freeSolo:!1,disableClearable:!0,forcePopupIcon:!0,popupIcon:(0,ie.jsx)(ee.A,{}),componentsProps:{popupIndicator:{disableRipple:!0,disableFocusRipple:!0,sx:{p:0,m:0,bgcolor:"transparent",border:"none",boxShadow:"none","&:hover":{bgcolor:"transparent"},"& .MuiTouchRipple-root":{display:"none"},"& .MuiSvgIcon-root":{fontSize:24}}},clearIndicator:{sx:{display:"none"}}},sx:{"& .MuiAutocomplete-endAdornment":{right:0,top:"50%",transform:"translateY(-50%)"},"& .MuiAutocomplete-popupIndicator":{p:0},"& .MuiAutocomplete-popupIndicatorOpen .MuiSvgIcon-root":{transform:"none"}},renderInput:e=>(0,ie.jsx)(f.A,(0,r.A)((0,r.A)({},e),{},{size:"small",fullWidth:!0}))})})():(0,ie.jsx)(f.A,{size:"small",fullWidth:!0,value:o.categoria,InputProps:{readOnly:!0}})})}),(0,ie.jsx)("td",{style:{padding:12,borderRight:"1px solid var(--mui-palette-divider)",minWidth:100},children:(0,ie.jsx)(A.A,{size:"small",fullWidth:!0,disabled:!u,sx:(0,N.i)(o.tipo),children:(0,ie.jsxs)(b.A,{value:o.tipo,onChange:e=>{u&&S("tipo",e.target.value)},size:"small",disabled:!u,children:[(0,ie.jsx)(j.A,{value:"Ingreso",children:"INGRESO"}),(0,ie.jsx)(j.A,{value:"Egreso",children:"EGRESO"})]})})}),(0,ie.jsx)("td",{style:{padding:12,borderRight:"1px solid var(--mui-palette-divider)",minWidth:180},children:(0,ie.jsxs)(a.A,{display:"flex",alignItems:"center",gap:1,children:[(0,ie.jsx)(f.A,{size:"small",type:"text",fullWidth:!0,value:(0,T.F5)(o.montoEstimado),onChange:e=>{u&&S("montoEstimado",(0,T.vu)(e.target.value))},InputProps:{readOnly:!u},inputProps:{inputMode:"numeric"}}),u?(0,ie.jsx)(v.A,{title:"Deshabilitar edici\xf3n manual",children:(0,ie.jsx)(n.A,{size:"small",onClick:()=>Jt(e.id,"categoria",!1),children:(0,ie.jsx)(de,{fontSize:"small",color:"warning"})})}):(0,ie.jsx)(v.A,{title:"Editar (categor\xeda, tipo y estimado)",children:(0,ie.jsx)(n.A,{size:"small",onClick:()=>Vt(e.id,"categoria"),children:(0,ie.jsx)(ce,{fontSize:"small"})})})]})}),(0,ie.jsx)("td",{style:{padding:12,borderRight:"1px solid var(--mui-palette-divider)",minWidth:180},children:(0,ie.jsxs)(a.A,{display:"flex",alignItems:"center",gap:1,children:[(0,ie.jsx)(f.A,{size:"small",type:"text",fullWidth:!0,value:(0,T.F5)(o.real),InputProps:{readOnly:!0},inputProps:{inputMode:"numeric"}}),(0,ie.jsx)(v.A,{title:g.length?"Editar monto real":"No hay movimientos para editar",children:(0,ie.jsx)(n.A,{size:"small",onClick:()=>Vt(e.id,"real"),children:(0,ie.jsx)(le,{fontSize:"small"})})})]})}),(0,ie.jsxs)("td",{style:{padding:12,borderRight:"1px solid var(--mui-palette-divider)",color:p>=0?"#66bb6a":"#ef5350",minWidth:100},children:[p>=0?"+":"-",(0,T.vv)(Math.abs(p))]}),(0,ie.jsx)("td",{style:{padding:12,whiteSpace:"nowrap",textAlign:"center"},children:(0,ie.jsxs)(a.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",gap:1.5},children:[(0,ie.jsx)(v.A,{title:m?"Crear linea de presupuesto con este movimiento":"Guardar cambios",children:(0,ie.jsx)("span",{children:(0,ie.jsx)(n.A,{size:"small",onClick:()=>{const t={id:e.id,categoria:o.categoria,tipo:o.tipo,montoEstimado:ge(o.montoEstimado),real:""===o.real?null:ge(o.real)};m?(async e=>{try{if(!rt||!at)return;const t={categoria:e.categoria,tipo:e.tipo,montoEstimado:ge(e.montoEstimado),real:""===e.real||null==e.real?null:ge(e.real)};await W.A.post("".concat(xe,"/api/presupuestos/").concat(rt,"/mes/").concat(at,"/lineas"),t),At({open:!0,message:"L\xednea agregada desde movimiento real.",severity:"success"}),await Xt()}catch(o){var t,r;console.error(o);const i=(null===o||void 0===o||null===(t=o.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.message)||"Error al crear l\xednea";At({open:!0,message:i,severity:"error"})}})(t):(async e=>{try{var t,i,a,n,s,l,c,d;if(!rt||!at||null===e||void 0===e||!e.id)return;const o=["".concat(xe,"/api/presupuestos/").concat(rt,"/mes/").concat(at,"/lineas/").concat(e.id),"".concat(xe,"/api/presupuestos/").concat(rt,"/mes/").concat(Ie(at),"/lineas/").concat(e.id)],p=["patch","put"],v=[po(e),vo(e)];let g=null;for(const t of o)for(const o of p)try{return await go(o,t,v[0]),qe(t=>t&&t[e.id]?(0,r.A)((0,r.A)({},t),{},{[e.id]:{categoria:!1,real:!1}}):t),await Xt(),void At({open:!0,message:"L\xednea actualizada",severity:"success"})}catch(m){var u;if(g=m,400===(null===m||void 0===m||null===(u=m.response)||void 0===u?void 0:u.status))try{return await go(o,t,v[1]),qe(t=>t&&t[e.id]?(0,r.A)((0,r.A)({},t),{},{[e.id]:{categoria:!1,real:!1}}):t),await Xt(),void At({open:!0,message:"L\xednea actualizada",severity:"success"})}catch(h){g=h}}const x=(null===(t=g)||void 0===t||null===(i=t.response)||void 0===i||null===(a=i.data)||void 0===a?void 0:a.message)||(null===(n=g)||void 0===n||null===(s=n.response)||void 0===s||null===(l=s.data)||void 0===l?void 0:l.error)||(null===(c=g)||void 0===c?void 0:c.message)||"Error al actualizar";At({open:!0,message:x,severity:"error"}),console.error("patchLinea error:",(null===(d=g)||void 0===d?void 0:d.response)||g)}catch(o){console.error(o),At({open:!0,message:"Error al actualizar",severity:"error"})}})(t)},children:(0,ie.jsx)(se,{})})})}),h&&(0,ie.jsx)(v.A,{title:"Movimiento sin pronosticar: no tiene monto estimado.",children:(0,ie.jsx)(d.A,{size:"small",icon:(0,ie.jsx)(te.A,{fontSize:"small"}),label:"Sin pronosticar",variant:"filled",sx:we})}),!m&&(0,ie.jsxs)(ie.Fragment,{children:[(0,ie.jsx)(v.A,{title:"Eliminar esta linea",children:(0,ie.jsx)("span",{children:(0,ie.jsx)(n.A,{size:"small",onClick:()=>(e=>{Rt({open:!0,id:e.id,categoria:e.categoria,tipo:e.tipo})})(e),children:(0,ie.jsx)(ne.A,{})})})}),(0,ie.jsx)(v.A,{title:"Aplicar esta linea a varios meses",children:(0,ie.jsx)("span",{children:(0,ie.jsx)(n.A,{size:"small",onClick:()=>{y>=0&&(e=>{const t="number"===typeof e?e:gt;null!=t&&(xt(t),Dt(e=>(0,r.A)((0,r.A)({},e),{},{accion:"replicar",desde:at||"",hasta:at||""})),kt(!0))})(y)},children:(0,ie.jsx)(oe.A,{})})})})]})]})})]},e.id)}):(0,ie.jsx)("tr",{children:(0,ie.jsx)("td",{colSpan:6,style:{textAlign:"center",padding:20,color:"var(--mui-palette-text-secondary)"},children:"No hay datos disponibles."})})})]})})]}),(0,ie.jsx)(a.A,{mt:4,display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:1,children:(0,ie.jsx)(g.A,{variant:"outlined",onClick:()=>Te(-1),children:"Volver"})}),(0,ie.jsxs)(w.A,{open:Xe.open,onClose:Gt,maxWidth:"sm",fullWidth:!0,children:[(0,ie.jsx)(C.A,{children:Xe.title||"Confirmar edici\xf3n manual"}),(0,ie.jsx)(E.A,{dividers:!0,children:(0,ie.jsx)(s.A,{variant:"body2",color:"text.secondary",children:Xe.message||"Esta acci\xf3n habilita la edici\xf3n manual."})}),(0,ie.jsxs)(M.A,{children:[(0,ie.jsx)(g.A,{onClick:Gt,children:"Cancelar"}),(0,ie.jsx)(g.A,{variant:"contained",color:"warning",onClick:Kt,children:Xe.confirmLabel||"Confirmar"})]})]}),(0,ie.jsxs)(w.A,{open:zt.open,onClose:xo,maxWidth:"xs",fullWidth:!0,children:[(0,ie.jsx)(C.A,{children:"Eliminar movimiento"}),(0,ie.jsxs)(E.A,{dividers:!0,children:[(0,ie.jsxs)(s.A,{variant:"body2",color:"text.secondary",children:["Se eliminar\xe1 la categor\xeda ",(0,ie.jsx)("strong",{children:zt.categoria||"sin nombre"})," (",zt.tipo?zt.tipo.toLowerCase():"movimiento",") de este mes."]}),(0,ie.jsx)(s.A,{variant:"body2",color:"text.secondary",sx:{mt:1},children:"Esta acci\xf3n no se puede deshacer."})]}),(0,ie.jsxs)(M.A,{children:[(0,ie.jsx)(g.A,{onClick:xo,children:"Cancelar"}),(0,ie.jsx)(g.A,{variant:"contained",color:"error",onClick:async()=>{const e=zt.id;Rt({open:!1,id:null,categoria:"",tipo:""}),null!=e&&await(async e=>{try{if(!rt||!at||!e)return;await W.A.delete("".concat(xe,"/api/presupuestos/").concat(rt,"/mes/").concat(at,"/lineas/").concat(e)),await Xt(),At({open:!0,message:"L\xednea eliminada",severity:"success"})}catch(t){console.error(t),At({open:!0,message:"Error al eliminar",severity:"error"})}})(e)},children:"Eliminar"})]})]}),(0,ie.jsxs)(w.A,{open:wt,onClose:()=>Ct(!1),fullWidth:!0,maxWidth:"sm",children:[(0,ie.jsx)(C.A,{children:"Reglas r\xe1pidas (simulaci\xf3n)"}),(0,ie.jsx)(E.A,{dividers:!0,children:(0,ie.jsxs)(c.A,{spacing:2,sx:{mt:1},children:[(0,ie.jsxs)(f.A,{select:!0,label:"\xc1mbito",value:Et.ambito,onChange:e=>Mt(t=>(0,r.A)((0,r.A)({},t),{},{ambito:e.target.value})),children:[(0,ie.jsx)(j.A,{value:"este_mes",children:"Este mes"}),(0,ie.jsx)(j.A,{value:"hasta_fin",children:"Desde este mes hasta fin de a\xf1o"}),(0,ie.jsx)(j.A,{value:"rango",children:"Rango personalizado"})]}),"rango"===Et.ambito&&(0,ie.jsxs)(c.A,{direction:"row",spacing:2,children:[(0,ie.jsx)(f.A,{label:"Desde (YYYY-MM)",value:Et.rangoDesde,onChange:e=>Mt(t=>(0,r.A)((0,r.A)({},t),{},{rangoDesde:e.target.value}))}),(0,ie.jsx)(f.A,{label:"Hasta (YYYY-MM)",value:Et.rangoHasta,onChange:e=>Mt(t=>(0,r.A)((0,r.A)({},t),{},{rangoHasta:e.target.value}))})]}),(0,ie.jsxs)(f.A,{select:!0,label:"Modo",value:Et.modo,onChange:e=>Mt(t=>(0,r.A)((0,r.A)({},t),{},{modo:e.target.value})),children:[(0,ie.jsx)(j.A,{value:"FIJO",children:"Monto fijo"}),(0,ie.jsx)(j.A,{value:"AJUSTE_PCT",children:"% Ajuste mensual"}),(0,ie.jsx)(j.A,{value:"UNICO",children:"\xdanico (1 mes)"}),(0,ie.jsx)(j.A,{value:"CUOTAS",children:"En cuotas"})]}),(0,ie.jsx)(f.A,{label:"AJUSTE_PCT"===Et.modo?"% valor":"Monto",type:"AJUSTE_PCT"===Et.modo?"number":"text",value:"AJUSTE_PCT"===Et.modo?Et.valor:(0,T.F5)(Et.valor),onChange:e=>{if("AJUSTE_PCT"===Et.modo)Mt(t=>(0,r.A)((0,r.A)({},t),{},{valor:Number(e.target.value)}));else{const t=(0,T.vu)(e.target.value,{returnEmpty:!0});Mt(e=>(0,r.A)((0,r.A)({},e),{},{valor:""===t?"":t}))}},inputProps:"AJUSTE_PCT"===Et.modo?{step:.1,inputMode:"decimal"}:{inputMode:"numeric"}}),(0,ie.jsxs)(f.A,{select:!0,label:"Aplicar a",value:Et.solo,onChange:e=>Mt(t=>(0,r.A)((0,r.A)({},t),{},{solo:e.target.value})),children:[(0,ie.jsx)(j.A,{value:"todos",children:"Ingresos y egresos"}),(0,ie.jsx)(j.A,{value:"Ingresos",children:"Solo ingresos"}),(0,ie.jsx)(j.A,{value:"Egresos",children:"Solo egresos"})]}),(0,ie.jsxs)(l.A,{variant:"outlined",sx:{p:2},children:[(0,ie.jsx)(s.A,{variant:"subtitle2",gutterBottom:!0,children:"Previsualizaci\xf3n (conceptual)"}),(0,ie.jsx)(s.A,{variant:"body2",color:"text.secondary",children:"Aqu\xed mostrar\xedas una mini-grilla con las celdas impactadas antes de confirmar."})]}),(0,ie.jsx)(I.A,{control:(0,ie.jsx)(k.A,{checked:pt,onChange:(e,t)=>vt(t)}),label:"Simular cambios (no impacta datos reales)"})]})}),(0,ie.jsxs)(M.A,{children:[(0,ie.jsx)(g.A,{onClick:()=>Ct(!1),children:"Cerrar"}),(0,ie.jsx)(g.A,{variant:"contained",disabled:!pt,onClick:()=>{Ct(!1),window.alert("Simulaci\xf3n: regla aplicada (visual).")},children:"Aplicar (visual)"})]})]}),(0,ie.jsxs)(w.A,{open:It,onClose:()=>kt(!1),fullWidth:!0,maxWidth:"sm",children:[(0,ie.jsx)(C.A,{children:"Aplicar a varios meses"}),(0,ie.jsx)(E.A,{dividers:!0,children:(0,ie.jsxs)(c.A,{spacing:2,children:[(0,ie.jsxs)(f.A,{select:!0,label:"Acci\xf3n",value:$t.accion,onChange:e=>Dt(t=>(0,r.A)((0,r.A)({},t),{},{accion:e.target.value})),children:[(0,ie.jsx)(j.A,{value:"replicar",children:"Replicar esta l\xednea en un rango"}),(0,ie.jsx)(j.A,{value:"eliminar",children:"Eliminar esta categor\xeda (mismo tipo) en un rango"})]}),(0,ie.jsxs)(c.A,{direction:"row",spacing:2,children:[(0,ie.jsx)(f.A,{label:"Desde (YYYY-MM)",value:$t.desde,onChange:e=>Dt(t=>(0,r.A)((0,r.A)({},t),{},{desde:e.target.value})),placeholder:"2025-07"}),(0,ie.jsx)(f.A,{label:"Hasta (YYYY-MM)",value:$t.hasta,onChange:e=>Dt(t=>(0,r.A)((0,r.A)({},t),{},{hasta:e.target.value})),placeholder:"2025-12"})]}),(0,ie.jsxs)(s.A,{variant:"body2",color:"text.secondary",children:["\u2022 Replicar: crea una l\xednea por cada mes con los mismos valores (no deduplica).",(0,ie.jsx)("br",{}),"\u2022 Eliminar: busca por ",(0,ie.jsx)("b",{children:"categor\xeda + tipo"})," en cada mes y borra coincidencias."]})]})}),(0,ie.jsxs)(M.A,{children:[(0,ie.jsx)(g.A,{onClick:()=>kt(!1),children:"Cancelar"}),(0,ie.jsx)(g.A,{variant:"contained",onClick:async()=>{try{if(null==gt)return;const t=Ye[gt];if(!t||!rt)return;const{accion:o,desde:r,hasta:i}=$t;if(!r||!i)return void At({open:!0,message:"Complet\xe1 rango de meses",severity:"warning"});const a=ke(r,i);if(0===a.length)return void At({open:!0,message:"Rango inv\xe1lido",severity:"warning"});if("replicar"===o){const e={categoria:t.categoria,tipo:t.tipo,montoEstimado:Number(t.montoEstimado||0),real:""===t.real||null==t.real?null:Number(t.real)};for(const t of a)await W.A.post("".concat(xe,"/api/presupuestos/").concat(rt,"/mes/").concat(t,"/lineas"),e);At({open:!0,message:"Replicado en ".concat(a.length," mes(es)"),severity:"success"})}else if("eliminar"===o){for(const o of a){const r=["".concat(xe,"/api/presupuestos/").concat(rt,"/mes/").concat(o),"".concat(xe,"/api/presupuestos/").concat(rt,"/mes/").concat(Ie(o))];let i=[];for(const t of r)try{const e=await W.A.get(t),o=null===e||void 0===e?void 0:e.data;if(i=(Array.isArray(o)?o:Array.isArray(null===o||void 0===o?void 0:o.lineas)?o.lineas:Array.isArray(null===o||void 0===o?void 0:o.categorias)?o.categorias:[]).map($e),i.length)break}catch(e){}const a=i.filter(e=>(e.categoria||"").toLowerCase().trim()===(t.categoria||"").toLowerCase().trim()&&e.tipo===t.tipo);for(const e of a)await W.A.delete("".concat(xe,"/api/presupuestos/").concat(rt,"/mes/").concat(o,"/lineas/").concat(e.id))}At({open:!0,message:"Eliminado en ".concat(a.length," mes(es)"),severity:"success"})}kt(!1),await Xt()}catch(t){console.error(t),At({open:!0,message:"Error en operaci\xf3n por m\xfaltiples meses",severity:"error"})}},children:"Confirmar"})]})]}),"      ",(0,ie.jsx)($.A,{open:ft.open,autoHideDuration:3e3,onClose:()=>At(e=>(0,r.A)((0,r.A)({},e),{},{open:!1})),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:(0,ie.jsx)(D.A,{onClose:()=>At(e=>(0,r.A)((0,r.A)({},e),{},{open:!1})),severity:ft.severity,sx:{width:"100%"},children:ft.message})})]})}},19817:(e,t,o)=>{"use strict";o.d(t,{A:()=>a});var r=o(14057),i=o(70579);const a=(0,r.A)((0,i.jsx)("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"}),"ContentCopy")},20475:(e,t,o)=>{"use strict";o.d(t,{F5:()=>a,vu:()=>n,vv:()=>i});const r=new Intl.NumberFormat("es-AR",{minimumFractionDigits:0,maximumFractionDigits:2}),i=function(e){let{allowEmpty:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(""===e||null===e||"undefined"===typeof e)return t?"":"$ 0";const o=Number(e);if(Number.isNaN(o))return t?"":"$ 0";return"".concat(o<0?"-":"","$ ").concat(r.format(Math.abs(o)))},a=e=>i(e,{allowEmpty:!0}),n=function(e){let{returnEmpty:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null==e)return t?"":0;const o=e.toString().trim();if(!o)return t?"":0;const r=o.replace(/\s+/g,"").replace(/\$/g,""),i=r.startsWith("-"),a=r.replace(/[^0-9,.-]/g,"");if(!a||"-"===a)return t?"":0;const n=a.replace(/-/g,"").replace(/\./g,"").replace(",","."),s=Number(n);return Number.isNaN(s)?t?"":0:i?-s:s}},34955:(e,t,o)=>{"use strict";o.d(t,{A:()=>p});var r=o(89379),i=(o(65043),o(53969)),a=o(26529),n=o(56647),s=o(74917),l=o(36252),c=o(70579);const d="#FDE4E3",u="#FACDCA",m="#E5F4E5",h="#CAE7CB";function p(e){let{onExportPdf:t,onExportExcel:o,sx:p={}}=e;return(0,c.jsxs)(i.A,{sx:(0,r.A)({display:"flex",gap:1},p),children:[(0,c.jsx)(a.A,{title:"Exportar PDF",children:(0,c.jsx)(n.A,{onClick:t,size:"small",color:"error",sx:e=>{const t={bgcolor:"".concat(u," !important"),backgroundColor:"".concat(u," !important"),borderColor:"#d32f2f","& .MuiSvgIcon-root":{color:"#000 !important"}};return(0,r.A)({border:"1px solid",borderColor:"#d32f2f",bgcolor:"".concat(d," !important"),backgroundColor:"".concat(d," !important"),"& .MuiSvgIcon-root":{color:"#000 !important"},"&:hover":t,width:36,height:36},e.applyStyles("dark",{borderColor:"#d32f2f","&:hover":t}))},"aria-label":"Exportar PDF",children:(0,c.jsx)(s.A,{fontSize:"small"})})}),(0,c.jsx)(a.A,{title:"Exportar Excel",children:(0,c.jsxs)(n.A,{onClick:o,size:"small",color:"success",sx:e=>{const t={bgcolor:"".concat(h," !important"),backgroundColor:"".concat(h," !important"),borderColor:"#2e7d32","& .MuiSvgIcon-root":{color:"#000 !important"}};return(0,r.A)({border:"1px solid",borderColor:"#2e7d32",bgcolor:"".concat(m," !important"),backgroundColor:"".concat(m," !important"),"& .MuiSvgIcon-root":{color:"#000 !important"},"&:hover":t,width:36,height:36},e.applyStyles("dark",{borderColor:"#2e7d32","&:hover":t}))},"aria-label":"Exportar Excel",children:[(0,c.jsx)(l.A,{fontSize:"small"})," "]})})]})}},38915:(e,t,o)=>{"use strict";o.d(t,{A:()=>x});var r=o(79722),i=o(35644),a=o(29296),n=o(13658);const s=r.A.create(),l=n.A.PRONOSTICO,c={UserPoolId:"sa-east-1_lTMNrWW7R",ClientId:"3ksssqtg3r49rf6js1t1177hrd"};let d=null,u=!1;const m=e=>Boolean(e&&l&&String(e).startsWith(String(l))),h=e=>{try{return sessionStorage.getItem(e)}catch(t){return console.warn("No se pudo leer sessionStorage:",t),null}},p=(e,t)=>{try{void 0!==t&&null!==t&&sessionStorage.setItem(e,t)}catch(o){console.warn("No se pudo escribir en sessionStorage:",o)}},v=()=>{if(!u){u=!0;try{sessionStorage.clear()}catch(e){}null!==a.m&&void 0!==a.m&&a.m.limpiarSesion&&a.m.limpiarSesion(),"undefined"!==typeof window&&(window.location.href="/#/signin")}},g=()=>{const e=h("refreshToken"),t=(()=>{const e=h("email")||h("username");if(!e||!c.UserPoolId||!c.ClientId)return null;const t=new i.NE(c);return new i.TU({Username:e,Pool:t})})();if(!e||!t)return Promise.reject(new Error("No hay datos para renovar la sesi\xf3n."));const o=new i.c9({RefreshToken:e});return new Promise((e,r)=>{t.refreshSession(o,(t,o)=>{if(t)return void r(t);const i=o.getAccessToken().getJwtToken(),a=o.getIdToken().getJwtToken(),n=o.getRefreshToken().getToken();p("accessToken",i),p("idToken",a),n&&p("refreshToken",n),e(i)})})};s.interceptors.request.use(e=>{const t=sessionStorage.getItem("accessToken");if(m(e.url)){var o;e.headers=null!==(o=e.headers)&&void 0!==o?o:{},t&&(e.headers.Authorization="Bearer ".concat(t));const r=sessionStorage.getItem("sub");r&&(e.headers["X-Usuario-Sub"]=r)}return e}),s.interceptors.response.use(e=>e,async e=>{const{config:t,response:o}=e;if(!t||!o||401!==o.status||!m(t.url))return Promise.reject(e);if(t.__isRetryRequest)return v(),Promise.reject(e);try{var r;const e=await(d||(d=g().then(e=>(d=null,e)).catch(e=>{throw d=null,e})),d);if(!e)throw new Error("No se obtuvo un token renovado.");return t.__isRetryRequest=!0,t.headers=null!==(r=t.headers)&&void 0!==r?r:{},t.headers.Authorization="Bearer ".concat(e),s(t)}catch(i){return v(),Promise.reject(i)}});const x=s},47436:(e,t,o)=>{"use strict";o.d(t,{F:()=>n,c:()=>s});var r=o(79722);const i=o(13658).A.REGISTRO;function a(){const e={},t=sessionStorage.getItem("sub"),o=sessionStorage.getItem("accessToken");return t&&(e["X-Usuario-Sub"]=t),o&&(e.Authorization="Bearer ".concat(o)),e}async function n(e){let{fechaDesde:t,fechaHasta:o,tipos:n}=e;const s=new URLSearchParams;s.set("page",0),s.set("size",500),t&&s.set("fechaDesde",t),o&&s.set("fechaHasta",o),Array.isArray(n)&&n.length>0?s.set("tipos",n.join(",")):"string"===typeof n&&n&&s.set("tipos",n);const l="".concat(i,"/movimientos?").concat(s.toString()),{data:c}=await r.A.get(l,{headers:a()});return c}async function s(e){let{fechaDesde:t,fechaHasta:o}=e;const n=new URLSearchParams;t&&n.set("fechaDesde",t),o&&n.set("fechaHasta",o);const s="".concat(i,"/movimientos/presupuesto/datos-completos?").concat(n.toString()),{data:l}=await r.A.get(s,{headers:a()});return l}},60446:function(e){e.exports=function(){"use strict";var e=1e3,t=6e4,o=36e5,r="millisecond",i="second",a="minute",n="hour",s="day",l="week",c="month",d="quarter",u="year",m="date",h="Invalid Date",p=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,v=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,g={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],o=e%100;return"["+e+(t[(o-20)%10]||t[o]||t[0])+"]"}},x=function(e,t,o){var r=String(e);return!r||r.length>=t?e:""+Array(t+1-r.length).join(o)+e},f={s:x,z:function(e){var t=-e.utcOffset(),o=Math.abs(t),r=Math.floor(o/60),i=o%60;return(t<=0?"+":"-")+x(r,2,"0")+":"+x(i,2,"0")},m:function e(t,o){if(t.date()<o.date())return-e(o,t);var r=12*(o.year()-t.year())+(o.month()-t.month()),i=t.clone().add(r,c),a=o-i<0,n=t.clone().add(r+(a?-1:1),c);return+(-(r+(o-i)/(a?i-n:n-i))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:c,y:u,w:l,d:s,D:m,h:n,m:a,s:i,ms:r,Q:d}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},A="en",y={};y[A]=g;var b="$isDayjsObject",j=function(e){return e instanceof E||!(!e||!e[b])},S=function e(t,o,r){var i;if(!t)return A;if("string"==typeof t){var a=t.toLowerCase();y[a]&&(i=a),o&&(y[a]=o,i=a);var n=t.split("-");if(!i&&n.length>1)return e(n[0])}else{var s=t.name;y[s]=t,i=s}return!r&&i&&(A=i),i||!r&&A},w=function(e,t){if(j(e))return e.clone();var o="object"==typeof t?t:{};return o.date=e,o.args=arguments,new E(o)},C=f;C.l=S,C.i=j,C.w=function(e,t){return w(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var E=function(){function g(e){this.$L=S(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[b]=!0}var x=g.prototype;return x.parse=function(e){this.$d=function(e){var t=e.date,o=e.utc;if(null===t)return new Date(NaN);if(C.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var r=t.match(p);if(r){var i=r[2]-1||0,a=(r[7]||"0").substring(0,3);return o?new Date(Date.UTC(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,a)):new Date(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,a)}}return new Date(t)}(e),this.init()},x.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},x.$utils=function(){return C},x.isValid=function(){return!(this.$d.toString()===h)},x.isSame=function(e,t){var o=w(e);return this.startOf(t)<=o&&o<=this.endOf(t)},x.isAfter=function(e,t){return w(e)<this.startOf(t)},x.isBefore=function(e,t){return this.endOf(t)<w(e)},x.$g=function(e,t,o){return C.u(e)?this[t]:this.set(o,e)},x.unix=function(){return Math.floor(this.valueOf()/1e3)},x.valueOf=function(){return this.$d.getTime()},x.startOf=function(e,t){var o=this,r=!!C.u(t)||t,d=C.p(e),h=function(e,t){var i=C.w(o.$u?Date.UTC(o.$y,t,e):new Date(o.$y,t,e),o);return r?i:i.endOf(s)},p=function(e,t){return C.w(o.toDate()[e].apply(o.toDate("s"),(r?[0,0,0,0]:[23,59,59,999]).slice(t)),o)},v=this.$W,g=this.$M,x=this.$D,f="set"+(this.$u?"UTC":"");switch(d){case u:return r?h(1,0):h(31,11);case c:return r?h(1,g):h(0,g+1);case l:var A=this.$locale().weekStart||0,y=(v<A?v+7:v)-A;return h(r?x-y:x+(6-y),g);case s:case m:return p(f+"Hours",0);case n:return p(f+"Minutes",1);case a:return p(f+"Seconds",2);case i:return p(f+"Milliseconds",3);default:return this.clone()}},x.endOf=function(e){return this.startOf(e,!1)},x.$set=function(e,t){var o,l=C.p(e),d="set"+(this.$u?"UTC":""),h=(o={},o[s]=d+"Date",o[m]=d+"Date",o[c]=d+"Month",o[u]=d+"FullYear",o[n]=d+"Hours",o[a]=d+"Minutes",o[i]=d+"Seconds",o[r]=d+"Milliseconds",o)[l],p=l===s?this.$D+(t-this.$W):t;if(l===c||l===u){var v=this.clone().set(m,1);v.$d[h](p),v.init(),this.$d=v.set(m,Math.min(this.$D,v.daysInMonth())).$d}else h&&this.$d[h](p);return this.init(),this},x.set=function(e,t){return this.clone().$set(e,t)},x.get=function(e){return this[C.p(e)]()},x.add=function(r,d){var m,h=this;r=Number(r);var p=C.p(d),v=function(e){var t=w(h);return C.w(t.date(t.date()+Math.round(e*r)),h)};if(p===c)return this.set(c,this.$M+r);if(p===u)return this.set(u,this.$y+r);if(p===s)return v(1);if(p===l)return v(7);var g=(m={},m[a]=t,m[n]=o,m[i]=e,m)[p]||1,x=this.$d.getTime()+r*g;return C.w(x,this)},x.subtract=function(e,t){return this.add(-1*e,t)},x.format=function(e){var t=this,o=this.$locale();if(!this.isValid())return o.invalidDate||h;var r=e||"YYYY-MM-DDTHH:mm:ssZ",i=C.z(this),a=this.$H,n=this.$m,s=this.$M,l=o.weekdays,c=o.months,d=o.meridiem,u=function(e,o,i,a){return e&&(e[o]||e(t,r))||i[o].slice(0,a)},m=function(e){return C.s(a%12||12,e,"0")},p=d||function(e,t,o){var r=e<12?"AM":"PM";return o?r.toLowerCase():r};return r.replace(v,function(e,r){return r||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return C.s(t.$y,4,"0");case"M":return s+1;case"MM":return C.s(s+1,2,"0");case"MMM":return u(o.monthsShort,s,c,3);case"MMMM":return u(c,s);case"D":return t.$D;case"DD":return C.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return u(o.weekdaysMin,t.$W,l,2);case"ddd":return u(o.weekdaysShort,t.$W,l,3);case"dddd":return l[t.$W];case"H":return String(a);case"HH":return C.s(a,2,"0");case"h":return m(1);case"hh":return m(2);case"a":return p(a,n,!0);case"A":return p(a,n,!1);case"m":return String(n);case"mm":return C.s(n,2,"0");case"s":return String(t.$s);case"ss":return C.s(t.$s,2,"0");case"SSS":return C.s(t.$ms,3,"0");case"Z":return i}return null}(e)||i.replace(":","")})},x.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},x.diff=function(r,m,h){var p,v=this,g=C.p(m),x=w(r),f=(x.utcOffset()-this.utcOffset())*t,A=this-x,y=function(){return C.m(v,x)};switch(g){case u:p=y()/12;break;case c:p=y();break;case d:p=y()/3;break;case l:p=(A-f)/6048e5;break;case s:p=(A-f)/864e5;break;case n:p=A/o;break;case a:p=A/t;break;case i:p=A/e;break;default:p=A}return h?p:C.a(p)},x.daysInMonth=function(){return this.endOf(c).$D},x.$locale=function(){return y[this.$L]},x.locale=function(e,t){if(!e)return this.$L;var o=this.clone(),r=S(e,t,!0);return r&&(o.$L=r),o},x.clone=function(){return C.w(this.$d,this)},x.toDate=function(){return new Date(this.valueOf())},x.toJSON=function(){return this.isValid()?this.toISOString():null},x.toISOString=function(){return this.$d.toISOString()},x.toString=function(){return this.$d.toUTCString()},g}(),M=E.prototype;return w.prototype=M,[["$ms",r],["$s",i],["$m",a],["$H",n],["$W",s],["$M",c],["$y",u],["$D",m]].forEach(function(e){M[e[1]]=function(t){return this.$g(t,e[0],e[1])}}),w.extend=function(e,t){return e.$i||(e(t,E,w),e.$i=!0),w},w.locale=S,w.isDayjs=j,w.unix=function(e){return w(1e3*e)},w.en=y[A],w.Ls=y,w.p={},w}()},67819:(e,t,o)=>{"use strict";o.d(t,{i:()=>i});var r=o(89826);const i=e=>t=>{var o,i;const a="ingreso"===String(e).toLowerCase()?"#2e7d32":"#d32f2f",n=(0,r.X4)(a,.12),s=(0,r.X4)(a,.16),l=(0,r.X4)(a,.2),c=(t.vars||t).palette,d=c.text.primary,u=null!==(o=null===(i=c.text)||void 0===i?void 0:i.primaryChannel)&&void 0!==o?o:"dark"===t.palette.mode?"255 255 255":"0 0 0",m="&& .MuiOutlinedInput-root",h=["".concat(m," .MuiSelect-select"),"".concat(m," .MuiSelect-select.MuiSelect-outlined"),"".concat(m," .MuiSelect-select.MuiSelect-outlined.MuiInputBase-input"),"".concat(m," .MuiInputBase-input"),"".concat(m," .MuiOutlinedInput-input")].join(", "),p=["".concat(m," .MuiSelect-icon"),"".concat(m," .MuiSelect-iconOutlined"),"".concat(m," .MuiSvgIcon-root")].join(", ");return{[m]:{borderRadius:1,color:d,backgroundColor:n,"--mui-palette-text-primary":d,"--mui-palette-text-secondary":d,"--mui-palette-action-active":d,"--mui-palette-text-primaryChannel":u,"--mui-palette-text-secondaryChannel":u,"--mui-palette-action-activeChannel":u,"&:hover":{backgroundColor:s},"&.Mui-focused":{backgroundColor:l},"& fieldset":{borderColor:c.divider},"&:hover fieldset":{borderColor:c.divider},"&.Mui-focused fieldset":{borderColor:c.divider}},[h]:{color:d,WebkitTextFillColor:d,fontWeight:200},[p]:{color:d},"&& .MuiInputLabel-root, && .MuiInputLabel-root.Mui-focused":{color:d,WebkitTextFillColor:d}}}},88746:(e,t,o)=>{"use strict";o.d(t,{A:()=>a});var r=o(14057),i=o(70579);const a=(0,r.A)((0,i.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM8 9h8v10H8zm7.5-5-1-1h-5l-1 1H5v2h14V4z"}),"DeleteOutline")},92659:(e,t,o)=>{"use strict";o.d(t,{gd:()=>a});const r=["Alimentos y Bebidas","Transporte","Vivienda","Servicios B\xe1sicos","Ocio y Entretenimiento","Compras Personales","Salud","Educaci\xf3n","Impuestos y Tasas","Servicios Financieros","Compras de Negocio","Otros Egresos"],i=["Ventas de Productos","Prestaci\xf3n de Servicios","Cobranzas","Transferencias Recibidas","Inversiones y Rendimientos","Otros Ingresos"],a=[...r,...i]}}]);
//# sourceMappingURL=8177.0fe655fc.chunk.js.map