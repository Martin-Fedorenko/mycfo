"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[1070],{20475:(e,t,s)=>{s.d(t,{F5:()=>n,vu:()=>a,vv:()=>r});const o=new Intl.NumberFormat("es-AR",{minimumFractionDigits:0,maximumFractionDigits:2}),r=function(e){let{allowEmpty:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(""===e||null===e||"undefined"===typeof e)return t?"":"$ 0";const s=Number(e);if(Number.isNaN(s))return t?"":"$ 0";return"".concat(s<0?"-":"","$ ").concat(o.format(Math.abs(s)))},n=e=>r(e,{allowEmpty:!0}),a=function(e){let{returnEmpty:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null==e)return t?"":0;const s=e.toString().trim();if(!s)return t?"":0;const o=s.replace(/\s+/g,"").replace(/\$/g,""),r=o.startsWith("-"),n=o.replace(/[^0-9,.-]/g,"");if(!n||"-"===n)return t?"":0;const a=n.replace(/-/g,"").replace(/\./g,"").replace(",","."),l=Number(a);return Number.isNaN(l)?t?"":0:r?-l:l}},34955:(e,t,s)=>{s.d(t,{A:()=>x});var o=s(89379),r=(s(65043),s(53969)),n=s(26529),a=s(56647),l=s(74917),i=s(36252),c=s(70579);const d="#FDE4E3",u="#FACDCA",h="#E5F4E5",m="#CAE7CB";function x(e){let{onExportPdf:t,onExportExcel:s,sx:x={}}=e;return(0,c.jsxs)(r.A,{sx:(0,o.A)({display:"flex",gap:1},x),children:[(0,c.jsx)(n.A,{title:"Exportar PDF",children:(0,c.jsx)(a.A,{onClick:t,size:"small",color:"error",sx:e=>{const t={bgcolor:"".concat(u," !important"),backgroundColor:"".concat(u," !important"),borderColor:"#d32f2f","& .MuiSvgIcon-root":{color:"#000 !important"}};return(0,o.A)({border:"1px solid",borderColor:"#d32f2f",bgcolor:"".concat(d," !important"),backgroundColor:"".concat(d," !important"),"& .MuiSvgIcon-root":{color:"#000 !important"},"&:hover":t,width:36,height:36},e.applyStyles("dark",{borderColor:"#d32f2f","&:hover":t}))},"aria-label":"Exportar PDF",children:(0,c.jsx)(l.A,{fontSize:"small"})})}),(0,c.jsx)(n.A,{title:"Exportar Excel",children:(0,c.jsxs)(a.A,{onClick:s,size:"small",color:"success",sx:e=>{const t={bgcolor:"".concat(m," !important"),backgroundColor:"".concat(m," !important"),borderColor:"#2e7d32","& .MuiSvgIcon-root":{color:"#000 !important"}};return(0,o.A)({border:"1px solid",borderColor:"#2e7d32",bgcolor:"".concat(h," !important"),backgroundColor:"".concat(h," !important"),"& .MuiSvgIcon-root":{color:"#000 !important"},"&:hover":t,width:36,height:36},e.applyStyles("dark",{borderColor:"#2e7d32","&:hover":t}))},"aria-label":"Exportar Excel",children:[(0,c.jsx)(i.A,{fontSize:"small"})," "]})})]})}},38915:(e,t,s)=>{s.d(t,{A:()=>v});var o=s(79722),r=s(35644),n=s(29296),a=s(13658);const l=o.A.create(),i=a.A.PRONOSTICO,c={UserPoolId:"sa-east-1_lTMNrWW7R",ClientId:"3ksssqtg3r49rf6js1t1177hrd"};let d=null,u=!1;const h=e=>Boolean(e&&i&&String(e).startsWith(String(i))),m=e=>{try{return sessionStorage.getItem(e)}catch(t){return console.warn("No se pudo leer sessionStorage:",t),null}},x=(e,t)=>{try{void 0!==t&&null!==t&&sessionStorage.setItem(e,t)}catch(s){console.warn("No se pudo escribir en sessionStorage:",s)}},g=()=>{if(!u){u=!0;try{sessionStorage.clear()}catch(e){}null!==n.m&&void 0!==n.m&&n.m.limpiarSesion&&n.m.limpiarSesion(),"undefined"!==typeof window&&(window.location.href="/#/signin")}},p=()=>{const e=m("refreshToken"),t=(()=>{const e=m("email")||m("username");if(!e||!c.UserPoolId||!c.ClientId)return null;const t=new r.NE(c);return new r.TU({Username:e,Pool:t})})();if(!e||!t)return Promise.reject(new Error("No hay datos para renovar la sesi\xf3n."));const s=new r.c9({RefreshToken:e});return new Promise((e,o)=>{t.refreshSession(s,(t,s)=>{if(t)return void o(t);const r=s.getAccessToken().getJwtToken(),n=s.getIdToken().getJwtToken(),a=s.getRefreshToken().getToken();x("accessToken",r),x("idToken",n),a&&x("refreshToken",a),e(r)})})};l.interceptors.request.use(e=>{const t=sessionStorage.getItem("accessToken");if(h(e.url)){var s;e.headers=null!==(s=e.headers)&&void 0!==s?s:{},t&&(e.headers.Authorization="Bearer ".concat(t));const o=sessionStorage.getItem("sub");o&&(e.headers["X-Usuario-Sub"]=o)}return e}),l.interceptors.response.use(e=>e,async e=>{const{config:t,response:s}=e;if(!t||!s||401!==s.status||!h(t.url))return Promise.reject(e);if(t.__isRetryRequest)return g(),Promise.reject(e);try{var o;const e=await(d||(d=p().then(e=>(d=null,e)).catch(e=>{throw d=null,e})),d);if(!e)throw new Error("No se obtuvo un token renovado.");return t.__isRetryRequest=!0,t.headers=null!==(o=t.headers)&&void 0!==o?o:{},t.headers.Authorization="Bearer ".concat(e),l(t)}catch(r){return g(),Promise.reject(r)}});const v=l},47436:(e,t,s)=>{s.d(t,{F:()=>a});var o=s(79722);const r=s(13658).A.REGISTRO;function n(){const e={},t=sessionStorage.getItem("sub"),s=sessionStorage.getItem("accessToken");return t&&(e["X-Usuario-Sub"]=t),s&&(e.Authorization="Bearer ".concat(s)),e}async function a(e){let{fechaDesde:t,fechaHasta:s,tipos:a}=e;const l=new URLSearchParams;l.set("page",0),l.set("size",500),t&&l.set("fechaDesde",t),s&&l.set("fechaHasta",s),Array.isArray(a)&&a.length>0?l.set("tipos",a.join(",")):"string"===typeof a&&a&&l.set("tipos",a);const i="".concat(r,"/movimientos?").concat(l.toString()),{data:c}=await o.A.get(i,{headers:n()});return c}},81070:(e,t,s)=>{s.r(t),s.d(t,{default:()=>fe});var o=s(89379),r=s(65043),n=s(53969),a=s(55895),l=s(76943),i=s(26687),c=s(70298),d=s(26529),u=s(56647),h=s(46471),m=s(45847),x=s(85030),g=s(24343),p=s(53089),v=s(94799),A=s(17873),j=s(76072),b=s(94527),f=s(87443),y=s(10756),E=s(86172),w=s(81341),R=s(34375),C=s(12097),M=s(2990),S=s(95315),k=s(82394),I=s(66185),N=s(60267),D=s(29001),T=s(34955),F=s(38915),P=s(20475),W=s(94167),_=s(37426),z=s(69516),O=s(92275),B=s(47436),K=s(70095),U=s(80379),q=s(50108),V=s(73243),G=s(28791),L=s(35963),J=s(66163),$=s(52185),H=s(6026),X=s(75748),Z=s(82291),Q=s(56002),Y=s(2489),ee=s(47563),te=s(9034),se=s(27421),oe=s(73456),re=s(13658),ne=s(70579);const ae=e=>"number"===typeof e?e:null==e||isNaN(Number(e))?0:Number(e),le="#a5d6a7",ie="#4caf50",ce="#ef9a9a",de="#f44336",ue="#4caf50",he="#f44336",me={fontWeight:500,bgcolor:"#FFDE70",backgroundColor:"#FFDE70",color:"#000",border:"1px solid #F5C16C","& .MuiChip-label":{color:"#000"},"& .MuiChip-icon":{color:"#000"},"&.MuiChip-filled":{backgroundColor:"#FFDE70"}},xe=e=>({borderCollapse:"collapse",border:"1px solid ".concat((e.vars||e).palette.divider)}),ge=e=>({border:"1px solid ".concat((e.vars||e).palette.divider),padding:"12px"}),pe=e=>(0,o.A)((0,o.A)({},ge(e)),{},{fontWeight:700}),ve=e=>["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"][parseInt(e,10)-1]||e;const Ae=(e,t)=>{const s=ae(t)-ae(e),o=(0,P.vv)(Math.abs(s));return s>=0?"+".concat(o):"-".concat(o)},je=e=>{if(!e||"string"!==typeof e)return null;const[t,s,o]=e.split("-"),r=Number(t),n=Number(s),a=Number(o);if(!Number.isFinite(r)||!Number.isFinite(n)||!Number.isFinite(a))return null;const l=new Date(r,n-1,a);return(e=>e instanceof Date&&!Number.isNaN(e.getTime()))(l)?l:null};async function be(e,t){const s={};for(const r of e){const e=(0,z.GP)((0,O.w)(r),"yyyy-MM-dd"),n=(0,z.GP)((0,_.p)(r),"yyyy-MM-dd"),a=(0,z.GP)(r,"yyyy-MM");try{const o=await(0,B.F)({fechaDesde:e,fechaHasta:n,tipos:t}),r=(Array.isArray(null===o||void 0===o?void 0:o.content)?o.content:Array.isArray(o)?o:[]).reduce((e,t)=>{var s,o;const r=Math.abs(Number(null!==(s=null!==(o=null===t||void 0===t?void 0:t.monto)&&void 0!==o?o:null===t||void 0===t?void 0:t.montoTotal)&&void 0!==s?s:0));return Number.isFinite(r)?e+r:e},0);s[a]=r}catch(o){console.error("Error al obtener movimientos del mes ".concat(a," (").concat(t,"):"),o),s[a]=0}}return s}function fe(){var e,t,z,B,fe,ye;const{nombre:Ee}=(0,D.g)(),we=(0,D.Zp)(),Re=(0,N.A)(),Ce="light"===Re.palette.mode,Me=null!==(e=null===(t=Re.vars)||void 0===t?void 0:t.palette)&&void 0!==e?e:Re.palette,Se=r.useMemo(()=>({ingresos:Ce?"hsl(120, 44%, 53%)":Me.success.light,egresos:Ce?"hsl(0, 90%, 40%)":Me.error.light,resultadoPos:Ce?"hsl(210, 98%, 42%)":Me.info.light,resultadoNeg:Ce?"hsl(45, 90%, 40%)":Me.warning.light}),[Ce,Me.error.light,Me.info.light,Me.success.light,Me.warning.light]),ke=Ce?null!==(z=null===(B=Me.text)||void 0===B?void 0:B.primary)&&void 0!==z?z:"#000":null!==(fe=null===(ye=Me.common)||void 0===ye?void 0:ye.white)&&void 0!==fe?fe:"#fff",[Ie,Ne]=r.useState({id:null,nombre:"",detalleMensual:[]}),[De,Te]=r.useState(!0),[Fe,Pe]=r.useState(null),[We,_e]=r.useState(0),[ze,Oe]=r.useState(!1),[Be,Ke]=r.useState(!1),[Ue,qe]=r.useState(0),[Ve,Ge]=r.useState(null),[Le,Je]=r.useState(!1),[$e,He]=r.useState("Ingresos");r.useEffect(()=>{Ee&&(async()=>{try{Te(!0),Pe(null);const r=await F.A.get("".concat(re.A.PRONOSTICO,"/api/presupuestos")),n=null===r||void 0===r?void 0:r.data;let a=[];Array.isArray(n)?a=n:Array.isArray(null===n||void 0===n?void 0:n.content)&&(a=n.content);const l=decodeURIComponent(Ee||"").trim().toLowerCase().replace(/\s+/g,"-"),i=a.find(e=>((null===e||void 0===e?void 0:e.nombre)||"").trim().toLowerCase().replace(/\s+/g,"-")===l);if(null===i||void 0===i||!i.id)return Ne({id:null,nombre:"No encontrado",detalleMensual:[]}),void Te(!1);let c=i.nombre;try{var e;const t=await F.A.get("".concat(re.A.PRONOSTICO,"/api/presupuestos/").concat(i.id));null!==t&&void 0!==t&&null!==(e=t.data)&&void 0!==e&&e.nombre&&(c=t.data.nombre)}catch(t){}const d=await F.A.get("".concat(re.A.PRONOSTICO,"/api/presupuestos/").concat(i.id,"/totales")),u=(Array.isArray(d.data)?d.data:[]).map((e,t)=>{const s=ae(e.ingresoEstimado),o=ae(e.egresoEstimado);return{id:t+1,mes:e.mes,ingresoEst:s,ingresoReal:0,egresoEst:o,egresoReal:0,totalEst:s-o,totalReal:0}});let h={},m={};try{const e=u.map(e=>{const t=((null===e||void 0===e?void 0:e.mes)||"").slice(0,7);return t?je("".concat(t,"-01")):null}).filter(Boolean);if(e.length>0){const t=Math.min(...e.map(e=>e.getTime())),s=Math.max(...e.map(e=>e.getTime())),o=(0,O.w)(new Date(t)),r=(0,_.p)(new Date(s)),n=(0,W.i)({start:o,end:r}),[a,l]=await Promise.all([be(n,"Egreso"),be(n,"Ingreso")]);m=a,h=l}}catch(s){console.error("Error al obtener datos reales del presupuesto:",s),Pe(e=>null!==e&&void 0!==e?e:"No se pudieron cargar los datos reales del presupuesto.")}const x=u.map(e=>{const t=((null===e||void 0===e?void 0:e.mes)||"").slice(0,7),s=ae(m[t]||0),r=ae(h[t]||0);return(0,o.A)((0,o.A)({},e),{},{ingresoReal:r,egresoReal:s,totalReal:r-s})});Ne({id:i.id,nombre:c,detalleMensual:x})}catch(Fe){console.error("Error al cargar presupuesto:",Fe),Pe("Error al cargar el presupuesto"),Ne({id:null,nombre:"Error",detalleMensual:[]})}finally{Te(!1)}})()},[Ee]);const Xe=Array.isArray(Ie.detalleMensual)?Ie.detalleMensual.filter(e=>!(null===e||void 0===e||!e.mes)):[],Ze=r.useMemo(()=>{let e=[...Xe];if(e=e.map(e=>{var t,s;const r=ae(null!==(t=e.totalEst)&&void 0!==t?t:ae(e.ingresoEst)-ae(e.egresoEst)),n=ae(null!==(s=e.totalReal)&&void 0!==s?s:ae(e.ingresoReal)-ae(e.egresoReal)),a=(n-r)/(Math.abs(r)>0?Math.abs(r):1),l=n<0;return(0,o.A)((0,o.A)({},e),{},{_estTotal:r,_realTotal:n,_pctDesvio:a,_deficit:l})}),ze&&(e=e.filter(e=>e._realTotal<0)),Number.isFinite(Ue)&&Ue>0){const t=Ue/100;e=e.filter(e=>Math.abs(e._pctDesvio)>=t||!Number.isFinite(e._pctDesvio))}return e},[Xe,ze,Ue]),Qe=Xe.reduce((e,t)=>e+ae(t.ingresoEst),0),Ye=Xe.reduce((e,t)=>e+ae(t.ingresoReal),0),et=Xe.reduce((e,t)=>e+ae(t.egresoEst),0),tt=Xe.reduce((e,t)=>e+ae(t.egresoReal),0),st=Ye-tt,ot=Qe-et,rt=(()=>{const e=Math.abs(ot)>0?Math.abs(ot):1;return Math.max(0,Math.min(1.2,st/e))})(),nt=(at=rt)>=.95?{label:"Salud: Verde",color:"success"}:at>=.8?{label:"Salud: Amarillo",color:"warning"}:{label:"Salud: Rojo",color:"error"};var at;const lt=Ze.map(e=>{const t=((null===e||void 0===e?void 0:e.mes)||"0000-01").split("-")[1];return{mes:ve(t),estimado:ae(e.ingresoEst),real:ae(e.ingresoReal)}}),it=Ze.map(e=>{const t=((null===e||void 0===e?void 0:e.mes)||"0000-01").split("-")[1];return{mes:ve(t),estimado:ae(e.egresoEst),real:ae(e.egresoReal)}}),ct=Ze.map(e=>{var t;const s=ae(null!==(t=e.totalReal)&&void 0!==t?t:ae(e.ingresoReal)-ae(e.egresoReal)),o=((null===e||void 0===e?void 0:e.mes)||"0000-01").split("-")[1];return{mes:ve(o),superavit:s,fill:s>=0?ue:he}}),dt=e=>{if(null===e||void 0===e||!e.mes)return void alert("Mes no v\xe1lido");const t=encodeURIComponent((Ie.nombre||"").trim().toLowerCase().replace(/\s+/g,"-")),s=(e.mes||"0000-01").split("-"),o=parseInt(s[1]||"1",10),r=new Intl.DateTimeFormat("es-ES",{month:"long"}).format(new Date(2025,(o||1)-1));we("/presupuestos/".concat(t,"/detalle/").concat(r))},ut=r.useMemo(()=>Xe.map(e=>{var t,s;const r=ae(null!==(t=e.totalEst)&&void 0!==t?t:ae(e.ingresoEst)-ae(e.egresoEst)),n=ae(null!==(s=e.totalReal)&&void 0!==s?s:ae(e.ingresoReal)-ae(e.egresoReal))-r;return(0,o.A)((0,o.A)({},e),{},{_delta:n,_absDelta:Math.abs(n)})}).sort((e,t)=>t._absDelta-e._absDelta),[Xe]),ht=Boolean(Ve);return(0,ne.jsxs)(n.A,{id:"presupuesto-detalle-content",sx:{width:"100%",p:3},children:[(0,ne.jsxs)(a.A,{variant:"h4",gutterBottom:!0,fontWeight:"600",children:["Detalle de ",Ie.nombre]}),(0,ne.jsx)(a.A,{variant:"subtitle1",gutterBottom:!0,sx:{color:"text.primary"},children:"Compar\xe1 tu planificaci\xf3n con lo real"}),(0,ne.jsxs)(n.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,mt:1,gap:1,flexWrap:"wrap"},children:[(0,ne.jsxs)(l.A,{value:We,onChange:(e,t)=>_e(t),indicatorColor:"primary",children:[(0,ne.jsx)(i.A,{label:"Resumen",sx:{color:ke,"&.Mui-selected":{color:ke},"& .MuiTab-wrapper":{color:ke}}}),(0,ne.jsx)(i.A,{label:"Datos brutos",sx:{color:ke,"&.Mui-selected":{color:ke},"& .MuiTab-wrapper":{color:ke}}})]}),(0,ne.jsxs)(c.A,{direction:"row",spacing:1,alignItems:"center",children:[(0,ne.jsx)(d.A,{title:"Filtros",children:(0,ne.jsx)(u.A,{onClick:e=>Ge(e.currentTarget),children:(0,ne.jsx)(Q.A,{})})}),(0,ne.jsx)(T.A,{onExportPdf:()=>{Promise.all([s.e(1389),s.e(74)]).then(s.t.bind(s,90074,23)).then(e=>{const t=document.getElementById("presupuesto-detalle-content"),s={margin:.5,filename:"Presupuesto_".concat(Ie.nombre||"","_").concat(Ie.id||"",".pdf"),image:{type:"jpeg",quality:.95},html2canvas:{scale:2},jsPDF:{unit:"in",format:"letter",orientation:"landscape"}};e.default().from(t).set(s).save()})},onExportExcel:()=>{const e=[["Mes","Ingreso Estimado","Ingreso Real","Desv\xedo Ingresos","Egreso Estimado","Egreso Real","Desv\xedo Egresos","Total Estimado","Total Real","Total Desv\xedo"],...Xe.map(e=>{var t;return[null!==(t=e.mes)&&void 0!==t?t:"\u2014",ae(e.ingresoEst),ae(e.ingresoReal),ae(e.ingresoReal)-ae(e.ingresoEst),ae(e.egresoEst),ae(e.egresoReal),ae(e.egresoReal)-ae(e.egresoEst),ae(e.totalEst),ae(e.totalReal),ae(e.totalReal)-ae(e.totalEst)]})];e.push(["","","","","","","","","",""]),e.push(["Totales:","","","","","","","","",""]),e.push(["",Qe,Ye,Ye-Qe,et,tt,tt-et,ot,st,st-ot]),Promise.all([s.e(1652),s.e(2514)]).then(s.t.bind(s,81652,23)).then(t=>{let{utils:s,writeFile:o}=t;const r=s.aoa_to_sheet(e,{cellStyles:!0}),n=s.book_new();s.book_append_sheet(n,r,"Detalle Presupuesto"),o(n,"Presupuesto_".concat(Ie.nombre||"","_").concat(Ie.id||"",".xlsx"),{cellStyles:!0})})}})]})]}),(0,ne.jsx)(h.A,{anchorEl:Ve,open:ht,onClose:()=>Ge(null),children:(0,ne.jsx)(n.A,{sx:{p:2,width:280},children:(0,ne.jsxs)(c.A,{spacing:1.5,children:[(0,ne.jsx)(m.A,{control:(0,ne.jsx)(x.A,{checked:ze,onChange:(e,t)=>Oe(t)}),label:"Ver solo meses con d\xe9ficit"}),(0,ne.jsx)(m.A,{control:(0,ne.jsx)(x.A,{checked:Be,onChange:(e,t)=>Ke(t)}),label:"Mostrar foco en estimados (oculta \u2018Real\u2019 en gr\xe1ficas)"}),(0,ne.jsx)(g.A,{label:"Umbral de desv\xedo (%)",type:"number",size:"small",value:Ue,onChange:e=>qe(Math.max(0,Number(e.target.value)))})]})})}),0===We&&(0,ne.jsxs)(ne.Fragment,{children:[(0,ne.jsxs)(p.A,{container:!0,spacing:2,mb:2,children:[(0,ne.jsx)(p.A,{item:!0,xs:12,sm:6,md:3,children:(0,ne.jsxs)(v.A,{sx:{p:3,textAlign:"center",bgcolor:Se.ingresos,color:"white",position:"relative"},children:[(0,ne.jsx)(A.A,{sx:{width:56,height:56,bgcolor:"white",color:"success.main",mx:"auto",mb:1},children:"+"}),(0,ne.jsx)(a.A,{variant:"h6",children:"Ingresos"}),(0,ne.jsx)(a.A,{variant:"h4",fontWeight:"bold",children:(0,P.vv)(Ye)}),(0,ne.jsx)(a.A,{variant:"body2",children:Ae(Qe,Ye)}),(0,ne.jsx)(d.A,{title:"Ver meses con mayor desv\xedo en ingresos",children:(0,ne.jsx)(u.A,{size:"small",onClick:()=>Je(!0)||He("Ingresos"),sx:{position:"absolute",top:8,right:8,bgcolor:"rgba(255,255,255,0.9)"},children:(0,ne.jsx)(Y.A,{fontSize:"small"})})})]})}),(0,ne.jsx)(p.A,{item:!0,xs:12,sm:6,md:3,children:(0,ne.jsxs)(v.A,{sx:{p:3,textAlign:"center",bgcolor:Se.egresos,color:"white",position:"relative"},children:[(0,ne.jsx)(A.A,{sx:{width:56,height:56,bgcolor:"white",color:"error.main",mx:"auto",mb:1},children:"-"}),(0,ne.jsx)(a.A,{variant:"h6",children:"Egresos"}),(0,ne.jsx)(a.A,{variant:"h4",fontWeight:"bold",children:(0,P.vv)(tt)}),(0,ne.jsx)(a.A,{variant:"body2",children:Ae(et,tt)}),(0,ne.jsx)(d.A,{title:"Ver meses con mayor desv\xedo en egresos",children:(0,ne.jsx)(u.A,{size:"small",onClick:()=>Je(!0)||He("egresos"),sx:{position:"absolute",top:8,right:8,bgcolor:"rgba(255,255,255,0.9)"},children:(0,ne.jsx)(te.A,{fontSize:"small"})})})]})}),(0,ne.jsx)(p.A,{item:!0,xs:12,sm:6,md:3,children:(0,ne.jsxs)(v.A,{sx:{p:3,textAlign:"center",bgcolor:st>=0?Se.resultadoPos:Se.resultadoNeg,color:"white",position:"relative"},children:[(0,ne.jsx)(A.A,{sx:{width:56,height:56,bgcolor:"white",color:st>=0?"info.main":"warning.main",mx:"auto",mb:1},children:st>=0?"\u2713":"\u26a0"}),(0,ne.jsx)(a.A,{variant:"h6",children:"Resultado"}),(0,ne.jsx)(a.A,{variant:"h4",fontWeight:"bold",children:(0,P.vv)(st)}),(0,ne.jsx)(a.A,{variant:"body2",children:st>=0?"Super\xe1vit":"D\xe9ficit"}),(0,ne.jsx)(d.A,{title:"Ver meses ordenados por impacto en resultado",children:(0,ne.jsx)(u.A,{size:"small",onClick:()=>Je(!0)||He("resultado"),sx:{position:"absolute",top:8,right:8,bgcolor:"rgba(255,255,255,0.9)"},children:(0,ne.jsx)(ee.A,{fontSize:"small"})})})]})}),(0,ne.jsx)(p.A,{item:!0,xs:12,sm:6,md:3,children:(0,ne.jsxs)(v.A,{sx:{p:3,textAlign:"center"},children:[(0,ne.jsx)(a.A,{variant:"overline",children:"Marcador de salud"}),(0,ne.jsxs)(c.A,{alignItems:"center",spacing:1,children:[(0,ne.jsx)(j.A,{label:"".concat(nt.label),color:nt.color}),(0,ne.jsxs)(a.A,{variant:"body2",color:"text.secondary",children:["Cumplimiento: ",(100*rt).toFixed(0),"%"]})]})]})})]}),(0,ne.jsx)(b.A,{sx:{mb:2}}),(0,ne.jsxs)(v.A,{sx:{p:3,mb:3},children:[(0,ne.jsxs)(c.A,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[(0,ne.jsx)(a.A,{variant:"h6",fontWeight:"600",children:"Ingresos: Estimado vs Real"}),(0,ne.jsx)(j.A,{size:"small",label:Be?"Foco: Estimados":"Todos"})]}),(0,ne.jsx)(n.A,{sx:{mt:2},children:lt.map((e,t)=>{const s=1.2*Math.max(e.estimado,e.real)||1,o=Ze[t];return(0,ne.jsxs)(n.A,{sx:{mb:3},children:[(0,ne.jsx)(a.A,{variant:"subtitle1",fontWeight:"600",gutterBottom:!0,children:e.mes}),(0,ne.jsxs)(n.A,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,ne.jsxs)(n.A,{sx:{display:"flex",alignItems:"center",gap:2,cursor:"pointer"},onClick:()=>o&&dt(o),children:[(0,ne.jsx)(a.A,{variant:"body2",sx:{minWidth:80},children:"Estimado:"}),(0,ne.jsx)(n.A,{sx:{flex:1,height:30},children:(0,ne.jsx)(q.u,{width:"100%",height:30,children:(0,ne.jsxs)(Z.E,{data:[{name:e.mes,valor:e.estimado}],layout:"vertical",children:[(0,ne.jsx)($.W,{type:"number",domain:[0,s],hide:!0}),(0,ne.jsx)(H.h,{type:"category",dataKey:"name",hide:!0}),(0,ne.jsx)(U.m,{formatter:e=>[(0,P.vv)(e),""]}),(0,ne.jsx)(J.y,{dataKey:"valor",fill:le,radius:[4,4,4,4],label:{position:"right",formatter:e=>(0,P.vv)(e)}})]})})})]}),!Be&&(0,ne.jsxs)(n.A,{sx:{display:"flex",alignItems:"center",gap:2,cursor:"pointer"},onClick:()=>o&&dt(o),children:[(0,ne.jsx)(a.A,{variant:"body2",sx:{minWidth:80},children:"Real:"}),(0,ne.jsx)(n.A,{sx:{flex:1,height:30},children:(0,ne.jsx)(q.u,{width:"100%",height:30,children:(0,ne.jsxs)(Z.E,{data:[{name:e.mes,valor:e.real}],layout:"vertical",children:[(0,ne.jsx)($.W,{type:"number",domain:[0,s],hide:!0}),(0,ne.jsx)(H.h,{type:"category",dataKey:"name",hide:!0}),(0,ne.jsx)(U.m,{formatter:e=>[(0,P.vv)(e),""]}),(0,ne.jsx)(J.y,{dataKey:"valor",fill:ie,radius:[4,4,4,4],label:{position:"right",formatter:e=>(0,P.vv)(e)}})]})})})]})]})]},"".concat(e.mes,"-").concat(t))})})]}),(0,ne.jsxs)(v.A,{sx:{p:3,mb:3},children:[(0,ne.jsx)(a.A,{variant:"h6",gutterBottom:!0,fontWeight:"600",children:"Egresos: Estimado vs Real"}),(0,ne.jsx)(n.A,{sx:{mt:2},children:it.map((e,t)=>{const s=1.2*Math.max(e.estimado,e.real)||1,o=Ze[t];return(0,ne.jsxs)(n.A,{sx:{mb:3},children:[(0,ne.jsx)(a.A,{variant:"subtitle1",fontWeight:"600",gutterBottom:!0,children:e.mes}),(0,ne.jsxs)(n.A,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,ne.jsxs)(n.A,{sx:{display:"flex",alignItems:"center",gap:2,cursor:"pointer"},onClick:()=>o&&dt(o),children:[(0,ne.jsx)(a.A,{variant:"body2",sx:{minWidth:80},children:"Estimado:"}),(0,ne.jsx)(n.A,{sx:{flex:1,height:30},children:(0,ne.jsx)(q.u,{width:"100%",height:30,children:(0,ne.jsxs)(Z.E,{data:[{name:e.mes,valor:e.estimado}],layout:"vertical",children:[(0,ne.jsx)($.W,{type:"number",domain:[0,s],hide:!0}),(0,ne.jsx)(H.h,{type:"category",dataKey:"name",hide:!0}),(0,ne.jsx)(U.m,{formatter:e=>[(0,P.vv)(e),""]}),(0,ne.jsx)(J.y,{dataKey:"valor",fill:ce,radius:[4,4,4,4],label:{position:"right",formatter:e=>(0,P.vv)(e)}})]})})})]}),!Be&&(0,ne.jsxs)(n.A,{sx:{display:"flex",alignItems:"center",gap:2,cursor:"pointer"},onClick:()=>o&&dt(o),children:[(0,ne.jsx)(a.A,{variant:"body2",sx:{minWidth:80},children:"Real:"}),(0,ne.jsx)(n.A,{sx:{flex:1,height:30},children:(0,ne.jsx)(q.u,{width:"100%",height:30,children:(0,ne.jsxs)(Z.E,{data:[{name:e.mes,valor:e.real}],layout:"vertical",children:[(0,ne.jsx)($.W,{type:"number",domain:[0,s],hide:!0}),(0,ne.jsx)(H.h,{type:"category",dataKey:"name",hide:!0}),(0,ne.jsx)(U.m,{formatter:e=>[(0,P.vv)(e),""]}),(0,ne.jsx)(J.y,{dataKey:"valor",fill:de,radius:[4,4,4,4],label:{position:"right",formatter:e=>(0,P.vv)(e)}})]})})})]})]})]},"".concat(e.mes,"-").concat(t))})})]}),(0,ne.jsxs)(v.A,{sx:{p:3},children:[(0,ne.jsx)(a.A,{variant:"h6",gutterBottom:!0,fontWeight:"600",children:"Tendencia del Resultado Mensual"}),(0,ne.jsx)(q.u,{width:"100%",height:300,children:(0,ne.jsxs)(X.b,{data:ct,margin:{top:10,right:30,left:0,bottom:0},children:[(0,ne.jsx)("defs",{children:(0,ne.jsxs)("linearGradient",{id:"splitColor",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,ne.jsx)("stop",{offset:"50%",stopColor:"#4caf50",stopOpacity:.1}),(0,ne.jsx)("stop",{offset:"50%",stopColor:"#f44336",stopOpacity:.1})]})}),(0,ne.jsx)(L.Gk,{dataKey:"superavit",fill:"url(#splitColor)",stroke:"none",yAxisId:"left"}),(0,ne.jsx)(G.N,{type:"monotone",dataKey:"superavit",stroke:"#2196f3",strokeWidth:2,dot:{r:6,cursor:"pointer"},activeDot:{r:8},yAxisId:"left",onClick:(e,t)=>{const s=Ze[t];s&&dt(s)}}),(0,ne.jsx)(V.e,{y:0,stroke:"#666",strokeDasharray:"3 3",label:{value:"Punto de equilibrio",position:"right",fill:"#666",fontSize:12}}),(0,ne.jsx)($.W,{dataKey:"mes"}),(0,ne.jsx)(H.h,{yAxisId:"left",domain:[e=>Math.min(e,0),e=>Math.max(e,0)],tickFormatter:e=>(0,P.vv)(e),width:70}),(0,ne.jsx)(U.m,{formatter:e=>[Number(e)>=0?"Super\xe1vit: ".concat((0,P.vv)(e)):"D\xe9ficit: ".concat((0,P.vv)(e)),"Resultado"],contentStyle:{color:"black"}}),(0,ne.jsx)(K.s,{payload:[{value:"Resultado mensual",type:"line",color:"#2196f3"},{value:"Punto de equilibrio",type:"dashedLine",color:"#666"}]})]})})]})]}),1===We&&(0,ne.jsx)(v.A,{sx:{overflowX:"auto"},children:(0,ne.jsxs)(f.A,{sx:xe,children:[(0,ne.jsx)(y.A,{children:(0,ne.jsxs)(E.A,{children:[(0,ne.jsx)(w.A,{sx:pe,children:"Mes"}),(0,ne.jsx)(w.A,{sx:pe,children:"Ingreso Est."}),(0,ne.jsx)(w.A,{sx:pe,children:"Ingreso Real"}),(0,ne.jsx)(w.A,{sx:pe,children:"Egreso Est."}),(0,ne.jsx)(w.A,{sx:pe,children:"Egreso Real"}),(0,ne.jsx)(w.A,{sx:pe,children:"Resultado"}),(0,ne.jsx)(w.A,{sx:pe,children:"Acciones"})]})}),(0,ne.jsx)(R.A,{children:Ze.length>0?Ze.map((e,t)=>{var s,r;const n=ae(e.ingresoEst),a=ae(e.ingresoReal),l=ae(e.egresoEst),i=ae(e.egresoReal),d=ae(null!==(s=e.totalReal)&&void 0!==s?s:a-i),u=ae(null!==(r=e.totalEst)&&void 0!==r?r:n-l),h=d-u,m=Math.abs(u)>0?h/Math.abs(u)*100:0;return(0,ne.jsxs)(E.A,{children:[(0,ne.jsxs)(w.A,{sx:ge,children:[e.mes,d<0&&(0,ne.jsx)(j.A,{size:"small",icon:(0,ne.jsx)(oe.A,{fontSize:"small"}),sx:(0,o.A)({ml:1},me),label:"Mes con d\xe9ficit"})]}),(0,ne.jsx)(w.A,{sx:ge,children:(0,P.vv)(n)}),(0,ne.jsx)(w.A,{sx:ge,children:(0,P.vv)(a)}),(0,ne.jsx)(w.A,{sx:ge,children:(0,P.vv)(l)}),(0,ne.jsx)(w.A,{sx:ge,children:(0,P.vv)(i)}),(0,ne.jsxs)(w.A,{sx:e=>(0,o.A)((0,o.A)({},ge(e)),{},{fontWeight:700,color:m>=0?"#66bb6a":"#ef5350"}),children:[(0,P.vv)(d)," ",(0,ne.jsxs)("span",{style:{color:m>=0?"#66bb6a":"#ef5350"},children:["(",m.toFixed(0),"%)"]})]}),(0,ne.jsx)(w.A,{sx:ge,children:(0,ne.jsx)(c.A,{direction:"row",spacing:1,children:(0,ne.jsx)(C.A,{size:"small",variant:"contained",onClick:()=>dt(e),children:"Ver mes"})})})]},e.mes||t)}):(0,ne.jsx)(E.A,{children:(0,ne.jsx)(w.A,{colSpan:7,sx:e=>(0,o.A)((0,o.A)({},ge(e)),{},{textAlign:"center",padding:"20px",color:(e.vars||e).palette.text.secondary}),children:"No hay datos mensuales con los filtros actuales."})})})]})}),(0,ne.jsx)(n.A,{mt:4,display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:1,children:(0,ne.jsx)(C.A,{variant:"outlined",onClick:()=>we(-1),children:"Volver"})}),(0,ne.jsx)(M.Ay,{anchor:"right",open:Le,onClose:()=>Je(!1),children:(0,ne.jsxs)(n.A,{sx:{width:360,p:2},children:[(0,ne.jsxs)(c.A,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{mb:1},children:[(0,ne.jsx)(a.A,{variant:"h6",children:"Meses con mayor desv\xedo"}),(0,ne.jsx)(u.A,{onClick:()=>Je(!1),children:(0,ne.jsx)(se.A,{})})]}),(0,ne.jsxs)(a.A,{variant:"body2",color:"text.secondary",sx:{mb:2},children:["Ingresos"===$e&&"Ordenado por diferencia Ingreso Real vs Estimado.","Egresos"===$e&&"Ordenado por diferencia Egreso Real vs Estimado.","resultado"===$e&&"Ordenado por diferencia de Resultado Real vs Estimado."]}),(0,ne.jsx)(S.A,{dense:!0,children:ut.map((e,t)=>{var s,o;const r=ae(e.ingresoReal)-ae(e.ingresoEst),n=ae(e.egresoReal)-ae(e.egresoEst),a=ae(null!==(s=e.totalEst)&&void 0!==s?s:ae(e.ingresoEst)-ae(e.egresoEst)),l=ae(null!==(o=e.totalReal)&&void 0!==o?o:ae(e.ingresoReal)-ae(e.egresoReal)),i="Ingresos"===$e?r:"egresos"===$e?n:l-a;return(0,ne.jsx)(k.Ay,{secondaryAction:(0,ne.jsx)(C.A,{size:"small",variant:"text",onClick:()=>{Je(!1),dt(e)},children:"Ajustar mes"}),children:(0,ne.jsx)(I.A,{primary:e.mes,secondary:(0,ne.jsxs)("span",{style:{color:i>=0?"#66bb6a":"#ef5350"},children:[i>=0?"+":"-",(0,P.vv)(Math.abs(i))]})})},e.mes||t)})})]})})]})}}}]);
//# sourceMappingURL=1070.89067c06.chunk.js.map