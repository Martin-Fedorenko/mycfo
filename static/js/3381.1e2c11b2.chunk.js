"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[3381],{12043:(e,s,t)=>{t.d(s,{A:()=>o});var n=t(14057),r=t(70579);const o=(0,n.A)((0,r.jsx)("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2"}),"MoreVert")},38915:(e,s,t)=>{t.d(s,{A:()=>g});var n=t(79722),r=t(35644),o=t(29296),a=t(13658);const l=n.A.create(),i=a.A.PRONOSTICO,c={UserPoolId:"sa-east-1_lTMNrWW7R",ClientId:"3ksssqtg3r49rf6js1t1177hrd"};let d=null,u=!1;const p=e=>Boolean(e&&i&&String(e).startsWith(String(i))),h=e=>{try{return sessionStorage.getItem(e)}catch(s){return console.warn("No se pudo leer sessionStorage:",s),null}},m=(e,s)=>{try{void 0!==s&&null!==s&&sessionStorage.setItem(e,s)}catch(t){console.warn("No se pudo escribir en sessionStorage:",t)}},A=()=>{if(!u){u=!0;try{sessionStorage.clear()}catch(e){}null!==o.m&&void 0!==o.m&&o.m.limpiarSesion&&o.m.limpiarSesion(),"undefined"!==typeof window&&(window.location.href="/#/signin")}},x=()=>{const e=h("refreshToken"),s=(()=>{const e=h("email")||h("username");if(!e||!c.UserPoolId||!c.ClientId)return null;const s=new r.NE(c);return new r.TU({Username:e,Pool:s})})();if(!e||!s)return Promise.reject(new Error("No hay datos para renovar la sesi\xf3n."));const t=new r.c9({RefreshToken:e});return new Promise((e,n)=>{s.refreshSession(t,(s,t)=>{if(s)return void n(s);const r=t.getAccessToken().getJwtToken(),o=t.getIdToken().getJwtToken(),a=t.getRefreshToken().getToken();m("accessToken",r),m("idToken",o),a&&m("refreshToken",a),e(r)})})};l.interceptors.request.use(e=>{const s=sessionStorage.getItem("accessToken");if(p(e.url)){var t;e.headers=null!==(t=e.headers)&&void 0!==t?t:{},s&&(e.headers.Authorization="Bearer ".concat(s));const n=sessionStorage.getItem("sub");n&&(e.headers["X-Usuario-Sub"]=n)}return e}),l.interceptors.response.use(e=>e,async e=>{const{config:s,response:t}=e;if(!s||!t||401!==t.status||!p(s.url))return Promise.reject(e);if(s.__isRetryRequest)return A(),Promise.reject(e);try{var n;const e=await(d||(d=x().then(e=>(d=null,e)).catch(e=>{throw d=null,e})),d);if(!e)throw new Error("No se obtuvo un token renovado.");return s.__isRetryRequest=!0,s.headers=null!==(n=s.headers)&&void 0!==n?n:{},s.headers.Authorization="Bearer ".concat(e),l(s)}catch(r){return A(),Promise.reject(r)}});const g=l},63381:(e,s,t)=>{t.r(s),t.d(s,{default:()=>re});var n=t(65043),r=t(89379),o=t(53969),a=t(12097),l=t(86172),i=t(81341),c=t(26529),d=t(56647),u=t(55895),p=t(76943),h=t(26687),m=t(10256),A=t(3353),x=t(9446),g=t(88889),v=t(24343),b=t(91449),j=t(94527),f=t(94799),y=t(87443),w=t(10756),C=t(34375),S=t(56465),P=t(46471),N=t(38517),E=t(81911),T=t(78776),_=t(85877),R=t(80172),k=t(32911),I=t(60267),z=t(89826),M=t(29001),O=t(38915),L=t(88746),D=t(14057),U=t(70579);const W=(0,D.A)((0,U.jsx)("path",{d:"M19 4h-3.5l-1-1h-5l-1 1H5v2h14zM6 7v12c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7zm8 7v4h-4v-4H8l4-4 4 4z"}),"RestoreFromTrash");var B=t(12043),q=t(13658),H=t(96470);const F={backgroundColor:"rgba(255, 255, 255, 0.02)","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.05)"}},V=e=>({border:"1px solid ".concat((e.vars||e).palette.divider)}),K=e=>(0,r.A)((0,r.A)({},V(e)),{},{fontWeight:600}),G=e=>({nombre:{width:"deleted"===e?"20%":"25%"},desde:{width:"deleted"===e?"20%":"25%"},hasta:{width:"deleted"===e?"20%":"25%"},eliminado:{width:"20%"},acciones:{width:"deleted"===e?"20%":"25%"}}),X=["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],Y=e=>String(e).padStart(2,"0"),Z=(e,s)=>new Date(e,s,0).getDate(),J=()=>{const e=Number({NODE_ENV:"production",PUBLIC_URL:"/mycfo",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AWS_REGION:"sa-east-1",REACT_APP_BASE_URL:"https://qtzuww-ip-190-136-241-201.tunnelmole.net",REACT_APP_COGNITO_CLIENT_ID:"3ksssqtg3r49rf6js1t1177hrd",REACT_APP_COGNITO_USER_POOL_ID:"sa-east-1_lTMNrWW7R",REACT_APP_URL_ADMINISTRACION:"https://qtzuww-ip-190-136-241-201.tunnelmole.net/administracion",REACT_APP_URL_IA:"https://qtzuww-ip-190-136-241-201.tunnelmole.net/ia",REACT_APP_URL_NOTIFICACION:"https://qtzuww-ip-190-136-241-201.tunnelmole.net/notificacion",REACT_APP_URL_PRONOSTICO:"https://qtzuww-ip-190-136-241-201.tunnelmole.net/pronostico",REACT_APP_URL_REGISTRO:"https://qtzuww-ip-190-136-241-201.tunnelmole.net/registro",REACT_APP_URL_REPORTE:"https://qtzuww-ip-190-136-241-201.tunnelmole.net/reporte",REACT_APP_WEBSOCKET_URL:"https://qtzuww-ip-190-136-241-201.tunnelmole.net/notificacion/ws"}.REACT_APP_PRESUPUESTO_RETENTION_DAYS);return Number.isNaN(e)||e<=0?90:e},Q=e=>{if(!e)return"-";const s=new Date(e);return Number.isNaN(s.valueOf())?e:s.toLocaleString("es-AR",{hour12:!1})},$=3,ee="createdAt,desc",se=()=>({content:[],totalElements:0,totalPages:0,number:0,size:$}),te=e=>{let{label:s,ghost:t}=e;return(0,U.jsxs)(o.A,{sx:{position:"relative",display:"inline-flex"},children:[(0,U.jsx)(o.A,{"aria-hidden":!0,sx:{visibility:"hidden",pointerEvents:"none",display:"inline-flex",whiteSpace:"nowrap"},children:t}),(0,U.jsx)(o.A,{sx:{position:"absolute",inset:0,display:"grid",placeItems:"center",whiteSpace:"nowrap"},children:s})]})};function ne(){var e,s,t,D,ne,re,oe,ae;const le=(0,I.A)(),ie="light"===le.palette.mode,ce=null!==(e=null===(s=le.vars)||void 0===s?void 0:s.palette)&&void 0!==e?e:le.palette,de=ie?null!==(t=null===(D=ce.text)||void 0===D?void 0:D.primary)&&void 0!==t?t:"#000":null!==(ne=null===(re=ce.common)||void 0===re?void 0:re.white)&&void 0!==ne?ne:"#fff",ue=ie?void 0:{color:"#42897f"},pe=(0,M.Zp)(),he=q.A.PRONOSTICO,me=n.useMemo(()=>J(),[]),[Ae,xe]=n.useState("active"),[ge,ve]=n.useState(0),[be,je]=n.useState(se),[fe,ye]=n.useState(!1),[we,Ce]=n.useState(null),[Se,Pe]=n.useState(0),[Ne,Ee]=n.useState(""),[Te,_e]=n.useState({year:"",fromMonth:"",toMonth:""}),[Re,ke]=n.useState(""),[Ie,ze]=n.useState(""),[Me,Oe]=n.useState(!1),[Le,De]=n.useState(!1),[Ue,We]=n.useState({open:!1,presupuesto:null}),[Be,qe]=n.useState({open:!1,message:"",action:null}),[He,Fe]=n.useState(null),[Ve,Ke]=n.useState({anchorEl:null,presupuesto:null}),[Ge,Xe]=n.useState(()=>{const e=(new Date).getFullYear();return[e-1,e,e+1]}),Ye=n.useRef(""),Ze=n.useRef(null),Je=n.useCallback(e=>{if(!e)return"";const[s,t]=e.split("-"),n=Number(t)-1;return n>=0&&n<X.length?"".concat(X[n]," ").concat(s):e},[]),Qe=n.useCallback(e=>{Array.isArray(e)&&0!==e.length&&Xe(s=>{const t=new Set(s);return e.forEach(e=>{var s,n;const r=Number(null===e||void 0===e||null===(s=e.desde)||void 0===s?void 0:s.split("-")[0]),o=Number(null===e||void 0===e||null===(n=e.hasta)||void 0===n?void 0:n.split("-")[0]);Number.isNaN(r)||t.add(r),Number.isNaN(o)||t.add(o)}),Array.from(t).sort((e,s)=>e-s)})},[]),$e=n.useCallback(e=>{if(!e||"object"!==typeof e)return se();const s=Array.isArray(e.content)?e.content:[],t=Number(e.totalElements),n=Number(e.totalPages),r=Number(e.number),o=Number(e.size);return{content:s,totalElements:Number.isFinite(t)?t:s.length,totalPages:Number.isFinite(n)?n:s.length>0?1:0,number:Number.isFinite(r)?r:0,size:Number.isFinite(o)&&o>0?o:$}},[]),es=n.useCallback(async(e,s)=>{De(!0);try{const t=Ne.trim().length>=2,n=t?0:Math.max(s,0),r=t?1e3:$,o=new URLSearchParams;o.set("status",e),o.set("page",String(n)),o.set("size",String(r)),o.set("sort",ee);const a=await O.A.get("".concat(he,"/api/presupuestos?").concat(o.toString())),l=$e(a.data);if(!t&&s>0&&l.totalPages>0&&s>=l.totalPages)return void ve(l.totalPages-1);je(l),Qe(l.content),ze(""),t&&0!==s&&ve(0)}catch(t){console.error("Error cargando presupuestos desde el backend:",t),je(se()),ze("No se pudo cargar la lista de presupuestos. Intenta nuevamente.")}finally{De(!1)}},[he,Qe,$e,Ne]),ss=n.useCallback(async(e,s,t)=>{Oe(!0);try{const n=new URLSearchParams(e||"");n.set("status",s),n.set("page",String(Math.max(t,0))),n.set("size",String($)),n.set("sort",ee);const r=await O.A.get("".concat(he,"/api/presupuestos?").concat(n.toString())),o=$e(r.data);if(t>0&&o.totalPages>0&&t>=o.totalPages)return void Pe(o.totalPages-1);Ce(o),Qe(o.content),ke("")}catch(n){console.error("Error cargando presupuestos desde el backend:",n),Ce(se()),ke("No se pudo cargar la lista filtrada. Intenta nuevamente.")}finally{Oe(!1)}},[he,Qe,$e]);n.useEffect(()=>{es(Ae,ge)},[es,Ae,ge]);n.useEffect(()=>{Ke({anchorEl:null,presupuesto:null})},[Ae]);const ts=()=>{Ke({anchorEl:null,presupuesto:null})},ns=n.useCallback(()=>{We({open:!1,presupuesto:null})},[]),rs=n.useCallback(async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Presupuesto restaurado.";if(e)try{await O.A.post("".concat(he,"/api/presupuestos/").concat(e.id,"/restore")),await es(Ae,ge),fe&&Ye.current&&await ss(Ye.current,Ae,Se),s&&qe({open:!0,message:s,action:null}),ze("")}catch(t){console.error("Error restaurando presupuesto:",t),qe({open:!0,message:"No se pudo restaurar el presupuesto.",action:null})}},[he,es,ss,fe,ge,Se,Ae]),os=n.useCallback(e=>{rs(e,"Presupuesto restaurado.")},[rs]),as=n.useCallback(async()=>{const e=Ze.current;e?(Ze.current=null,await rs(e,"Presupuesto restaurado.")):qe(e=>(0,r.A)((0,r.A)({},e),{},{open:!1}))},[rs]),ls=He===(null===(oe=Ue.presupuesto)||void 0===oe?void 0:oe.id),is=n.useMemo(()=>X.map((e,s)=>({value:String(s+1),label:e.charAt(0).toUpperCase()+e.slice(1)})),[]),cs="deleted"===Ae?5:4,ds=Number(be.totalPages)||0,us=ds>0?be.number+1:1,ps=we&&Number(we.totalPages)||0,hs=ps>0&&we?we.number+1:1,ms=n.useMemo(()=>{const e=Ne.trim().toLowerCase(),s=Array.isArray(be.content)?be.content:[];return e?s.filter(s=>{const t=((null===s||void 0===s?void 0:s.nombre)||"").toLowerCase(),n=((null===s||void 0===s?void 0:s.desde)||"").toLowerCase(),r=((null===s||void 0===s?void 0:s.hasta)||"").toLowerCase(),o=Je((null===s||void 0===s?void 0:s.desde)||"").toLowerCase(),a=Je((null===s||void 0===s?void 0:s.hasta)||"").toLowerCase();return t.includes(e)||n.includes(e)||r.includes(e)||o.includes(e)||a.includes(e)}):s},[be.content,Ne,Je]),As=e=>s=>{const t=s.target.value;_e(s=>(0,r.A)((0,r.A)({},s),{},{[e]:t}))},xs=e=>e.map(e=>{const s=encodeURIComponent((e.nombre||"").trim().toLowerCase().replace(/\s+/g,"-")),t="deleted"===Ae,n=Boolean(Ve.anchorEl)&&Ve.presupuesto&&Ve.presupuesto.id===e.id,u=n?"presupuesto-actions-menu":void 0,p="acciones-presupuesto-".concat(e.id);return(0,U.jsxs)(l.A,{sx:F,children:[(0,U.jsx)(i.A,{sx:e=>(0,r.A)((0,r.A)({},V(e)),G(Ae).nombre),children:e.nombre}),(0,U.jsx)(i.A,{sx:e=>(0,r.A)((0,r.A)({},V(e)),G(Ae).desde),children:Je(e.desde)}),(0,U.jsx)(i.A,{sx:e=>(0,r.A)((0,r.A)({},V(e)),G(Ae).hasta),children:Je(e.hasta)}),t&&(0,U.jsx)(i.A,{sx:e=>(0,r.A)((0,r.A)({},V(e)),G(Ae).eliminado),children:Q(e.deletedAt)}),(0,U.jsx)(i.A,{sx:e=>(0,r.A)((0,r.A)({},V(e)),G(Ae).acciones),align:"right",children:t?(0,U.jsx)(a.A,{variant:"outlined",size:"small",startIcon:(0,U.jsx)(W,{}),onClick:()=>os(e),children:"Restaurar"}):(0,U.jsxs)(o.A,{sx:{display:"flex",justifyContent:"flex-end",gap:1},children:[(0,U.jsx)(a.A,{variant:"outlined",size:"small",onClick:()=>pe("/presupuestos/".concat(s)),sx:ue,children:"Ver detalle"}),(0,U.jsx)(c.A,{title:"M\xe1s acciones",children:(0,U.jsx)(d.A,{size:"small","aria-label":"M\xe1s acciones","aria-controls":u,"aria-haspopup":"true","aria-expanded":n?"true":void 0,id:p,onClick:s=>((e,s)=>{Ke({anchorEl:e.currentTarget,presupuesto:s})})(s,e),children:(0,U.jsx)(B.A,{fontSize:"small"})})})]})})]},e.id)}),gs=n.useMemo(()=>Array.isArray(null===be||void 0===be?void 0:be.content)&&be.content.length?be.content[0]:null,[null===be||void 0===be?void 0:be.content]),vs=n.useMemo(()=>we&&Array.isArray(we.content)&&we.content.length?we.content[0]:null,[we]),bs={nombre:(null===gs||void 0===gs?void 0:gs.nombre)||"Nombre de ejemplo",desde:Je((null===gs||void 0===gs?void 0:gs.desde)||"2025-01"),hasta:Je((null===gs||void 0===gs?void 0:gs.hasta)||"2025-12"),eliminado:Q((null===gs||void 0===gs?void 0:gs.deletedAt)||"2025-10-14T20:21:43Z")},js={nombre:(null===vs||void 0===vs?void 0:vs.nombre)||"Nombre de ejemplo",desde:Je((null===vs||void 0===vs?void 0:vs.desde)||"2025-01"),hasta:Je((null===vs||void 0===vs?void 0:vs.hasta)||"2025-12"),eliminado:Q((null===vs||void 0===vs?void 0:vs.deletedAt)||"2025-10-14T20:21:43Z")};return(0,U.jsxs)(o.A,{sx:{width:"100%",p:3},children:[(0,U.jsx)(u.A,{variant:"h4",gutterBottom:!0,children:"Presupuestos"}),(0,U.jsx)(u.A,{variant:"subtitle1",gutterBottom:!0,children:"Visualiza tus presupuestos creados o genera uno nuevo"}),(0,U.jsxs)(p.A,{value:Ae,onChange:(e,s)=>{s!==Ae&&(xe(s),ve(0),ye(!1),Ce(null),Pe(0),ke(""),Ye.current="")},sx:{mt:1},children:[(0,U.jsx)(h.A,{value:"active",label:"Activos",sx:{color:de,"&.Mui-selected":{color:de},"& .MuiTab-wrapper":{color:de}}}),(0,U.jsx)(h.A,{value:"deleted",label:"Borrados",sx:{color:de,"&.Mui-selected":{color:de},"& .MuiTab-wrapper":{color:de}}})]}),(0,U.jsx)(u.A,{variant:"caption",sx:{display:"block",mb:2,color:"text.primary"},children:"Los presupuestos se purgan de forma definitiva a los ".concat(me," d\xedas.")}),(0,U.jsxs)(o.A,{sx:{display:"flex",flexWrap:"wrap",gap:2,alignItems:"center",mt:2,mb:2},children:[(0,U.jsxs)(m.A,{size:"small",sx:{minWidth:120},children:[(0,U.jsx)(A.A,{id:"presupuesto-year-label",children:"A\xf1o"}),(0,U.jsxs)(x.A,{labelId:"presupuesto-year-label",value:Te.year,label:"A\xf1o",onChange:As("year"),children:[(0,U.jsx)(g.A,{value:"",children:(0,U.jsx)("em",{children:"Todos"})}),Ge.map(e=>(0,U.jsx)(g.A,{value:String(e),children:e},e))]})]}),(0,U.jsxs)(m.A,{size:"small",sx:{minWidth:150},children:[(0,U.jsx)(A.A,{id:"presupuesto-from-label",children:"Desde (mes)"}),(0,U.jsxs)(x.A,{labelId:"presupuesto-from-label",value:Te.fromMonth,label:"Desde (mes)",onChange:As("fromMonth"),children:[(0,U.jsx)(g.A,{value:"",children:(0,U.jsx)("em",{children:"Sin filtro"})}),is.map(e=>(0,U.jsx)(g.A,{value:e.value,children:e.label},e.value))]})]}),(0,U.jsxs)(m.A,{size:"small",sx:{minWidth:150},children:[(0,U.jsx)(A.A,{id:"presupuesto-to-label",children:"Hasta (mes)"}),(0,U.jsxs)(x.A,{labelId:"presupuesto-to-label",value:Te.toMonth,label:"Hasta (mes)",onChange:As("toMonth"),children:[(0,U.jsx)(g.A,{value:"",children:(0,U.jsx)("em",{children:"Sin filtro"})}),is.map(e=>(0,U.jsx)(g.A,{value:e.value,children:e.label},e.value))]})]}),(0,U.jsx)(a.A,{variant:"contained",onClick:()=>{ke("");const e=new URLSearchParams,s=Boolean(Te.year),t=Boolean(Te.fromMonth),n=Boolean(Te.toMonth);if(t||n){if(!t||!n)return void ke("Debes seleccionar ambos meses para armar el rango.");const r=s?Number(Te.year):(new Date).getFullYear(),o=Number(Te.fromMonth),a=Number(Te.toMonth);if(o>a)return void ke("El mes Desde no puede ser posterior al mes Hasta.");const l="".concat(r,"-").concat(Y(o),"-01"),i="".concat(r,"-").concat(Y(a),"-").concat(Y(Z(r,a)));e.set("from",l),e.set("to",i)}else if(s){"".concat(Te.year,"-01-01"),"".concat(Te.year,"-12-31");e.set("year",Te.year)}const r=e.toString();if(!r)return ye(!1),Ce(null),Pe(0),void(Ye.current="");ye(!0),Pe(0),Ye.current=r,ss(r,Ae,0)},disabled:Me,children:"Buscar"}),(0,U.jsx)(a.A,{variant:"text",onClick:()=>{_e({year:"",fromMonth:"",toMonth:""}),Ee(""),ke(""),ye(!1),Ce(null),Pe(0),Ye.current=""},disabled:Me,children:"Limpiar"})]}),(0,U.jsx)(v.A,{label:"Buscar por nombre, mes o a\xf1o",variant:"outlined",size:"small",value:Ne,onChange:e=>Ee(e.target.value),sx:{mt:1,mb:2,width:{xs:"100%",sm:250}}}),Re&&(0,U.jsx)(b.A,{severity:"error",sx:{mb:2},children:Re}),fe&&(0,U.jsxs)(U.Fragment,{children:[(0,U.jsxs)(o.A,{sx:{mt:4,mb:2},children:[(0,U.jsx)(u.A,{variant:"subtitle1",sx:{fontWeight:600,mb:1},children:"Resultado de la b\xfasqueda"}),(0,U.jsx)(j.A,{})]}),(0,U.jsx)(f.A,{sx:e=>({width:"100%",mb:3,overflowX:"auto",p:0,bgcolor:(0,z.X4)(e.palette.primary.main,"dark"===e.palette.mode?.12:.06),border:"1px solid ".concat((e.vars||e).palette.divider)}),children:Me?(0,U.jsx)(H.A,{message:"Cargando presupuestos..."}):we&&Array.isArray(we.content)&&we.content.length>0?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsxs)(y.A,{children:[(0,U.jsx)(w.A,{children:(0,U.jsxs)(l.A,{sx:F,children:[(0,U.jsx)(i.A,{sx:e=>(0,r.A)((0,r.A)({},K(e)),G(Ae).nombre),align:"left",children:(0,U.jsx)(te,{label:"Nombre",ghost:js.nombre})}),(0,U.jsx)(i.A,{sx:e=>(0,r.A)((0,r.A)({},K(e)),G(Ae).desde),align:"left",children:(0,U.jsx)(te,{label:"Desde",ghost:js.desde})}),(0,U.jsx)(i.A,{sx:e=>(0,r.A)((0,r.A)({},K(e)),G(Ae).hasta),align:"left",children:(0,U.jsx)(te,{label:"Hasta",ghost:js.hasta})}),"deleted"===Ae&&(0,U.jsx)(i.A,{sx:e=>(0,r.A)((0,r.A)({},K(e)),G(Ae).eliminado),align:"left",children:(0,U.jsx)(te,{label:"Eliminados",ghost:js.eliminado})}),(0,U.jsx)(i.A,{sx:e=>(0,r.A)((0,r.A)({},K(e)),G(Ae).acciones),align:"right",children:(0,U.jsxs)(o.A,{sx:{position:"relative",display:"inline-flex"},children:[(0,U.jsxs)(o.A,{"aria-hidden":!0,sx:{visibility:"hidden",pointerEvents:"none",display:"inline-flex",alignItems:"center",gap:1},children:[(0,U.jsx)(a.A,{variant:"outlined",size:"small",sx:ue,children:"Ver detalle"}),(0,U.jsx)(d.A,{size:"small",children:(0,U.jsx)(B.A,{fontSize:"small"})})]}),(0,U.jsx)(o.A,{sx:{position:"absolute",inset:0,display:"grid",placeItems:"center",whiteSpace:"nowrap",fontWeight:600},children:"Acciones"})]})})]})}),(0,U.jsx)(C.A,{children:xs(we.content)})]}),ps>1&&(0,U.jsx)(o.A,{mt:2,display:"flex",justifyContent:"center",children:(0,U.jsx)(S.A,{color:"primary",size:"small",count:ps,page:hs,onChange:(e,s)=>{if(!fe||!Ye.current)return;const t=Number(s)-1;Number.isNaN(t)||t<0||(Pe(t),ss(Ye.current,Ae,t))},siblingCount:0,boundaryCount:1,"aria-label":"Paginacion de resultados de presupuestos",getItemAriaLabel:(e,s)=>{switch(e){case"page":default:return"Ir a la pagina ".concat(s," de resultados");case"previous":return"Pagina anterior de resultados";case"next":return"Pagina siguiente de resultados"}}})})]}):!Re&&(0,U.jsx)(b.A,{severity:"info",children:"No encontramos presupuestos para el rango seleccionado."})})]}),(0,U.jsxs)(o.A,{sx:{mt:4,mb:2},children:[(0,U.jsx)(u.A,{variant:"subtitle1",sx:{fontWeight:600,mb:1},children:"Listado completo"}),(0,U.jsx)(j.A,{})]}),Ie&&(0,U.jsx)(b.A,{severity:"error",sx:{mb:2},children:Ie}),(0,U.jsx)(f.A,{sx:{width:"100%",overflowX:"auto"},children:Le?(0,U.jsx)(H.A,{message:"Cargando presupuestos..."}):(0,U.jsxs)(y.A,{children:[(0,U.jsx)(w.A,{children:(0,U.jsxs)(l.A,{sx:F,children:[(0,U.jsx)(i.A,{sx:e=>(0,r.A)((0,r.A)({},K(e)),G(Ae).nombre),align:"left",children:(0,U.jsx)(te,{label:"Nombre",ghost:bs.nombre})}),(0,U.jsx)(i.A,{sx:e=>(0,r.A)((0,r.A)({},K(e)),G(Ae).desde),align:"left",children:(0,U.jsx)(te,{label:"Desde",ghost:bs.desde})}),(0,U.jsx)(i.A,{sx:e=>(0,r.A)((0,r.A)({},K(e)),G(Ae).hasta),align:"left",children:(0,U.jsx)(te,{label:"Hasta",ghost:bs.hasta})}),"deleted"===Ae&&(0,U.jsx)(i.A,{sx:e=>(0,r.A)((0,r.A)({},K(e)),G(Ae).eliminado),align:"left",children:(0,U.jsx)(te,{label:"Eliminados",ghost:bs.eliminado})}),(0,U.jsx)(i.A,{sx:e=>(0,r.A)((0,r.A)({},K(e)),G(Ae).acciones),align:"right",children:(0,U.jsxs)(o.A,{sx:{position:"relative",display:"inline-flex"},children:[(0,U.jsxs)(o.A,{"aria-hidden":!0,sx:{visibility:"hidden",pointerEvents:"none",display:"inline-flex",alignItems:"center",gap:1},children:[(0,U.jsx)(a.A,{variant:"outlined",size:"small",sx:ue,children:"Ver detalle"}),(0,U.jsx)(d.A,{size:"small",children:(0,U.jsx)(B.A,{fontSize:"small"})})]}),(0,U.jsx)(o.A,{sx:{position:"absolute",inset:0,display:"grid",placeItems:"center",whiteSpace:"nowrap",fontWeight:600},children:"Acciones"})]})})]})}),(0,U.jsxs)(C.A,{children:[ms.length>0&&xs(ms),0===ms.length&&!Ie&&(0,U.jsx)(l.A,{children:(0,U.jsx)(i.A,{colSpan:cs,sx:e=>(0,r.A)((0,r.A)({},V(e)),{},{textAlign:"center",py:3}),children:"No hay presupuestos para mostrar."})}),Ie&&(0,U.jsx)(l.A,{children:(0,U.jsx)(i.A,{colSpan:cs,sx:e=>(0,r.A)((0,r.A)({},V(e)),{},{textAlign:"center",py:3}),children:(0,U.jsx)(b.A,{severity:"error",children:Ie})})})]})]})}),ds>1&&(0,U.jsx)(o.A,{mt:2,display:"flex",justifyContent:"center",children:(0,U.jsx)(S.A,{color:"primary",size:"small",count:ds,page:us,onChange:(e,s)=>{const t=Number(s)-1;Number.isNaN(t)||t<0||ve(t)},siblingCount:0,boundaryCount:1,"aria-label":"Paginacion de presupuestos",getItemAriaLabel:(e,s)=>{switch(e){case"page":default:return"Ir a la pagina ".concat(s," de presupuestos");case"previous":return"Pagina anterior de presupuestos";case"next":return"Pagina siguiente de presupuestos"}}})}),(0,U.jsx)(o.A,{mt:3,children:(0,U.jsx)(a.A,{variant:"contained",onClick:()=>pe("/presupuestos/nuevo"),children:"Crear nuevo presupuesto"})}),(0,U.jsx)(P.A,{id:"presupuesto-actions-menu",anchorEl:Ve.anchorEl,open:Boolean(Ve.anchorEl),onClose:ts,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},keepMounted:!0,MenuListProps:{"aria-labelledby":Ve.presupuesto?"acciones-presupuesto-".concat(Ve.presupuesto.id):void 0},children:(0,U.jsxs)(g.A,{onClick:()=>{const e=Ve.presupuesto;ts(),e&&(e=>{Fe(null),We({open:!0,presupuesto:e})})(e)},disabled:!Ve.presupuesto,children:[(0,U.jsx)(L.A,{fontSize:"small",sx:{mr:1}})," Eliminar"]})}),(0,U.jsxs)(N.A,{open:Ue.open,onClose:()=>{He||ns()},disableEscapeKeyDown:Boolean(He),maxWidth:"xs",fullWidth:!0,children:[(0,U.jsx)(E.A,{children:"Eliminar presupuesto"}),(0,U.jsx)(T.A,{dividers:!0,children:(0,U.jsx)(u.A,{variant:"body2",children:'Vas a eliminar el presupuesto "'.concat((null===(ae=Ue.presupuesto)||void 0===ae?void 0:ae.nombre)||"",'". Podr\xe1s restaurarlo desde la Papelera durante ').concat(me," d\xedas.")})}),(0,U.jsxs)(_.A,{children:[(0,U.jsx)(a.A,{onClick:ns,disabled:ls,children:"Cancelar"}),(0,U.jsx)(a.A,{color:"error",variant:"contained",onClick:async()=>{const e=Ue.presupuesto;if(e){if(He!==e.id){Fe(e.id);try{await O.A.delete("".concat(he,"/api/presupuestos/").concat(e.id)),Ze.current=e,await es(Ae,ge),fe&&Ye.current&&await ss(Ye.current,Ae,Se),qe({open:!0,message:"Presupuesto eliminado.",action:(0,U.jsx)(a.A,{color:"secondary",size:"small",onClick:()=>as(),children:"Deshacer"})}),ze("")}catch(s){console.error("Error eliminando presupuesto:",s),qe({open:!0,message:"No se pudo eliminar el presupuesto.",action:null})}finally{Fe(null),ns()}}}else ns()},disabled:ls,startIcon:ls?(0,U.jsx)(R.A,{size:16,color:"inherit"}):null,children:ls?"Eliminando...":"Eliminar"})]})]}),(0,U.jsx)(k.A,{open:Be.open,autoHideDuration:6e3,onClose:(e,s)=>{"clickaway"!==s&&qe(e=>(0,r.A)((0,r.A)({},e),{},{open:!1}))},message:Be.message,action:Be.action,anchorOrigin:{vertical:"bottom",horizontal:"center"}})]})}function re(e){return(0,U.jsx)(U.Fragment,{children:(0,U.jsx)(ne,{})})}},88746:(e,s,t)=>{t.d(s,{A:()=>o});var n=t(14057),r=t(70579);const o=(0,n.A)((0,r.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM8 9h8v10H8zm7.5-5-1-1h-5l-1 1H5v2h14V4z"}),"DeleteOutline")}}]);
//# sourceMappingURL=3381.1e2c11b2.chunk.js.map