"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[8875],{78875:(e,o,s)=>{s.r(o),s.d(o,{default:()=>C});var r=s(89379),t=s(65043),a=s(55895),n=s(53089),i=s(91449),c=s(32911),l=s(79722),m=s(23892),d=s(53969),u=s(80172),f=s(70579);const h=e=>{let{children:o}=e;return(0,f.jsx)(t.Suspense,{fallback:(0,f.jsx)(d.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:200,width:"100%"},children:(0,f.jsx)(u.A,{size:40})}),children:o})};var p=s(13658),v=s(60446),g=s.n(v);const j=t.lazy(()=>Promise.all([s.e(7060),s.e(7909),s.e(2815),s.e(2354),s.e(1011),s.e(2112),s.e(8051)]).then(s.bind(s,58051))),D=t.lazy(()=>Promise.all([s.e(7060),s.e(2815),s.e(2354),s.e(9171),s.e(9599)]).then(s.bind(s,61980))),x=t.lazy(()=>Promise.all([s.e(7060),s.e(7909),s.e(2815),s.e(2354),s.e(1011),s.e(2112),s.e(2188)]).then(s.bind(s,82188))),y=t.lazy(()=>Promise.all([s.e(7060),s.e(7909),s.e(2815),s.e(2354),s.e(1011),s.e(2112),s.e(2428)]).then(s.bind(s,52428))),b=t.lazy(()=>Promise.all([s.e(7060),s.e(7909),s.e(2815),s.e(2354),s.e(1011),s.e(2112),s.e(9171),s.e(4214)]).then(s.bind(s,74214))),E=t.lazy(()=>Promise.all([s.e(7060),s.e(7909),s.e(2815),s.e(2354),s.e(1011),s.e(2112),s.e(9171),s.e(8182)]).then(s.bind(s,78182))),A={Factura:["numeroDocumento","versionDocumento","tipoFactura","fechaEmision","montoTotal","categoria","vendedorNombre","compradorNombre"],Movimiento:["montoTotal","fechaEmision"],Ingreso:["montoTotal","fechaEmision"],Egreso:["montoTotal","fechaEmision"],Deuda:["montoTotal","fechaEmision"],Acreencia:["montoTotal","fechaEmision"]};function C(e){let{tipoDoc:o,endpoint:s,formData:d,setFormData:u,errors:v,setErrors:C}=e;const[Y,w]=t.useState(v),[S,T]=t.useState({open:!1,severity:"info",message:""}),[F,k]=t.useState({open:!1,message:""});t.useEffect(()=>{u(e=>{const o=e||{};return"ARS"===o.moneda?o:(0,r.A)((0,r.A)({},o),{},{moneda:"ARS"})})},[u]),t.useEffect(()=>{if(!F.open)return;const e=setTimeout(()=>k({open:!1,message:""}),3500);return()=>clearTimeout(e)},[F.open]),t.useEffect(()=>{w(v)},[v]),t.useEffect(()=>{C(Y)},[Y,C]);const z=t.useCallback(e=>{const o={};return Object.entries(e||{}).forEach(e=>{let[s,r]=e;if(g().isDayjs(r)){const e="fechaEmision"===s?"YYYY-MM-DDTHH:mm:ss":"YYYY-MM-DD";o[s]=r.format(e)}else Array.isArray(r)?o[s]=r.map(e=>g().isDayjs(e)?e.format("YYYY-MM-DD"):null!==e&&void 0!==e?e:""):o[s]=r&&"object"===typeof r||null!==r&&void 0!==r?r:""}),o.moneda="ARS",o},[]);return(0,f.jsxs)(n.A,{sx:{mt:3,width:"100%"},children:[(()=>{switch(o){case"factura":return(0,f.jsx)(h,{children:(0,f.jsx)(j,{formData:d,setFormData:u,errors:Y})});case"movimiento":return(0,f.jsx)(h,{children:(0,f.jsx)(D,{tipoDoc:o,formData:d,setFormData:u,errors:Y})});case"ingreso":return(0,f.jsx)(h,{children:(0,f.jsx)(x,{formData:d,setFormData:u,errors:Y})});case"egreso":return(0,f.jsx)(h,{children:(0,f.jsx)(y,{formData:d,setFormData:u,errors:Y})});case"deuda":return(0,f.jsx)(h,{children:(0,f.jsx)(b,{formData:d,setFormData:u,errors:Y})});case"acreencia":return(0,f.jsx)(h,{children:(0,f.jsx)(E,{formData:d,setFormData:u,errors:Y})});default:return(0,f.jsxs)(a.A,{children:["No hay formulario definido para ",o]})}})(),(0,f.jsx)(m.A,{label:"Enviar ".concat(o),width:"100%",onClick:async()=>{const e={};if((A[o]||[]).forEach(o=>{d[o]||(e[o]="Campo obligatorio")}),C(e),Object.keys(e).length>0)alert("\u26a0\ufe0f Por favor completa todos los campos obligatorios");else try{const e=sessionStorage.getItem("sub");if(!e)return void alert("\u274c Error: No se encontr\xf3 el usuario en la sesi\xf3n. Por favor, inicia sesi\xf3n nuevamente.");const s={"X-Usuario-Sub":e},r=z(d);let t,a=null;["ingreso","egreso","deuda","acreencia"].includes(o.toLowerCase())?(a=o.charAt(0).toUpperCase()+o.slice(1),t={tipo:"movimiento",metodo:"formulario",datos:r,tipoMovimiento:a}):t="factura"===o.toLowerCase()?{tipo:"factura",metodo:"formulario",datos:r}:{tipo:"movimiento",metodo:"formulario",datos:r},console.log("\ud83d\udce4 Enviando datos:",t),console.log("\ud83d\udd10 Headers:",s);const n="".concat(p.A.REGISTRO,"/api/carga-datos"),i=await l.A.post(n,t,{headers:s});console.log("\u2705 Respuesta del servidor:",i.data),k({open:!0,message:i.data.mensaje||"Datos guardados exitosamente"}),u({}),w({})}catch(t){var s,r;console.error("\u274c Error en env\xedo:",t);const e=(null===(s=t.response)||void 0===s||null===(r=s.data)||void 0===r?void 0:r.mensaje)||t.message||"Error desconocido";T({open:!0,severity:"error",message:e})}}}),F.open&&(0,f.jsx)(i.A,{severity:"success",variant:"outlined",sx:{width:"100%",mt:2},onClose:()=>k({open:!1,message:""}),children:F.message}),(0,f.jsx)(c.A,{open:S.open,autoHideDuration:4e3,onClose:()=>T({open:!1,severity:"info",message:""}),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:(0,f.jsx)(i.A,{onClose:()=>T({open:!1,severity:"info",message:""}),severity:S.severity,variant:"filled",sx:{width:"100%"},children:S.message})})]})}}}]);
//# sourceMappingURL=8875.a4c2e5a0.chunk.js.map