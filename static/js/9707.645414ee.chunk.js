"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[9707],{28259:(e,r,o)=>{o.d(r,{A:()=>p});var s=o(89379),i=o(80045),n=o(65043),a=o(58387),t=o(31807),l=o(58128),c=o(28301),d=o(79857),h=o(86061);function x(e){return(0,h.Ay)("MuiTableContainer",e)}(0,d.A)("MuiTableContainer",["root"]);var u=o(70579);const g=["className","component"],A=(0,l.Ay)("div",{name:"MuiTableContainer",slot:"Root"})({width:"100%",overflowX:"auto"}),p=n.forwardRef(function(e,r){const o=(0,c.b)({props:e,name:"MuiTableContainer"}),{className:n,component:l="div"}=o,d=(0,i.A)(o,g),h=(0,s.A)((0,s.A)({},o),{},{component:l}),p=(e=>{const{classes:r}=e;return(0,t.A)({root:["root"]},x,r)})(h);return(0,u.jsx)(A,(0,s.A)({ref:r,as:l,className:(0,a.A)(p.root,n),ownerState:h},d))})},46898:(e,r,o)=>{o.d(r,{A:()=>g});var s=o(89379),i=o(65043),n=o(8789),a=o(53969),t=o(94799),l=o(55895),c=o(56647),d=o(60267),h=o(51697),x=o(5362),u=o(70579);function g(e){let{onFileSelected:r,initialFile:o=null,width:g="100%",height:A=100,accept:p}=e;const j=(0,d.A)(),[m,f]=(0,i.useState)(o),v=(0,i.useCallback)(e=>{if(e.length>0){const o=e[0];f(o),null===r||void 0===r||r(o)}},[r]),{getRootProps:b,getInputProps:y,isDragActive:C}=(0,n.VB)({onDrop:v,multiple:!1,accept:p||void 0});return(0,i.useEffect)(()=>{o&&f(o)},[o]),(0,u.jsxs)(a.A,{sx:{width:g},children:[(0,u.jsxs)(t.A,(0,s.A)((0,s.A)({variant:"outlined"},b()),{},{sx:(0,s.A)({width:"100%",height:A,p:3,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",textAlign:"center",border:"2px dashed",borderColor:C?"primary.main":"grey.400",bgcolor:C?"grey.100":"inherit",cursor:"pointer"},"dark"===j.palette.mode&&{borderColor:C?"primary.light":"grey.700",bgcolor:C?"grey.900":"inherit"}),children:[(0,u.jsx)("input",(0,s.A)({},y())),(0,u.jsx)(h.A,{sx:{fontSize:60,mb:1},color:"action"}),C?(0,u.jsx)(l.A,{variant:"body1",children:"Suelta el archivo aqu\xed..."}):(0,u.jsx)(l.A,{variant:"body1",children:"Arrastr\xe1 y solt\xe1 un archivo aqu\xed o hac\xe9 clic para seleccionarlo"})]})),m&&(0,u.jsxs)(a.A,{sx:(0,s.A)({mt:2,width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",p:1.5,border:"1px solid",borderColor:"grey.300",borderRadius:1},"dark"===j.palette.mode&&{borderColor:"grey.700"}),children:[(0,u.jsx)(l.A,{variant:"body2",children:m.name}),(0,u.jsx)(c.A,{onClick:()=>{f(null),null===r||void 0===r||r(null)},size:"small",color:"error",children:(0,u.jsx)(x.A,{})})]})]})}},69707:(e,r,o)=>{o.r(r),o.d(r,{default:()=>le});var s=o(65043),i=o(53969),n=o(70298),a=o(55895),t=o(94799),l=o(76943),c=o(26687),d=o(12097),h=o(91449),x=o(14057),u=o(70579);const g=(0,x.A)((0,u.jsx)("path",{d:"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"}),"History"),A=(0,x.A)((0,u.jsx)("path",{d:"M5 20h14v-2H5zm0-10h4v6h6v-6h4l-7-7z"}),"Upload");var p=o(10256),j=o(3353),m=o(9446),f=o(88889),v=o(28259),b=o(87443),y=o(10756),C=o(86172),S=o(81341),w=o(34375);const z=(0,x.A)((0,u.jsx)("path",{d:"M19 9h-4V3H9v6H5l7 7zM5 18v2h14v-2z"}),"FileDownload");function D(e,r,o,s,i){return{id:e,fecha:r,descripcion:o,monto:s,medioPago:i}}const I=[D(10001,"2024-05-01","Pago proveedor",-15e3,"Transferencia"),D(10002,"2024-05-02","Venta producto",22e3,"Mercado Pago"),D(10003,"2024-05-03","Pago alquiler",-35e3,"Debito automatico"),D(10004,"2024-05-04","Interes bancario",1500,"Deposito")],R={borderRadius:0,border:"1px solid rgba(255, 255, 255, 0.4)",overflow:"hidden"},k={fontWeight:600,border:"1px solid #000"},W={border:"1px solid #000"},P={},E=e=>(0,u.jsxs)(i.A,{sx:e.sx,children:[(0,u.jsxs)(n.A,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{mb:1},children:[(0,u.jsx)(a.A,{variant:"h6",children:"Ejemplo de archivo esperado:"}),(0,u.jsx)(d.A,{variant:"outlined",startIcon:(0,u.jsx)(z,{}),href:"/plantilla-mycfo.xlsx",download:!0,children:"Descargar plantilla MyCFO"})]}),(0,u.jsx)(v.A,{component:t.A,sx:R,children:(0,u.jsxs)(b.A,{sx:{minWidth:650,borderCollapse:"collapse"},"aria-label":"tabla de ejemplo de carga",size:"small",children:[(0,u.jsx)(y.A,{children:(0,u.jsxs)(C.A,{children:[(0,u.jsx)(S.A,{sx:k,children:"IdReferencia"}),(0,u.jsx)(S.A,{sx:k,children:"Fecha"}),(0,u.jsx)(S.A,{sx:k,children:"Descripcion"}),(0,u.jsx)(S.A,{sx:k,children:"Monto"}),(0,u.jsx)(S.A,{sx:k,children:"Medio de pago"})]})}),(0,u.jsx)(w.A,{children:I.map((e,r)=>(0,u.jsxs)(C.A,{sx:P,children:[(0,u.jsx)(S.A,{sx:W,children:e.id}),(0,u.jsx)(S.A,{sx:W,children:e.fecha}),(0,u.jsx)(S.A,{sx:W,children:e.descripcion}),(0,u.jsx)(S.A,{sx:W,children:e.monto}),(0,u.jsx)(S.A,{sx:W,children:e.medioPago})]},r))})]})})]}),T=e=>{let{resumen:r}=e;return(0,u.jsxs)(n.A,{sx:{width:"100%"},spacing:2,children:[(0,u.jsx)(a.A,{variant:"h6",gutterBottom:!0,children:"Resumen de la carga"}),(0,u.jsxs)(h.A,{severity:"info",variant:"filled",color:"info",children:["Total de filas procesadas: ",r.total]}),(0,u.jsxs)(h.A,{severity:"success",variant:"filled",color:"success",children:["Filas importadas correctamente: ",r.correctos]}),(0,u.jsxs)(h.A,{severity:r.errores.length>0?"error":"success",variant:"filled",color:r.errores.length>0?"error":"success",children:["Filas con errores: ",r.errores.length]})]})},F=e=>{let{errores:r}=e;return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(a.A,{variant:"subtitle1",sx:{mt:3},children:"Detalles de errores"}),(0,u.jsx)(v.A,{component:t.A,sx:{mt:1},children:(0,u.jsxs)(b.A,{size:"small",children:[(0,u.jsx)(y.A,{children:(0,u.jsxs)(C.A,{children:[(0,u.jsx)(S.A,{children:"Fila"}),(0,u.jsx)(S.A,{children:"Error"})]})}),(0,u.jsx)(w.A,{children:r.map((e,r)=>(0,u.jsxs)(C.A,{children:[(0,u.jsx)(S.A,{children:e.fila}),(0,u.jsx)(S.A,{children:e.motivo})]},r))})]})})]})};var O=o(89379),M=o(38517),N=o(81911),H=o(76072),V=o(78776),G=o(26020),U=o(38865),B=o(85877),L=o(17060),X=o(24343),q=o(26529),J=o(56647),K=o(61773),Q=o(85465),Y=o(27421),Z=o(92659);function $(e){let{value:r="Sin categorizar",onChange:o,disabled:n=!1}=e;const[a,t]=s.useState(!1),[l,c]=s.useState(r);s.useEffect(()=>{c(r)},[r]);const d=()=>{l&&l!==r&&Z.gd.includes(l)&&(null===o||void 0===o||o(l)),t(!1)},h=()=>{c(r),t(!1)};return a?(0,u.jsxs)(i.A,{sx:{display:"flex",alignItems:"center",gap:.5,minWidth:200},children:[(0,u.jsx)(L.A,{size:"small",value:l,onChange:(e,r)=>{r&&c(r)},options:Z.gd,autoHighlight:!0,openOnFocus:!0,disableClearable:!0,sx:{minWidth:150,"& .MuiOutlinedInput-root":{height:32,fontSize:"0.75rem"}},renderInput:e=>(0,u.jsx)(X.A,(0,O.A)((0,O.A)({},e),{},{autoFocus:!0,placeholder:"Seleccionar categor\xeda",variant:"outlined"}))}),(0,u.jsx)(q.A,{title:"Guardar",children:(0,u.jsx)(J.A,{size:"small",onClick:d,color:"primary",children:(0,u.jsx)(Q.A,{fontSize:"small"})})}),(0,u.jsx)(q.A,{title:"Cancelar",children:(0,u.jsx)(J.A,{size:"small",onClick:h,color:"inherit",children:(0,u.jsx)(Y.A,{fontSize:"small"})})})]}):(0,u.jsxs)(i.A,{sx:{display:"flex",alignItems:"center",gap:.5},children:[(0,u.jsx)(H.A,{size:"small",label:r,color:"secondary",variant:"outlined",sx:{minWidth:80}}),!n&&(0,u.jsx)(q.A,{title:"Editar categor\xeda",children:(0,u.jsx)(J.A,{size:"small",onClick:()=>t(!0),sx:{opacity:.7,"&:hover":{opacity:1}},children:(0,u.jsx)(K.A,{fontSize:"small"})})})]})}function _(e){let{open:r,onClose:o,previewData:l=[],loading:c=!1,onImportSelected:x,fileName:g="",tipoOrigen:A=""}=e;const[z,D]=s.useState([]),[I,R]=s.useState(!1),[k,W]=s.useState({}),[P,E]=s.useState("todos");s.useEffect(()=>{r&&(D([]),W({}),E("todos"))},[r]);const T=s.useMemo(()=>{switch(P){case"duplicados":return l.filter(e=>e.esDuplicado);case"validos":return l.filter(e=>!e.esDuplicado);default:return l}},[l,P]),F=()=>{if(z.length===T.length)D([]);else{const e=T.map(e=>l.findIndex(r=>r===e));D(e)}},L=function(e){if(null==e)return"\u2014";const r=arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&e>0?-e:e;return new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS"}).format(r)};return(0,u.jsxs)(M.A,{open:r,onClose:o,maxWidth:"lg",fullWidth:!0,PaperProps:{sx:{borderRadius:2,minHeight:"70vh"}},children:[(0,u.jsx)(N.A,{children:(0,u.jsxs)(n.A,{direction:"row",alignItems:"center",spacing:2,children:[(0,u.jsxs)(a.A,{variant:"h6",children:["Vista Previa - ",g]}),(0,u.jsx)(H.A,{label:A.toUpperCase(),size:"small",color:"primary",variant:"outlined"})]})}),(0,u.jsx)(V.A,{children:(0,u.jsxs)(n.A,{spacing:3,children:[c&&(0,u.jsx)(G.A,{}),l.length>0&&(0,u.jsxs)(u.Fragment,{children:[(()=>{const e=l.filter(e=>{var r;return e.esDuplicado&&(null===(r=e.motivoDuplicado)||void 0===r?void 0:r.includes("base de datos"))}).length,r=l.filter(e=>{var r;return e.esDuplicado&&!(null!==(r=e.motivoDuplicado)&&void 0!==r&&r.includes("base de datos"))}).length;return e>0||r>0?(0,u.jsx)(h.A,{severity:"warning",children:(0,u.jsxs)(a.A,{variant:"body2",children:[(0,u.jsx)("strong",{children:"Duplicados detectados:"}),e>0&&" ".concat(e," movimientos ya se han cargado anteriormente."),r>0&&" ".concat(r," movimientos duplicados dentro del Excel."),(0,u.jsx)("br",{})]})}):null})(),(0,u.jsxs)(i.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,u.jsxs)(p.A,{size:"small",sx:{minWidth:200},children:[(0,u.jsx)(j.A,{children:"Filtrar movimientos"}),(0,u.jsxs)(m.A,{value:P,label:"Filtrar movimientos",onChange:e=>E(e.target.value),children:[(0,u.jsxs)(f.A,{value:"todos",children:["Todos (",l.length,")"]}),(0,u.jsxs)(f.A,{value:"validos",children:["V\xe1lidos (",l.filter(e=>!e.esDuplicado).length,")"]}),(0,u.jsxs)(f.A,{value:"duplicados",children:["Duplicados (",l.filter(e=>e.esDuplicado).length,")"]})]})]}),(0,u.jsxs)(a.A,{variant:"body2",color:"text.secondary",children:["Mostrando ",T.length," de ",l.length," ","movimientos"]})]}),(0,u.jsx)(t.A,{variant:"outlined",sx:{borderRadius:2},children:(0,u.jsx)(v.A,{sx:{borderRadius:2},children:(0,u.jsxs)(b.A,{size:"small",stickyHeader:!0,children:[(0,u.jsx)(y.A,{children:(0,u.jsxs)(C.A,{children:[(0,u.jsx)(S.A,{padding:"checkbox",children:(0,u.jsx)(U.A,{checked:z.length===T.length&&T.length>0,indeterminate:z.length>0&&z.length<T.length,onChange:F,inputProps:{"aria-label":"Seleccionar todos"}})}),(0,u.jsx)(S.A,{sx:{fontWeight:600},children:"Tipo"}),(0,u.jsx)(S.A,{sx:{fontWeight:600},children:"Monto Total"}),(0,u.jsx)(S.A,{sx:{fontWeight:600},children:"Fecha"}),(0,u.jsx)(S.A,{sx:{fontWeight:600},children:"Descripci\xf3n"}),(0,u.jsx)(S.A,{sx:{fontWeight:600},children:"Categor\xeda"}),(0,u.jsx)(S.A,{sx:{fontWeight:600},children:"Estado"})]})}),(0,u.jsxs)(w.A,{children:[0===T.length&&!c&&(0,u.jsx)(C.A,{children:(0,u.jsx)(S.A,{colSpan:7,children:(0,u.jsx)(i.A,{sx:{p:3,textAlign:"center",color:"text.secondary"},children:"No hay movimientos para mostrar."})})}),T.map((e,r)=>{var o,s,i,n;const a=l.findIndex(r=>r===e),t=(c=e.fechaEmision)?new Date(c).toLocaleDateString("es-AR"):"";var c;const d=k[a]||e.categoriaSugerida;return(0,u.jsxs)(C.A,{hover:!0,selected:z.includes(a),sx:{"&.Mui-selected":{backgroundColor:e=>e.palette.action.selected},"&:hover":{backgroundColor:e=>e.palette.action.hover}},children:[(0,u.jsx)(S.A,{padding:"checkbox",children:(0,u.jsx)(U.A,{checked:z.includes(a),onChange:()=>(e=>{z.includes(e)?D(z.filter(r=>r!==e)):D([...z,e])})(a),inputProps:{"aria-label":"Seleccionar ".concat(a)}})}),(0,u.jsx)(S.A,{children:(0,u.jsx)(H.A,{size:"small",label:e.tipo||"Ingreso",sx:{backgroundColor:"Egreso"===e.tipo?"#ffebee":"#e8f5e8",color:"Egreso"===e.tipo?"#d32f2f":"#2e7d32",fontWeight:"bold",border:"Egreso"===e.tipo?"1px solid #d32f2f":"1px solid #2e7d32"},variant:"outlined"})}),(0,u.jsx)(S.A,{align:"right",children:(0,u.jsx)("span",{style:{color:"Egreso"===e.tipo?"#d32f2f":"#2e7d32",fontWeight:"bold"},children:L(e.montoTotal,"Egreso"===e.tipo)})}),(0,u.jsx)(S.A,{children:t}),(0,u.jsx)(S.A,{children:e.descripcion||"\u2014"}),(0,u.jsx)(S.A,{children:(0,u.jsx)($,{value:d||"Sin categorizar",onChange:e=>((e,r)=>{W(o=>(0,O.A)((0,O.A)({},o),{},{[e]:r}))})(a,e)})}),(0,u.jsx)(S.A,{children:e.esDuplicado?(0,u.jsx)(H.A,{size:"small",label:null!==(o=e.motivoDuplicado)&&void 0!==o&&o.includes("base de datos")?"Registrado":"Duplicado en Excel",sx:{backgroundColor:null!==(s=e.motivoDuplicado)&&void 0!==s&&s.includes("base de datos")?"#ffebee":"#fff3e0",color:null!==(i=e.motivoDuplicado)&&void 0!==i&&i.includes("base de datos")?"#d32f2f":"#f57c00",fontWeight:"bold",border:null!==(n=e.motivoDuplicado)&&void 0!==n&&n.includes("base de datos")?"1px solid #d32f2f":"1px solid #f57c00"},variant:"outlined"}):(0,u.jsx)(H.A,{size:"small",label:"No registrado",color:"success",variant:"outlined"})})]},a)})]})]})})}),(0,u.jsxs)(i.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,u.jsxs)(a.A,{variant:"body2",color:"text.secondary",children:[z.length," de ",T.length," movimientos seleccionados"]}),(0,u.jsx)(d.A,{variant:"outlined",size:"small",onClick:F,disabled:0===T.length,children:z.length===T.length?"Deseleccionar todos":"Seleccionar todos"})]})]})]})}),(0,u.jsxs)(B.A,{children:[(0,u.jsx)(d.A,{onClick:o,disabled:I,children:"Cancelar"}),(0,u.jsx)(d.A,{variant:"contained",onClick:async()=>{if(0!==z.length){R(!0);try{const e=l.filter((e,r)=>z.includes(r)).map((e,r)=>{const o=l.findIndex(r=>r===e),s=k[o];return(0,O.A)((0,O.A)({},e),{},{categoriaSugerida:s||e.categoriaSugerida})});await(null===x||void 0===x?void 0:x(e)),D([]),W({}),null===o||void 0===o||o()}catch(e){console.error("Error importing selected registros:",e)}finally{R(!1)}}},disabled:0===z.length||I,children:I?"Guardando...":"Guardar ".concat(z.length," movimientos")})]})]})}var ee=o(46898),re=o(23892),oe=o(79722),se=o(13658);function ie(e){var r;let{onCargaCompletada:o}=e;const[n,t]=s.useState(null),[l,c]=s.useState(null),[d,h]=s.useState(""),[x,g]=s.useState(!1),[A,v]=s.useState([]),[b,y]=s.useState(!1),[C,S]=s.useState(""),w=()=>sessionStorage.getItem("sub");return(0,u.jsxs)(i.A,{sx:{width:"100%",maxWidth:{sm:"100%",md:"1700px"},mx:"auto"},children:[(0,u.jsx)(a.A,{component:"h2",variant:"h6",sx:{mb:3},children:"Carga Excel"}),(0,u.jsx)(E,{sx:{mb:4}})," ",(0,u.jsxs)(p.A,{fullWidth:!0,sx:{mb:4},children:[(0,u.jsx)(j.A,{id:"tipo-origen-label",children:"Tipo de archivo"}),(0,u.jsxs)(m.A,{labelId:"tipo-origen-label",id:"tipo-origen",value:d,label:"Tipo de archivo",onChange:e=>h(e.target.value),children:[(0,u.jsx)(f.A,{value:"",children:"Seleccione una opci\xf3n"}),(0,u.jsx)(f.A,{value:"mycfo",children:"MyCFO (plantilla gen\xe9rica)"}),(0,u.jsx)(f.A,{value:"mercado-pago",children:"Mercado Pago"})]})]}),(0,u.jsx)(ee.A,{onFileSelected:e=>{c(e),S(e.name),console.log("Archivo recibido:",e)},width:"100%",height:120,sx:{mb:3}}),(0,u.jsx)(re.A,{width:"100%",onClick:async()=>{if(l&&d){y(!0);try{const e=w();if(!e)return alert("No se encontr\xf3 la sesi\xf3n del usuario. Volv\xe9 a iniciar sesi\xf3n."),void y(!1);const r=new FormData;r.append("file",l),r.append("tipoOrigen",d);const o=await oe.A.post("".concat(se.A.REGISTRO,"/api/preview-excel"),r,{headers:{"Content-Type":"multipart/form-data","X-Usuario-Sub":e}});v(o.data.registros||[]),g(!0)}catch(e){console.error("Error al procesar el archivo:",e),alert("Ocurri\xf3 un error al procesar el archivo. Revisar consola.")}finally{y(!1)}}else console.warn("Debe seleccionar un tipo de archivo y subir un archivo")},sx:{mt:1,mb:4},disabled:b||!d||!l,children:b?"Procesando...":"Vista Previa"}),n&&(0,u.jsxs)(i.A,{mt:4,mb:4,children:[" ",(0,u.jsx)(T,{resumen:n,sx:{mb:3}}),(null===(r=n.errores)||void 0===r?void 0:r.length)>0&&(0,u.jsx)(F,{errores:n.errores})]}),(0,u.jsx)(_,{open:x,onClose:()=>{g(!1),v([])},previewData:A,loading:b,onImportSelected:async e=>{try{const r=w();if(!r)return void alert("No se encontr\xf3 la sesi\xf3n del usuario. Volv\xe9 a iniciar sesi\xf3n.");const s={registrosSeleccionados:e,fileName:C,tipoOrigen:d},i=await oe.A.post("".concat(se.A.REGISTRO,"/api/guardar-seleccionados"),s,{headers:{"Content-Type":"application/json","X-Usuario-Sub":r}});t(i.data),g(!1),c(null),S(""),null===o||void 0===o||o()}catch(r){console.error("Error al guardar los registros:",r),alert("Ocurri\xf3 un error al guardar los registros. Revisar consola.")}},fileName:C,tipoOrigen:d})]})}var ne=o(52412);const ae=e=>{if(!e)return"";return new Date(e).toLocaleString("es-AR")};function te(e){let{rows:r=[],loading:o=!1,page:s=0,pageSize:n=20,total:t=0,onPageChange:l,onPageSizeChange:c}=e;const d=e=>{switch(e){case"COMPLETADO":return(0,u.jsx)(H.A,{size:"small",label:"Completado",sx:{backgroundColor:"#e8f5e8",color:"#2e7d32",fontWeight:"bold",border:"1px solid #2e7d32"},variant:"outlined"});case"PARCIAL":return(0,u.jsx)(H.A,{size:"small",label:"Parcial",sx:{backgroundColor:"#fff3e0",color:"#f57c00",fontWeight:"bold",border:"1px solid #f57c00"},variant:"outlined"});case"ERROR":return(0,u.jsx)(H.A,{size:"small",label:"Error",sx:{backgroundColor:"#ffebee",color:"#d32f2f",fontWeight:"bold",border:"1px solid #d32f2f"},variant:"outlined"});default:return(0,u.jsx)(H.A,{size:"small",label:"Desconocido",sx:{backgroundColor:"#f5f5f5",color:"#666666",fontWeight:"bold",border:"1px solid #e0e0e0"},variant:"outlined"})}},h=e=>{const r={mycfo:{bg:"#e3f2fd",color:"#1976d2",border:"#1976d2"},"mercado-pago":{bg:"#f3e5f5",color:"#7b1fa2",border:"#7b1fa2"},santander:{bg:"#e8f5e8",color:"#388e3c",border:"#388e3c"}}[e]||{bg:"#f5f5f5",color:"#666666",border:"#e0e0e0"};return(0,u.jsx)(H.A,{size:"small",label:e.toUpperCase(),sx:{backgroundColor:r.bg,color:r.color,fontWeight:"bold",border:"1px solid ".concat(r.border)},variant:"outlined"})};return(0,u.jsxs)(v.A,{sx:{borderRadius:2},children:[o&&(0,u.jsx)(G.A,{}),(0,u.jsxs)(b.A,{size:"small",stickyHeader:!0,children:[(0,u.jsx)(y.A,{children:(0,u.jsxs)(C.A,{children:[(0,u.jsx)(S.A,{sx:{fontWeight:600},children:"Archivo"}),(0,u.jsx)(S.A,{sx:{fontWeight:600},children:"Tipo"}),(0,u.jsx)(S.A,{sx:{fontWeight:600},children:"Fecha Importaci\xf3n"}),(0,u.jsx)(S.A,{sx:{fontWeight:600},children:"Total Registros"}),(0,u.jsx)(S.A,{sx:{fontWeight:600},children:"Guardados"}),(0,u.jsx)(S.A,{sx:{fontWeight:600},children:"Estado"})]})}),(0,u.jsxs)(w.A,{children:[0===r.length&&!o&&(0,u.jsx)(C.A,{children:(0,u.jsx)(S.A,{colSpan:7,children:(0,u.jsx)(i.A,{sx:{p:3,textAlign:"center",color:"text.secondary"},children:"No hay historial de cargas para mostrar."})})}),r.map((e,r)=>(0,u.jsxs)(C.A,{hover:!0,sx:{"&:hover":{backgroundColor:e=>e.palette.action.hover}},children:[(0,u.jsx)(S.A,{children:(0,u.jsx)(a.A,{variant:"body2",sx:{fontWeight:500},children:e.fileName||"\u2014"})}),(0,u.jsx)(S.A,{children:h(e.tipoOrigen||"desconocido")}),(0,u.jsx)(S.A,{children:(0,u.jsx)(a.A,{variant:"body2",children:ae(e.fechaImportacion)})}),(0,u.jsx)(S.A,{align:"center",children:(0,u.jsx)(a.A,{variant:"body2",sx:{fontWeight:500},children:e.totalRegistros||0})}),(0,u.jsx)(S.A,{align:"center",children:(0,u.jsx)(a.A,{variant:"body2",sx:{fontWeight:500},children:e.registrosGuardados||0})}),(0,u.jsx)(S.A,{children:d(e.estado)})]},e.id||r))]})]}),(0,u.jsx)(ne.A,{component:"div",count:t,page:s,onPageChange:(e,r)=>l(r),rowsPerPage:n,onRowsPerPageChange:e=>c(parseInt(e.target.value,10)),rowsPerPageOptions:[10,20,50,100]})]})}function le(){const[e,r]=s.useState(0),[o,x]=s.useState([]),[p,j]=s.useState(!1),[m,f]=s.useState(0),[v,b]=s.useState(20),y=async()=>{j(!0);try{const e=sessionStorage.getItem("sub");if(!e)return alert("No se encontr\xf3 la sesi\xf3n del usuario. Volv\xe9 a iniciar sesi\xf3n."),void j(!1);const r=await oe.A.get("".concat(se.A.REGISTRO,"/api/historial-cargas"),{headers:{"X-Usuario-Sub":e}});x(r.data)}catch(e){console.error("Error al cargar historial:",e)}finally{j(!1)}};s.useEffect(()=>{1===e&&y()},[e]);return(0,u.jsxs)(i.A,{sx:{width:"100%",maxWidth:{sm:"100%",md:"1700px"},mx:"auto",mt:3,p:3},children:[(0,u.jsxs)(n.A,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{mb:2},children:[(0,u.jsx)(a.A,{variant:"h4",children:"Carga de movimientos"}),(0,u.jsx)(i.A,{sx:{minWidth:120}})]}),(0,u.jsx)(t.A,{variant:"outlined",sx:{mb:2,borderRadius:2,p:1,bgcolor:e=>"dark"===e.palette.mode?"background.default":"background.paper"},children:(0,u.jsx)(i.A,{sx:{borderBottom:1,borderColor:"divider"},children:(0,u.jsxs)(l.A,{value:e,onChange:(e,o)=>{r(o)},children:[(0,u.jsx)(c.A,{icon:(0,u.jsx)(A,{}),label:"Cargar Excel",iconPosition:"start"}),(0,u.jsx)(c.A,{icon:(0,u.jsx)(g,{}),label:"Historial de Cargas",iconPosition:"start"})]})})}),0===e&&(0,u.jsx)(t.A,{variant:"outlined",sx:{borderRadius:2,p:3},children:(0,u.jsx)(ie,{onCargaCompletada:()=>{1===e&&y()}})}),1===e&&(0,u.jsx)(t.A,{variant:"outlined",sx:{borderRadius:2},children:(0,u.jsxs)(i.A,{sx:{p:3},children:[(0,u.jsxs)(n.A,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{mb:3},children:[(0,u.jsx)(a.A,{variant:"h6",children:"Historial de Cargas Excel"}),(0,u.jsx)(d.A,{variant:"outlined",onClick:y,disabled:p,children:"Actualizar"})]}),0===o.length&&!p&&(0,u.jsx)(h.A,{severity:"info",children:"No hay historial de cargas disponible."}),(0,u.jsx)(te,{rows:o,loading:p,page:m,pageSize:v,total:o.length,onPageChange:f,onPageSizeChange:e=>{b(e),f(0)}})]})})]})}},92659:(e,r,o)=>{o.d(r,{gd:()=>n});const s=["Alimentos y Bebidas","Transporte","Vivienda","Servicios B\xe1sicos","Ocio y Entretenimiento","Compras Personales","Salud","Educaci\xf3n","Impuestos y Tasas","Servicios Financieros","Compras de Negocio","Otros Egresos"],i=["Ventas de Productos","Prestaci\xf3n de Servicios","Cobranzas","Transferencias Recibidas","Inversiones y Rendimientos","Otros Ingresos"],n=[...s,...i]}}]);
//# sourceMappingURL=9707.645414ee.chunk.js.map