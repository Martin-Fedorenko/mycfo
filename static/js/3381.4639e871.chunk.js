"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[3381],{12043:(e,s,t)=>{t.d(s,{A:()=>o});var n=t(14057),r=t(70579);const o=(0,n.A)((0,r.jsx)("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2"}),"MoreVert")},38915:(e,s,t)=>{t.d(s,{A:()=>v});var n=t(79722),r=t(35644),o=t(29296),a=t(13658);const l=n.A.create(),i=a.A.PRONOSTICO,c={UserPoolId:"sa-east-1_lTMNrWW7R",ClientId:"3ksssqtg3r49rf6js1t1177hrd"};let d=null,u=!1;const p=e=>Boolean(e&&i&&String(e).startsWith(String(i))),h=e=>{try{return sessionStorage.getItem(e)}catch(s){return console.warn("No se pudo leer sessionStorage:",s),null}},m=(e,s)=>{try{void 0!==s&&null!==s&&sessionStorage.setItem(e,s)}catch(t){console.warn("No se pudo escribir en sessionStorage:",t)}},A=()=>{if(!u){u=!0;try{sessionStorage.clear()}catch(e){}null!==o.m&&void 0!==o.m&&o.m.limpiarSesion&&o.m.limpiarSesion(),"undefined"!==typeof window&&(window.location.href="/#/signin")}},x=()=>{const e=h("refreshToken"),s=(()=>{const e=h("email")||h("username");if(!e||!c.UserPoolId||!c.ClientId)return null;const s=new r.NE(c);return new r.TU({Username:e,Pool:s})})();if(!e||!s)return Promise.reject(new Error("No hay datos para renovar la sesi\xf3n."));const t=new r.c9({RefreshToken:e});return new Promise((e,n)=>{s.refreshSession(t,(s,t)=>{if(s)return void n(s);const r=t.getAccessToken().getJwtToken(),o=t.getIdToken().getJwtToken(),a=t.getRefreshToken().getToken();m("accessToken",r),m("idToken",o),a&&m("refreshToken",a),e(r)})})};l.interceptors.request.use(e=>{const s=sessionStorage.getItem("accessToken");if(p(e.url)){var t;e.headers=null!==(t=e.headers)&&void 0!==t?t:{},s&&(e.headers.Authorization="Bearer ".concat(s));const n=sessionStorage.getItem("sub");n&&(e.headers["X-Usuario-Sub"]=n)}return e}),l.interceptors.response.use(e=>e,async e=>{const{config:s,response:t}=e;if(!s||!t||401!==t.status||!p(s.url))return Promise.reject(e);if(s.__isRetryRequest)return A(),Promise.reject(e);try{var n;const e=await(d||(d=x().then(e=>(d=null,e)).catch(e=>{throw d=null,e})),d);if(!e)throw new Error("No se obtuvo un token renovado.");return s.__isRetryRequest=!0,s.headers=null!==(n=s.headers)&&void 0!==n?n:{},s.headers.Authorization="Bearer ".concat(e),l(s)}catch(r){return A(),Promise.reject(r)}});const v=l},63381:(e,s,t)=>{t.r(s),t.d(s,{default:()=>re});var n=t(65043),r=t(89379),o=t(53969),a=t(12097),l=t(86172),i=t(81341),c=t(26529),d=t(56647),u=t(55895),p=t(76943),h=t(26687),m=t(10256),A=t(3353),x=t(9446),v=t(88889),g=t(24343),b=t(91449),j=t(94527),f=t(94799),y=t(87443),C=t(10756),S=t(34375),N=t(56465),w=t(46471),P=t(38517),E=t(81911),T=t(78776),R=t(85877),_=t(80172),I=t(32911),k=t(60267),M=t(89826),z=t(29001),O=t(38915),L=t(88746),D=t(14057),U=t(70579);const W=(0,D.A)((0,U.jsx)("path",{d:"M19 4h-3.5l-1-1h-5l-1 1H5v2h14zM6 7v12c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7zm8 7v4h-4v-4H8l4-4 4 4z"}),"RestoreFromTrash");var B=t(12043),H=t(13658),F=t(96470);const V={backgroundColor:"rgba(255, 255, 255, 0.02)","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.05)"}},q=e=>({border:"1px solid ".concat((e.vars||e).palette.divider)}),K=e=>(0,r.A)((0,r.A)({},q(e)),{},{fontWeight:600}),X=e=>({nombre:{width:"deleted"===e?"20%":"25%"},desde:{width:"deleted"===e?"20%":"25%"},hasta:{width:"deleted"===e?"20%":"25%"},eliminado:{width:"20%"},acciones:{width:"deleted"===e?"20%":"25%"}}),G=["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],Y=e=>String(e).padStart(2,"0"),Z=(e,s)=>new Date(e,s,0).getDate(),J=()=>{const e=Number({NODE_ENV:"production",PUBLIC_URL:"/mycfo",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AWS_REGION:"sa-east-1",REACT_APP_BASE_URL:"https://xbvl5v-ip-186-126-115-133.tunnelmole.net",REACT_APP_COGNITO_CLIENT_ID:"3ksssqtg3r49rf6js1t1177hrd",REACT_APP_COGNITO_USER_POOL_ID:"sa-east-1_lTMNrWW7R",REACT_APP_URL_ADMINISTRACION:"https://xbvl5v-ip-186-126-115-133.tunnelmole.net/administracion",REACT_APP_URL_IA:"https://xbvl5v-ip-186-126-115-133.tunnelmole.net/ia",REACT_APP_URL_NOTIFICACION:"https://xbvl5v-ip-186-126-115-133.tunnelmole.net/notificacion",REACT_APP_URL_PRONOSTICO:"https://xbvl5v-ip-186-126-115-133.tunnelmole.net/pronostico",REACT_APP_URL_REGISTRO:"https://xbvl5v-ip-186-126-115-133.tunnelmole.net/registro",REACT_APP_URL_REPORTE:"https://xbvl5v-ip-186-126-115-133.tunnelmole.net/reporte",REACT_APP_WEBSOCKET_URL:"https://xbvl5v-ip-186-126-115-133.tunnelmole.net/notificacion/ws"}.REACT_APP_PRESUPUESTO_RETENTION_DAYS);return Number.isNaN(e)||e<=0?90:e},Q=e=>{if(!e)return"-";const s=new Date(e);return Number.isNaN(s.valueOf())?e:s.toLocaleString("es-AR",{hour12:!1})},$=3,ee="createdAt,desc",se=()=>({content:[],totalElements:0,totalPages:0,number:0,size:$}),te=e=>{let{label:s,ghost:t}=e;return(0,U.jsxs)(o.A,{sx:{position:"relative",display:"inline-flex"},children:[(0,U.jsx)(o.A,{"aria-hidden":!0,sx:{visibility:"hidden",pointerEvents:"none",display:"inline-flex",whiteSpace:"nowrap"},children:t}),(0,U.jsx)(o.A,{sx:{position:"absolute",inset:0,display:"grid",placeItems:"center",whiteSpace:"nowrap"},children:s})]})};function ne(){var e,s,t,D,ne,re,oe,ae;const le=(0,k.A)(),ie="light"===le.palette.mode,ce=null!==(e=null===(s=le.vars)||void 0===s?void 0:s.palette)&&void 0!==e?e:le.palette,de=ie?null!==(t=null===(D=ce.text)||void 0===D?void 0:D.primary)&&void 0!==t?t:"#000":null!==(ne=null===(re=ce.common)||void 0===re?void 0:re.white)&&void 0!==ne?ne:"#fff",ue=ie?void 0:{color:"#42897f"},pe=(0,z.Zp)(),he=H.A.PRONOSTICO,me=n.useMemo(()=>J(),[]),[Ae,xe]=n.useState("active"),[ve,ge]=n.useState(0),[be,je]=n.useState(se),[fe,ye]=n.useState(!1),[Ce,Se]=n.useState(null),[Ne,we]=n.useState(0),[Pe,Ee]=n.useState(""),[Te,Re]=n.useState({year:"",fromMonth:"",toMonth:""}),[_e,Ie]=n.useState(""),[ke,Me]=n.useState(""),[ze,Oe]=n.useState(!1),[Le,De]=n.useState(!1),[Ue,We]=n.useState({open:!1,presupuesto:null}),[Be,He]=n.useState({open:!1,message:"",action:null}),[Fe,Ve]=n.useState(null),[qe,Ke]=n.useState({anchorEl:null,presupuesto:null}),[Xe,Ge]=n.useState(()=>{const e=(new Date).getFullYear();return[e-1,e,e+1]}),Ye=n.useRef(""),Ze=n.useRef(null),[Je,Qe]=n.useState(null),$e=n.useCallback(e=>{if(!e)return"";const[s,t]=e.split("-"),n=Number(t)-1;return n>=0&&n<G.length?"".concat(G[n]," ").concat(s):e},[]),es=n.useCallback(()=>{const e=sessionStorage.getItem("sub");e&&fetch("".concat(H.A.ADMINISTRACION,"/api/usuarios/perfil"),{headers:{"X-Usuario-Sub":e}}).then(e=>e.ok?e.json():null).then(e=>{e&&e.rol&&Qe(e.rol)}).catch(e=>console.error("Error cargando rol de usuario:",e))},[]),ss=n.useCallback(e=>{Array.isArray(e)&&0!==e.length&&Ge(s=>{const t=new Set(s);return e.forEach(e=>{var s,n;const r=Number(null===e||void 0===e||null===(s=e.desde)||void 0===s?void 0:s.split("-")[0]),o=Number(null===e||void 0===e||null===(n=e.hasta)||void 0===n?void 0:n.split("-")[0]);Number.isNaN(r)||t.add(r),Number.isNaN(o)||t.add(o)}),Array.from(t).sort((e,s)=>e-s)})},[]),ts=n.useCallback(e=>{if(!e||"object"!==typeof e)return se();const s=Array.isArray(e.content)?e.content:[],t=Number(e.totalElements),n=Number(e.totalPages),r=Number(e.number),o=Number(e.size);return{content:s,totalElements:Number.isFinite(t)?t:s.length,totalPages:Number.isFinite(n)?n:s.length>0?1:0,number:Number.isFinite(r)?r:0,size:Number.isFinite(o)&&o>0?o:$}},[]),ns=n.useCallback(async(e,s)=>{De(!0);try{const t=Pe.trim().length>=2,n=t?0:Math.max(s,0),r=t?1e3:$,o=new URLSearchParams;o.set("status",e),o.set("page",String(n)),o.set("size",String(r)),o.set("sort",ee);const a=await O.A.get("".concat(he,"/api/presupuestos?").concat(o.toString())),l=ts(a.data);if(!t&&s>0&&l.totalPages>0&&s>=l.totalPages)return void ge(l.totalPages-1);je(l),ss(l.content),Me(""),t&&0!==s&&ge(0)}catch(t){console.error("Error cargando presupuestos desde el backend:",t),je(se()),Me("No se pudo cargar la lista de presupuestos. Intenta nuevamente.")}finally{De(!1)}},[he,ss,ts,Pe]),rs=n.useCallback(async(e,s,t)=>{Oe(!0);try{const n=new URLSearchParams(e||"");n.set("status",s),n.set("page",String(Math.max(t,0))),n.set("size",String($)),n.set("sort",ee);const r=await O.A.get("".concat(he,"/api/presupuestos?").concat(n.toString())),o=ts(r.data);if(t>0&&o.totalPages>0&&t>=o.totalPages)return void we(o.totalPages-1);Se(o),ss(o.content),Ie("")}catch(n){console.error("Error cargando presupuestos desde el backend:",n),Se(se()),Ie("No se pudo cargar la lista filtrada. Intenta nuevamente.")}finally{Oe(!1)}},[he,ss,ts]);n.useEffect(()=>{ns(Ae,ve),es()},[ns,Ae,ve,es]);n.useEffect(()=>{Ke({anchorEl:null,presupuesto:null})},[Ae]);const os=()=>{Ke({anchorEl:null,presupuesto:null})},as=n.useCallback(()=>{We({open:!1,presupuesto:null})},[]),ls=n.useCallback(async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Presupuesto restaurado.";if(e)try{await O.A.post("".concat(he,"/api/presupuestos/").concat(e.id,"/restore")),await ns(Ae,ve),fe&&Ye.current&&await rs(Ye.current,Ae,Ne),s&&He({open:!0,message:s,action:null}),Me("")}catch(t){console.error("Error restaurando presupuesto:",t),He({open:!0,message:"No se pudo restaurar el presupuesto.",action:null})}},[he,ns,rs,fe,ve,Ne,Ae]),is=n.useCallback(e=>{ls(e,"Presupuesto restaurado.")},[ls]),cs=n.useCallback(async()=>{const e=Ze.current;e?(Ze.current=null,await ls(e,"Presupuesto restaurado.")):He(e=>(0,r.A)((0,r.A)({},e),{},{open:!1}))},[ls]),ds=Fe===(null===(oe=Ue.presupuesto)||void 0===oe?void 0:oe.id),us=n.useMemo(()=>G.map((e,s)=>({value:String(s+1),label:e.charAt(0).toUpperCase()+e.slice(1)})),[]),ps="deleted"===Ae?5:4,hs=Number(be.totalPages)||0,ms=hs>0?be.number+1:1,As=Ce&&Number(Ce.totalPages)||0,xs=As>0&&Ce?Ce.number+1:1,vs=n.useMemo(()=>{const e=Pe.trim().toLowerCase(),s=Array.isArray(be.content)?be.content:[];return e?s.filter(s=>{const t=((null===s||void 0===s?void 0:s.nombre)||"").toLowerCase(),n=((null===s||void 0===s?void 0:s.desde)||"").toLowerCase(),r=((null===s||void 0===s?void 0:s.hasta)||"").toLowerCase(),o=$e((null===s||void 0===s?void 0:s.desde)||"").toLowerCase(),a=$e((null===s||void 0===s?void 0:s.hasta)||"").toLowerCase();return t.includes(e)||n.includes(e)||r.includes(e)||o.includes(e)||a.includes(e)}):s},[be.content,Pe,$e]),gs=e=>s=>{const t=s.target.value;Re(s=>(0,r.A)((0,r.A)({},s),{},{[e]:t}))},bs=e=>e.map(e=>{const s=encodeURIComponent((e.nombre||"").trim().toLowerCase().replace(/\s+/g,"-")),t="deleted"===Ae,n=Boolean(qe.anchorEl)&&qe.presupuesto&&qe.presupuesto.id===e.id,u=n?"presupuesto-actions-menu":void 0,p="acciones-presupuesto-".concat(e.id),h=(Je||"").toUpperCase().includes("ADMIN");return(0,U.jsxs)(l.A,{sx:V,children:[(0,U.jsx)(i.A,{sx:e=>(0,r.A)((0,r.A)({},q(e)),X(Ae).nombre),children:e.nombre}),(0,U.jsx)(i.A,{sx:e=>(0,r.A)((0,r.A)({},q(e)),X(Ae).desde),children:$e(e.desde)}),(0,U.jsx)(i.A,{sx:e=>(0,r.A)((0,r.A)({},q(e)),X(Ae).hasta),children:$e(e.hasta)}),t&&(0,U.jsx)(i.A,{sx:e=>(0,r.A)((0,r.A)({},q(e)),X(Ae).eliminado),children:Q(e.deletedAt)}),(0,U.jsx)(i.A,{sx:e=>(0,r.A)((0,r.A)({},q(e)),X(Ae).acciones),align:"right",children:t?(0,U.jsx)(a.A,{variant:"outlined",size:"small",startIcon:(0,U.jsx)(W,{}),onClick:()=>is(e),children:"Restaurar"}):(0,U.jsxs)(o.A,{sx:{display:"flex",justifyContent:"flex-end",gap:1},children:[(0,U.jsx)(a.A,{variant:"outlined",size:"small",onClick:()=>pe("/presupuestos/".concat(s)),sx:ue,children:"Ver detalle"}),h&&(0,U.jsx)(c.A,{title:"M\xe1s acciones",children:(0,U.jsx)(d.A,{size:"small","aria-label":"M\xe1s acciones","aria-controls":u,"aria-haspopup":"true","aria-expanded":n?"true":void 0,id:p,onClick:s=>((e,s)=>{Ke({anchorEl:e.currentTarget,presupuesto:s})})(s,e),children:(0,U.jsx)(B.A,{fontSize:"small"})})})]})})]},e.id)}),js=n.useMemo(()=>Array.isArray(null===be||void 0===be?void 0:be.content)&&be.content.length?be.content[0]:null,[null===be||void 0===be?void 0:be.content]),fs=n.useMemo(()=>Ce&&Array.isArray(Ce.content)&&Ce.content.length?Ce.content[0]:null,[Ce]),ys={nombre:(null===js||void 0===js?void 0:js.nombre)||"Nombre de ejemplo",desde:$e((null===js||void 0===js?void 0:js.desde)||"2025-01"),hasta:$e((null===js||void 0===js?void 0:js.hasta)||"2025-12"),eliminado:Q((null===js||void 0===js?void 0:js.deletedAt)||"2025-10-14T20:21:43Z")},Cs={nombre:(null===fs||void 0===fs?void 0:fs.nombre)||"Nombre de ejemplo",desde:$e((null===fs||void 0===fs?void 0:fs.desde)||"2025-01"),hasta:$e((null===fs||void 0===fs?void 0:fs.hasta)||"2025-12"),eliminado:Q((null===fs||void 0===fs?void 0:fs.deletedAt)||"2025-10-14T20:21:43Z")};return(0,U.jsxs)(o.A,{sx:{width:"100%",p:3},children:[(0,U.jsx)(u.A,{variant:"h4",gutterBottom:!0,children:"Presupuestos"}),(0,U.jsx)(u.A,{variant:"subtitle1",gutterBottom:!0,children:"Visualiza tus presupuestos creados o genera uno nuevo"}),(0,U.jsxs)(p.A,{value:Ae,onChange:(e,s)=>{s!==Ae&&(xe(s),ge(0),ye(!1),Se(null),we(0),Ie(""),Ye.current="")},sx:{mt:1},children:[(0,U.jsx)(h.A,{value:"active",label:"Activos",sx:{color:de,"&.Mui-selected":{color:de},"& .MuiTab-wrapper":{color:de}}}),(0,U.jsx)(h.A,{value:"deleted",label:"Borrados",sx:{color:de,"&.Mui-selected":{color:de},"& .MuiTab-wrapper":{color:de}}})]}),(0,U.jsx)(u.A,{variant:"caption",sx:{display:"block",mb:2,color:"text.primary"},children:"Los presupuestos se purgan de forma definitiva a los ".concat(me," d\xedas.")}),(0,U.jsxs)(o.A,{sx:{display:"flex",flexWrap:"wrap",gap:2,alignItems:"center",mt:2,mb:2},children:[(0,U.jsxs)(m.A,{size:"small",sx:{minWidth:120},children:[(0,U.jsx)(A.A,{id:"presupuesto-year-label",children:"A\xf1o"}),(0,U.jsxs)(x.A,{labelId:"presupuesto-year-label",value:Te.year,label:"A\xf1o",onChange:gs("year"),children:[(0,U.jsx)(v.A,{value:"",children:(0,U.jsx)("em",{children:"Todos"})}),Xe.map(e=>(0,U.jsx)(v.A,{value:String(e),children:e},e))]})]}),(0,U.jsxs)(m.A,{size:"small",sx:{minWidth:150},children:[(0,U.jsx)(A.A,{id:"presupuesto-from-label",children:"Desde (mes)"}),(0,U.jsxs)(x.A,{labelId:"presupuesto-from-label",value:Te.fromMonth,label:"Desde (mes)",onChange:gs("fromMonth"),children:[(0,U.jsx)(v.A,{value:"",children:(0,U.jsx)("em",{children:"Sin filtro"})}),us.map(e=>(0,U.jsx)(v.A,{value:e.value,children:e.label},e.value))]})]}),(0,U.jsxs)(m.A,{size:"small",sx:{minWidth:150},children:[(0,U.jsx)(A.A,{id:"presupuesto-to-label",children:"Hasta (mes)"}),(0,U.jsxs)(x.A,{labelId:"presupuesto-to-label",value:Te.toMonth,label:"Hasta (mes)",onChange:gs("toMonth"),children:[(0,U.jsx)(v.A,{value:"",children:(0,U.jsx)("em",{children:"Sin filtro"})}),us.map(e=>(0,U.jsx)(v.A,{value:e.value,children:e.label},e.value))]})]}),(0,U.jsx)(a.A,{variant:"contained",onClick:()=>{Ie("");const e=new URLSearchParams,s=Boolean(Te.year),t=Boolean(Te.fromMonth),n=Boolean(Te.toMonth);if(t||n){if(!t||!n)return void Ie("Debes seleccionar ambos meses para armar el rango.");const r=s?Number(Te.year):(new Date).getFullYear(),o=Number(Te.fromMonth),a=Number(Te.toMonth);if(o>a)return void Ie("El mes Desde no puede ser posterior al mes Hasta.");const l="".concat(r,"-").concat(Y(o),"-01"),i="".concat(r,"-").concat(Y(a),"-").concat(Y(Z(r,a)));e.set("from",l),e.set("to",i)}else if(s){"".concat(Te.year,"-01-01"),"".concat(Te.year,"-12-31");e.set("year",Te.year)}const r=e.toString();if(!r)return ye(!1),Se(null),we(0),void(Ye.current="");ye(!0),we(0),Ye.current=r,rs(r,Ae,0)},disabled:ze,children:"Buscar"}),(0,U.jsx)(a.A,{variant:"text",onClick:()=>{Re({year:"",fromMonth:"",toMonth:""}),Ee(""),Ie(""),ye(!1),Se(null),we(0),Ye.current=""},disabled:ze,children:"Limpiar"})]}),(0,U.jsx)(g.A,{label:"Buscar por nombre, mes o a\xf1o",variant:"outlined",size:"small",value:Pe,onChange:e=>Ee(e.target.value),sx:{mt:1,mb:2,width:{xs:"100%",sm:250}}}),_e&&(0,U.jsx)(b.A,{severity:"error",sx:{mb:2},children:_e}),fe&&(0,U.jsxs)(U.Fragment,{children:[(0,U.jsxs)(o.A,{sx:{mt:4,mb:2},children:[(0,U.jsx)(u.A,{variant:"subtitle1",sx:{fontWeight:600,mb:1},children:"Resultado de la b\xfasqueda"}),(0,U.jsx)(j.A,{})]}),(0,U.jsx)(f.A,{sx:e=>({width:"100%",mb:3,overflowX:"auto",p:0,bgcolor:(0,M.X4)(e.palette.primary.main,"dark"===e.palette.mode?.12:.06),border:"1px solid ".concat((e.vars||e).palette.divider)}),children:ze?(0,U.jsx)(F.A,{message:"Cargando presupuestos..."}):Ce&&Array.isArray(Ce.content)&&Ce.content.length>0?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsxs)(y.A,{children:[(0,U.jsx)(C.A,{children:(0,U.jsxs)(l.A,{sx:V,children:[(0,U.jsx)(i.A,{sx:e=>(0,r.A)((0,r.A)({},K(e)),X(Ae).nombre),align:"left",children:(0,U.jsx)(te,{label:"Nombre",ghost:Cs.nombre})}),(0,U.jsx)(i.A,{sx:e=>(0,r.A)((0,r.A)({},K(e)),X(Ae).desde),align:"left",children:(0,U.jsx)(te,{label:"Desde",ghost:Cs.desde})}),(0,U.jsx)(i.A,{sx:e=>(0,r.A)((0,r.A)({},K(e)),X(Ae).hasta),align:"left",children:(0,U.jsx)(te,{label:"Hasta",ghost:Cs.hasta})}),"deleted"===Ae&&(0,U.jsx)(i.A,{sx:e=>(0,r.A)((0,r.A)({},K(e)),X(Ae).eliminado),align:"left",children:(0,U.jsx)(te,{label:"Eliminados",ghost:Cs.eliminado})}),(0,U.jsx)(i.A,{sx:e=>(0,r.A)((0,r.A)({},K(e)),X(Ae).acciones),align:"right",children:(0,U.jsxs)(o.A,{sx:{position:"relative",display:"inline-flex"},children:[(0,U.jsxs)(o.A,{"aria-hidden":!0,sx:{visibility:"hidden",pointerEvents:"none",display:"inline-flex",alignItems:"center",gap:1},children:[(0,U.jsx)(a.A,{variant:"outlined",size:"small",sx:ue,children:"Ver detalle"}),(0,U.jsx)(d.A,{size:"small",children:(0,U.jsx)(B.A,{fontSize:"small"})})]}),(0,U.jsx)(o.A,{sx:{position:"absolute",inset:0,display:"grid",placeItems:"center",whiteSpace:"nowrap",fontWeight:600},children:"Acciones"})]})})]})}),(0,U.jsx)(S.A,{children:bs(Ce.content)})]}),As>1&&(0,U.jsx)(o.A,{mt:2,display:"flex",justifyContent:"center",children:(0,U.jsx)(N.A,{color:"primary",size:"small",count:As,page:xs,onChange:(e,s)=>{if(!fe||!Ye.current)return;const t=Number(s)-1;Number.isNaN(t)||t<0||(we(t),rs(Ye.current,Ae,t))},siblingCount:0,boundaryCount:1,"aria-label":"Paginacion de resultados de presupuestos",getItemAriaLabel:(e,s)=>{switch(e){case"page":default:return"Ir a la pagina ".concat(s," de resultados");case"previous":return"Pagina anterior de resultados";case"next":return"Pagina siguiente de resultados"}}})})]}):!_e&&(0,U.jsx)(b.A,{severity:"info",children:"No encontramos presupuestos para el rango seleccionado."})})]}),(0,U.jsxs)(o.A,{sx:{mt:4,mb:2},children:[(0,U.jsx)(u.A,{variant:"subtitle1",sx:{fontWeight:600,mb:1},children:"Listado completo"}),(0,U.jsx)(j.A,{})]}),ke&&(0,U.jsx)(b.A,{severity:"error",sx:{mb:2},children:ke}),(0,U.jsx)(f.A,{sx:{width:"100%",overflowX:"auto"},children:Le?(0,U.jsx)(F.A,{message:"Cargando presupuestos..."}):(0,U.jsxs)(y.A,{children:[(0,U.jsx)(C.A,{children:(0,U.jsxs)(l.A,{sx:V,children:[(0,U.jsx)(i.A,{sx:e=>(0,r.A)((0,r.A)({},K(e)),X(Ae).nombre),align:"left",children:(0,U.jsx)(te,{label:"Nombre",ghost:ys.nombre})}),(0,U.jsx)(i.A,{sx:e=>(0,r.A)((0,r.A)({},K(e)),X(Ae).desde),align:"left",children:(0,U.jsx)(te,{label:"Desde",ghost:ys.desde})}),(0,U.jsx)(i.A,{sx:e=>(0,r.A)((0,r.A)({},K(e)),X(Ae).hasta),align:"left",children:(0,U.jsx)(te,{label:"Hasta",ghost:ys.hasta})}),"deleted"===Ae&&(0,U.jsx)(i.A,{sx:e=>(0,r.A)((0,r.A)({},K(e)),X(Ae).eliminado),align:"left",children:(0,U.jsx)(te,{label:"Eliminados",ghost:ys.eliminado})}),(0,U.jsx)(i.A,{sx:e=>(0,r.A)((0,r.A)({},K(e)),X(Ae).acciones),align:"right",children:(0,U.jsxs)(o.A,{sx:{position:"relative",display:"inline-flex"},children:[(0,U.jsxs)(o.A,{"aria-hidden":!0,sx:{visibility:"hidden",pointerEvents:"none",display:"inline-flex",alignItems:"center",gap:1},children:[(0,U.jsx)(a.A,{variant:"outlined",size:"small",sx:ue,children:"Ver detalle"}),(0,U.jsx)(d.A,{size:"small",children:(0,U.jsx)(B.A,{fontSize:"small"})})]}),(0,U.jsx)(o.A,{sx:{position:"absolute",inset:0,display:"grid",placeItems:"center",whiteSpace:"nowrap",fontWeight:600},children:"Acciones"})]})})]})}),(0,U.jsxs)(S.A,{children:[vs.length>0&&bs(vs),0===vs.length&&!ke&&(0,U.jsx)(l.A,{children:(0,U.jsx)(i.A,{colSpan:ps,sx:e=>(0,r.A)((0,r.A)({},q(e)),{},{textAlign:"center",py:3}),children:"No hay presupuestos para mostrar."})}),ke&&(0,U.jsx)(l.A,{children:(0,U.jsx)(i.A,{colSpan:ps,sx:e=>(0,r.A)((0,r.A)({},q(e)),{},{textAlign:"center",py:3}),children:(0,U.jsx)(b.A,{severity:"error",children:ke})})})]})]})}),hs>1&&(0,U.jsx)(o.A,{mt:2,display:"flex",justifyContent:"center",children:(0,U.jsx)(N.A,{color:"primary",size:"small",count:hs,page:ms,onChange:(e,s)=>{const t=Number(s)-1;Number.isNaN(t)||t<0||ge(t)},siblingCount:0,boundaryCount:1,"aria-label":"Paginacion de presupuestos",getItemAriaLabel:(e,s)=>{switch(e){case"page":default:return"Ir a la pagina ".concat(s," de presupuestos");case"previous":return"Pagina anterior de presupuestos";case"next":return"Pagina siguiente de presupuestos"}}})}),(0,U.jsx)(o.A,{mt:3,children:(0,U.jsx)(a.A,{variant:"contained",onClick:()=>pe("/presupuestos/nuevo"),children:"Crear nuevo presupuesto"})}),(0,U.jsx)(w.A,{id:"presupuesto-actions-menu",anchorEl:qe.anchorEl,open:Boolean(qe.anchorEl),onClose:os,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},keepMounted:!0,MenuListProps:{"aria-labelledby":qe.presupuesto?"acciones-presupuesto-".concat(qe.presupuesto.id):void 0},children:(0,U.jsxs)(v.A,{onClick:()=>{const e=qe.presupuesto;os(),e&&(e=>{Ve(null),We({open:!0,presupuesto:e})})(e)},disabled:!qe.presupuesto,children:[(0,U.jsx)(L.A,{fontSize:"small",sx:{mr:1}})," Eliminar"]})}),(0,U.jsxs)(P.A,{open:Ue.open,onClose:()=>{Fe||as()},disableEscapeKeyDown:Boolean(Fe),maxWidth:"xs",fullWidth:!0,children:[(0,U.jsx)(E.A,{children:"Eliminar presupuesto"}),(0,U.jsx)(T.A,{dividers:!0,children:(0,U.jsx)(u.A,{variant:"body2",children:'Vas a eliminar el presupuesto "'.concat((null===(ae=Ue.presupuesto)||void 0===ae?void 0:ae.nombre)||"",'". Podr\xe1s restaurarlo desde la Papelera durante ').concat(me," d\xedas.")})}),(0,U.jsxs)(R.A,{children:[(0,U.jsx)(a.A,{onClick:as,disabled:ds,children:"Cancelar"}),(0,U.jsx)(a.A,{color:"error",variant:"contained",onClick:async()=>{const e=Ue.presupuesto;if(e){if(Fe!==e.id){Ve(e.id);try{await O.A.delete("".concat(he,"/api/presupuestos/").concat(e.id)),Ze.current=e,await ns(Ae,ve),fe&&Ye.current&&await rs(Ye.current,Ae,Ne),He({open:!0,message:"Presupuesto eliminado.",action:(0,U.jsx)(a.A,{color:"secondary",size:"small",onClick:()=>cs(),children:"Deshacer"})}),Me("")}catch(s){console.error("Error eliminando presupuesto:",s),He({open:!0,message:"No se pudo eliminar el presupuesto.",action:null})}finally{Ve(null),as()}}}else as()},disabled:ds,startIcon:ds?(0,U.jsx)(_.A,{size:16,color:"inherit"}):null,children:ds?"Eliminando...":"Eliminar"})]})]}),(0,U.jsx)(I.A,{open:Be.open,autoHideDuration:6e3,onClose:(e,s)=>{"clickaway"!==s&&He(e=>(0,r.A)((0,r.A)({},e),{},{open:!1}))},message:Be.message,action:Be.action,anchorOrigin:{vertical:"bottom",horizontal:"center"}})]})}function re(e){return(0,U.jsx)(U.Fragment,{children:(0,U.jsx)(ne,{})})}},88746:(e,s,t)=>{t.d(s,{A:()=>o});var n=t(14057),r=t(70579);const o=(0,n.A)((0,r.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM8 9h8v10H8zm7.5-5-1-1h-5l-1 1H5v2h14V4z"}),"DeleteOutline")}}]);
//# sourceMappingURL=3381.4639e871.chunk.js.map