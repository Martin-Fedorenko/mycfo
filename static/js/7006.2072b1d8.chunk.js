"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[7006],{20475:(e,t,s)=>{s.d(t,{F5:()=>n,vu:()=>l,vv:()=>r});const o=new Intl.NumberFormat("es-AR",{minimumFractionDigits:0,maximumFractionDigits:2}),r=function(e){let{allowEmpty:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(""===e||null===e||"undefined"===typeof e)return t?"":"$ 0";const s=Number(e);if(Number.isNaN(s))return t?"":"$ 0";return"".concat(s<0?"-":"","$ ").concat(o.format(Math.abs(s)))},n=e=>r(e,{allowEmpty:!0}),l=function(e){let{returnEmpty:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null==e)return t?"":0;const s=e.toString().trim();if(!s)return t?"":0;const o=s.replace(/\s+/g,"").replace(/\$/g,""),r=o.startsWith("-"),n=o.replace(/[^0-9,.-]/g,"");if(!n||"-"===n)return t?"":0;const l=n.replace(/-/g,"").replace(/\./g,"").replace(",","."),a=Number(l);return Number.isNaN(a)?t?"":0:r?-a:a}},34955:(e,t,s)=>{s.d(t,{A:()=>x});var o=s(89379),r=(s(65043),s(53969)),n=s(26529),l=s(56647),a=s(74917),i=s(36252),c=s(70579);const d="#FDE4E3",u="#FACDCA",h="#E5F4E5",m="#CAE7CB";function x(e){let{onExportPdf:t,onExportExcel:s,sx:x={}}=e;return(0,c.jsxs)(r.A,{sx:(0,o.A)({display:"flex",gap:1},x),children:[(0,c.jsx)(n.A,{title:"Exportar PDF",children:(0,c.jsx)(l.A,{onClick:t,size:"small",color:"error",sx:e=>{const t={bgcolor:"".concat(u," !important"),backgroundColor:"".concat(u," !important"),borderColor:"#d32f2f","& .MuiSvgIcon-root":{color:"#000 !important"}};return(0,o.A)({border:"1px solid",borderColor:"#d32f2f",bgcolor:"".concat(d," !important"),backgroundColor:"".concat(d," !important"),"& .MuiSvgIcon-root":{color:"#000 !important"},"&:hover":t,width:36,height:36},e.applyStyles("dark",{borderColor:"#d32f2f","&:hover":t}))},"aria-label":"Exportar PDF",children:(0,c.jsx)(a.A,{fontSize:"small"})})}),(0,c.jsx)(n.A,{title:"Exportar Excel",children:(0,c.jsxs)(l.A,{onClick:s,size:"small",color:"success",sx:e=>{const t={bgcolor:"".concat(m," !important"),backgroundColor:"".concat(m," !important"),borderColor:"#2e7d32","& .MuiSvgIcon-root":{color:"#000 !important"}};return(0,o.A)({border:"1px solid",borderColor:"#2e7d32",bgcolor:"".concat(h," !important"),backgroundColor:"".concat(h," !important"),"& .MuiSvgIcon-root":{color:"#000 !important"},"&:hover":t,width:36,height:36},e.applyStyles("dark",{borderColor:"#2e7d32","&:hover":t}))},"aria-label":"Exportar Excel",children:[(0,c.jsx)(i.A,{fontSize:"small"})," "]})})]})}},38915:(e,t,s)=>{s.d(t,{A:()=>v});var o=s(79722),r=s(35644),n=s(29296),l=s(13658);const a=o.A.create(),i=l.A.PRONOSTICO,c={UserPoolId:"sa-east-1_lTMNrWW7R",ClientId:"3ksssqtg3r49rf6js1t1177hrd"};let d=null,u=!1;const h=e=>Boolean(e&&i&&String(e).startsWith(String(i))),m=e=>{try{return sessionStorage.getItem(e)}catch(t){return console.warn("No se pudo leer sessionStorage:",t),null}},x=(e,t)=>{try{void 0!==t&&null!==t&&sessionStorage.setItem(e,t)}catch(s){console.warn("No se pudo escribir en sessionStorage:",s)}},g=()=>{if(!u){u=!0;try{sessionStorage.clear()}catch(e){}null!==n.m&&void 0!==n.m&&n.m.limpiarSesion&&n.m.limpiarSesion(),"undefined"!==typeof window&&(window.location.href="/#/signin")}},p=()=>{const e=m("refreshToken"),t=(()=>{const e=m("email")||m("username");if(!e||!c.UserPoolId||!c.ClientId)return null;const t=new r.NE(c);return new r.TU({Username:e,Pool:t})})();if(!e||!t)return Promise.reject(new Error("No hay datos para renovar la sesi\xf3n."));const s=new r.c9({RefreshToken:e});return new Promise((e,o)=>{t.refreshSession(s,(t,s)=>{if(t)return void o(t);const r=s.getAccessToken().getJwtToken(),n=s.getIdToken().getJwtToken(),l=s.getRefreshToken().getToken();x("accessToken",r),x("idToken",n),l&&x("refreshToken",l),e(r)})})};a.interceptors.request.use(e=>{const t=sessionStorage.getItem("accessToken");if(h(e.url)){var s;e.headers=null!==(s=e.headers)&&void 0!==s?s:{},t&&(e.headers.Authorization="Bearer ".concat(t));const o=sessionStorage.getItem("sub");o&&(e.headers["X-Usuario-Sub"]=o)}return e}),a.interceptors.response.use(e=>e,async e=>{const{config:t,response:s}=e;if(!t||!s||401!==s.status||!h(t.url))return Promise.reject(e);if(t.__isRetryRequest)return g(),Promise.reject(e);try{var o;const e=await(d||(d=p().then(e=>(d=null,e)).catch(e=>{throw d=null,e})),d);if(!e)throw new Error("No se obtuvo un token renovado.");return t.__isRetryRequest=!0,t.headers=null!==(o=t.headers)&&void 0!==o?o:{},t.headers.Authorization="Bearer ".concat(e),a(t)}catch(r){return g(),Promise.reject(r)}});const v=a},47006:(e,t,s)=>{s.r(t),s.d(t,{default:()=>ye});var o=s(89379),r=s(65043),n=s(53969),l=s(55895),a=s(76943),i=s(26687),c=s(70298),d=s(26529),u=s(56647),h=s(46471),m=s(45847),x=s(85030),g=s(24343),p=s(53089),v=s(94799),A=s(17873),j=s(76072),b=s(94527),f=s(87443),y=s(10756),E=s(86172),w=s(81341),R=s(34375),C=s(12097),M=s(2990),S=s(95315),k=s(82394),I=s(66185),N=s(60267),D=s(29001),T=s(34955),F=s(38915),P=s(20475),z=s(69516),W=s(92275),_=s(37426),O=s(39119);function B(e,t){var s;const o=(0,O.a)(e.start),r=(0,O.a)(e.end);let n=+o>+r;const l=n?+o:+r,a=n?r:o;a.setHours(0,0,0,0),a.setDate(1);let i=null!==(s=null===t||void 0===t?void 0:t.step)&&void 0!==s?s:1;if(!i)return[];i<0&&(i=-i,n=!n);const c=[];for(;+a<=l;)c.push((0,O.a)(a)),a.setMonth(a.getMonth()+i);return n?c.reverse():c}var K=s(47436),H=s(50108),U=s(82291),q=s(52185),V=s(6026),L=s(80379),G=s(66163),J=s(75748),$=s(35963),X=s(28791),Z=s(73243),Q=s(70095),Y=s(14057),ee=s(70579);const te=(0,Y.A)((0,ee.jsx)("path",{d:"M7 6h10l-5.01 6.3zm-2.75-.39C6.27 8.2 10 13 10 13v6c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-6s3.72-4.8 5.74-7.39c.51-.66.04-1.61-.79-1.61H5.04c-.83 0-1.3.95-.79 1.61"}),"FilterAltOutlined"),se=(0,Y.A)((0,ee.jsx)("path",{d:"M16.54 11 13 7.46l1.41-1.41 2.12 2.12 4.24-4.24 1.41 1.41zM11 7H2v2h9zm10 6.41L19.59 12 17 14.59 14.41 12 13 13.41 15.59 16 13 18.59 14.41 20 17 17.41 19.59 20 21 18.59 18.41 16zM11 15H2v2h9z"}),"RuleOutlined"),oe=(0,Y.A)((0,ee.jsx)("path",{d:"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.25 2.52.77-1.28-3.52-2.09V8z"}),"HistoryOutlined"),re=(0,Y.A)((0,ee.jsx)("path",{d:"M19.43 12.98c.04-.32.07-.64.07-.98s-.03-.66-.07-.98l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46c-.09-.16-.26-.25-.44-.25-.06 0-.12.01-.17.03l-2.49 1c-.52-.4-1.08-.73-1.69-.98l-.38-2.65C14.46 2.18 14.25 2 14 2h-4c-.25 0-.46.18-.49.42l-.38 2.65c-.61.25-1.17.59-1.69.98l-2.49-1q-.09-.03-.18-.03c-.17 0-.34.09-.43.25l-2 3.46c-.13.22-.07.49.12.64l2.11 1.65c-.04.32-.07.65-.07.98s.03.66.07.98l-2.11 1.65c-.19.15-.24.42-.12.64l2 3.46c.09.16.26.25.44.25.06 0 .12-.01.17-.03l2.49-1c.52.4 1.08.73 1.69.98l.38 2.65c.03.24.24.42.49.42h4c.25 0 .46-.18.49-.42l.38-2.65c.61-.25 1.17-.59 1.69-.98l2.49 1q.09.03.18.03c.17 0 .34-.09.43-.25l2-3.46c.12-.22.07-.49-.12-.64zm-1.98-1.71c.04.31.05.52.05.73s-.02.43-.05.73l-.14 1.13.89.7 1.08.84-.7 1.21-1.27-.51-1.04-.42-.9.68c-.43.32-.84.56-1.25.73l-1.06.43-.16 1.13-.2 1.35h-1.4l-.19-1.35-.16-1.13-1.06-.43c-.43-.18-.83-.41-1.23-.71l-.91-.7-1.06.43-1.27.51-.7-1.21 1.08-.84.89-.7-.14-1.13c-.03-.31-.05-.54-.05-.74s.02-.43.05-.73l.14-1.13-.89-.7-1.08-.84.7-1.21 1.27.51 1.04.42.9-.68c.43-.32.84-.56 1.25-.73l1.06-.43.16-1.13.2-1.35h1.39l.19 1.35.16 1.13 1.06.43c.43.18.83.41 1.23.71l.91.7 1.06-.43 1.27-.51.7 1.21-1.07.85-.89.7zM12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m0 6c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2"}),"SettingsOutlined");var ne=s(27421),le=s(73456),ae=s(13658);const ie=e=>"number"===typeof e?e:null==e||isNaN(Number(e))?0:Number(e),ce="#a5d6a7",de="#4caf50",ue="#ef9a9a",he="#f44336",me="#4caf50",xe="#f44336",ge={fontWeight:500,bgcolor:"#FFDE70",backgroundColor:"#FFDE70",color:"#000",border:"1px solid #F5C16C","& .MuiChip-label":{color:"#000"},"& .MuiChip-icon":{color:"#000"},"&.MuiChip-filled":{backgroundColor:"#FFDE70"}},pe=e=>({borderCollapse:"collapse",border:"1px solid ".concat((e.vars||e).palette.divider)}),ve=e=>({border:"1px solid ".concat((e.vars||e).palette.divider),padding:"12px"}),Ae=e=>(0,o.A)((0,o.A)({},ve(e)),{},{fontWeight:700}),je=e=>["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"][parseInt(e,10)-1]||e;const be=e=>{if(!e||"string"!==typeof e)return null;const[t,s,o]=e.split("-"),r=Number(t),n=Number(s),l=Number(o);if(!Number.isFinite(r)||!Number.isFinite(n)||!Number.isFinite(l))return null;const a=new Date(r,n-1,l);return(e=>e instanceof Date&&!Number.isNaN(e.getTime()))(a)?a:null};async function fe(e,t){const s={};for(const r of e){const e=(0,z.GP)((0,W.w)(r),"yyyy-MM-dd"),n=(0,z.GP)((0,_.p)(r),"yyyy-MM-dd"),l=(0,z.GP)(r,"yyyy-MM");try{const o=await(0,K.F)({fechaDesde:e,fechaHasta:n,tipos:t}),r=(Array.isArray(null===o||void 0===o?void 0:o.content)?o.content:Array.isArray(o)?o:[]).reduce((e,t)=>{var s,o;const r=Math.abs(Number(null!==(s=null!==(o=null===t||void 0===t?void 0:t.monto)&&void 0!==o?o:null===t||void 0===t?void 0:t.montoTotal)&&void 0!==s?s:0));return Number.isFinite(r)?e+r:e},0);s[l]=r}catch(o){console.error("Error al obtener movimientos del mes ".concat(l," (").concat(t,"):"),o),s[l]=0}}return s}function ye(){var e,t,z,O,K,Y;const{nombre:ye}=(0,D.g)(),Ee=(0,D.Zp)(),we=(0,N.A)(),Re="light"===we.palette.mode,Ce=null!==(e=null===(t=we.vars)||void 0===t?void 0:t.palette)&&void 0!==e?e:we.palette,Me=r.useMemo(()=>({ingresos:Re?"hsl(120, 44%, 53%)":Ce.success.light,egresos:Re?"hsl(0, 90%, 40%)":Ce.error.light,resultadoPos:Re?"hsl(210, 98%, 42%)":Ce.info.light,resultadoNeg:Re?"hsl(45, 90%, 40%)":Ce.warning.light}),[Re,Ce.error.light,Ce.info.light,Ce.success.light,Ce.warning.light]),Se=Re?null!==(z=null===(O=Ce.text)||void 0===O?void 0:O.primary)&&void 0!==z?z:"#000":null!==(K=null===(Y=Ce.common)||void 0===Y?void 0:Y.white)&&void 0!==K?K:"#fff",[ke,Ie]=r.useState({id:null,nombre:"",detalleMensual:[]}),[Ne,De]=r.useState(!0),[Te,Fe]=r.useState(null),[Pe,ze]=r.useState(0),[We,_e]=r.useState(!1),[Oe,Be]=r.useState(!1),[Ke,He]=r.useState(0),[Ue,qe]=r.useState(null),[Ve,Le]=r.useState(!1),[Ge,Je]=r.useState("Ingresos");r.useEffect(()=>{ye&&(async()=>{try{De(!0),Fe(null);const r=await F.A.get("".concat(ae.A.PRONOSTICO,"/api/presupuestos")),n=null===r||void 0===r?void 0:r.data;let l=[];Array.isArray(n)?l=n:Array.isArray(null===n||void 0===n?void 0:n.content)&&(l=n.content);const a=decodeURIComponent(ye||"").trim().toLowerCase().replace(/\s+/g,"-"),i=l.find(e=>((null===e||void 0===e?void 0:e.nombre)||"").trim().toLowerCase().replace(/\s+/g,"-")===a);if(null===i||void 0===i||!i.id)return Ie({id:null,nombre:"No encontrado",detalleMensual:[]}),void De(!1);let c=i.nombre;try{var e;const t=await F.A.get("".concat(ae.A.PRONOSTICO,"/api/presupuestos/").concat(i.id));null!==t&&void 0!==t&&null!==(e=t.data)&&void 0!==e&&e.nombre&&(c=t.data.nombre)}catch(t){}const d=await F.A.get("".concat(ae.A.PRONOSTICO,"/api/presupuestos/").concat(i.id,"/totales")),u=(Array.isArray(d.data)?d.data:[]).map((e,t)=>{const s=ie(e.ingresoEstimado),o=ie(e.egresoEstimado);return{id:t+1,mes:e.mes,ingresoEst:s,ingresoReal:0,egresoEst:o,egresoReal:0,totalEst:s-o,totalReal:0}});let h={},m={};try{const e=u.map(e=>{const t=((null===e||void 0===e?void 0:e.mes)||"").slice(0,7);return t?be("".concat(t,"-01")):null}).filter(Boolean);if(e.length>0){const t=Math.min(...e.map(e=>e.getTime())),s=Math.max(...e.map(e=>e.getTime())),o=(0,W.w)(new Date(t)),r=B({start:o,end:(0,_.p)(new Date(s))}),[n,l]=await Promise.all([fe(r,"Egreso"),fe(r,"Ingreso")]);m=n,h=l}}catch(s){console.error("Error al obtener datos reales del presupuesto:",s),Fe(e=>null!==e&&void 0!==e?e:"No se pudieron cargar los datos reales del presupuesto.")}const x=u.map(e=>{const t=((null===e||void 0===e?void 0:e.mes)||"").slice(0,7),s=ie(m[t]||0),r=ie(h[t]||0);return(0,o.A)((0,o.A)({},e),{},{ingresoReal:r,egresoReal:s,totalReal:r-s})});Ie({id:i.id,nombre:c,detalleMensual:x})}catch(Te){console.error("Error al cargar presupuesto:",Te),Fe("Error al cargar el presupuesto"),Ie({id:null,nombre:"Error",detalleMensual:[]})}finally{De(!1)}})()},[ye]);const $e=Array.isArray(ke.detalleMensual)?ke.detalleMensual.filter(e=>!(null===e||void 0===e||!e.mes)):[],Xe=r.useMemo(()=>{let e=[...$e];if(e=e.map(e=>{var t,s;const r=ie(null!==(t=e.totalEst)&&void 0!==t?t:ie(e.ingresoEst)-ie(e.egresoEst)),n=ie(null!==(s=e.totalReal)&&void 0!==s?s:ie(e.ingresoReal)-ie(e.egresoReal)),l=(n-r)/(Math.abs(r)>0?Math.abs(r):1),a=n<0;return(0,o.A)((0,o.A)({},e),{},{_estTotal:r,_realTotal:n,_pctDesvio:l,_deficit:a})}),We&&(e=e.filter(e=>e._realTotal<0)),Number.isFinite(Ke)&&Ke>0){const t=Ke/100;e=e.filter(e=>Math.abs(e._pctDesvio)>=t||!Number.isFinite(e._pctDesvio))}return e},[$e,We,Ke]),Ze=$e.reduce((e,t)=>e+ie(t.ingresoEst),0),Qe=$e.reduce((e,t)=>e+ie(t.ingresoReal),0),Ye=$e.reduce((e,t)=>e+ie(t.egresoEst),0),et=$e.reduce((e,t)=>e+ie(t.egresoReal),0),tt=Qe-et,st=Ze-Ye,ot=(()=>{const e=Math.abs(st)>0?Math.abs(st):1;return Math.max(0,Math.min(1.2,tt/e))})(),rt=(nt=ot)>=.95?{label:"Salud: Verde",color:"success"}:nt>=.8?{label:"Salud: Amarillo",color:"warning"}:{label:"Salud: Rojo",color:"error"};var nt;const lt=Xe.map(e=>{const t=((null===e||void 0===e?void 0:e.mes)||"0000-01").split("-")[1];return{mes:je(t),estimado:ie(e.ingresoEst),real:ie(e.ingresoReal)}}),at=Xe.map(e=>{const t=((null===e||void 0===e?void 0:e.mes)||"0000-01").split("-")[1];return{mes:je(t),estimado:ie(e.egresoEst),real:ie(e.egresoReal)}}),it=Xe.map(e=>{var t;const s=ie(null!==(t=e.totalReal)&&void 0!==t?t:ie(e.ingresoReal)-ie(e.egresoReal)),o=((null===e||void 0===e?void 0:e.mes)||"0000-01").split("-")[1];return{mes:je(o),superavit:s,fill:s>=0?me:xe}}),ct=e=>{if(null===e||void 0===e||!e.mes)return void alert("Mes no v\xe1lido");const t=encodeURIComponent((ke.nombre||"").trim().toLowerCase().replace(/\s+/g,"-")),s=(e.mes||"0000-01").split("-"),o=parseInt(s[1]||"1",10),r=new Intl.DateTimeFormat("es-ES",{month:"long"}).format(new Date(2025,(o||1)-1));Ee("/presupuestos/".concat(t,"/detalle/").concat(r))},dt=r.useMemo(()=>$e.map(e=>{var t,s;const r=ie(null!==(t=e.totalEst)&&void 0!==t?t:ie(e.ingresoEst)-ie(e.egresoEst)),n=ie(null!==(s=e.totalReal)&&void 0!==s?s:ie(e.ingresoReal)-ie(e.egresoReal))-r;return(0,o.A)((0,o.A)({},e),{},{_delta:n,_absDelta:Math.abs(n)})}).sort((e,t)=>t._absDelta-e._absDelta),[$e]),ut=Boolean(Ue);return(0,ee.jsxs)(n.A,{id:"presupuesto-detalle-content",sx:{width:"100%",p:3},children:[(0,ee.jsxs)(l.A,{variant:"h4",gutterBottom:!0,fontWeight:"600",children:["Detalle de ",ke.nombre]}),(0,ee.jsx)(l.A,{variant:"subtitle1",gutterBottom:!0,sx:{color:"text.primary"},children:"Compar\xe1 tu planificaci\xf3n con lo real"}),(0,ee.jsxs)(n.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,mt:1,gap:1,flexWrap:"wrap"},children:[(0,ee.jsxs)(a.A,{value:Pe,onChange:(e,t)=>ze(t),indicatorColor:"primary",children:[(0,ee.jsx)(i.A,{label:"Resumen",sx:{color:Se,"&.Mui-selected":{color:Se},"& .MuiTab-wrapper":{color:Se}}}),(0,ee.jsx)(i.A,{label:"Datos brutos",sx:{color:Se,"&.Mui-selected":{color:Se},"& .MuiTab-wrapper":{color:Se}}})]}),(0,ee.jsxs)(c.A,{direction:"row",spacing:1,alignItems:"center",children:[(0,ee.jsx)(d.A,{title:"Filtros",children:(0,ee.jsx)(u.A,{onClick:e=>qe(e.currentTarget),children:(0,ee.jsx)(te,{})})}),(0,ee.jsx)(T.A,{onExportPdf:()=>{Promise.all([s.e(1389),s.e(74)]).then(s.t.bind(s,90074,23)).then(e=>{const t=document.getElementById("presupuesto-detalle-content"),s={margin:.5,filename:"Presupuesto_".concat(ke.nombre||"","_").concat(ke.id||"",".pdf"),image:{type:"jpeg",quality:.95},html2canvas:{scale:2},jsPDF:{unit:"in",format:"letter",orientation:"landscape"}};e.default().from(t).set(s).save()})},onExportExcel:()=>{const e=[["Mes","Ingreso Estimado","Ingreso Real","Desv\xedo Ingresos","Egreso Estimado","Egreso Real","Desv\xedo Egresos","Total Estimado","Total Real","Total Desv\xedo"],...$e.map(e=>{var t;return[null!==(t=e.mes)&&void 0!==t?t:"\u2014",ie(e.ingresoEst),ie(e.ingresoReal),ie(e.ingresoReal)-ie(e.ingresoEst),ie(e.egresoEst),ie(e.egresoReal),ie(e.egresoReal)-ie(e.egresoEst),ie(e.totalEst),ie(e.totalReal),ie(e.totalReal)-ie(e.totalEst)]})];e.push(["","","","","","","","","",""]),e.push(["Totales:","","","","","","","","",""]),e.push(["",Ze,Qe,Qe-Ze,Ye,et,et-Ye,st,tt,tt-st]),Promise.all([s.e(1652),s.e(2514)]).then(s.t.bind(s,81652,23)).then(t=>{let{utils:s,writeFile:o}=t;const r=s.aoa_to_sheet(e,{cellStyles:!0}),n=s.book_new();s.book_append_sheet(n,r,"Detalle Presupuesto"),o(n,"Presupuesto_".concat(ke.nombre||"","_").concat(ke.id||"",".xlsx"),{cellStyles:!0})})}})]})]}),(0,ee.jsx)(h.A,{anchorEl:Ue,open:ut,onClose:()=>qe(null),children:(0,ee.jsx)(n.A,{sx:{p:2,width:280},children:(0,ee.jsxs)(c.A,{spacing:1.5,children:[(0,ee.jsx)(m.A,{control:(0,ee.jsx)(x.A,{checked:We,onChange:(e,t)=>_e(t)}),label:"Ver solo meses con d\xe9ficit"}),(0,ee.jsx)(m.A,{control:(0,ee.jsx)(x.A,{checked:Oe,onChange:(e,t)=>Be(t)}),label:"Mostrar foco en estimados (oculta \u2018Real\u2019 en gr\xe1ficas)"}),(0,ee.jsx)(g.A,{label:"Umbral de desv\xedo (%)",type:"number",size:"small",value:Ke,onChange:e=>He(Math.max(0,Number(e.target.value)))})]})})}),0===Pe&&(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsxs)(p.A,{container:!0,spacing:2,mb:2,children:[(0,ee.jsx)(p.A,{item:!0,xs:12,sm:6,md:3,children:(0,ee.jsxs)(v.A,{sx:{p:3,textAlign:"center",bgcolor:Me.ingresos,color:"white",position:"relative",height:"100%"},children:[(0,ee.jsx)(A.A,{sx:{width:56,height:56,bgcolor:"white",color:"success.main",mx:"auto",mb:1},children:"+"}),(0,ee.jsx)(l.A,{variant:"h6",children:"Ingresos"}),(0,ee.jsx)(l.A,{variant:"body2",sx:{display:"block",color:"rgba(255,255,255,0.9)"},children:"Real acumulado"}),(0,ee.jsx)(l.A,{variant:"h4",fontWeight:"bold",children:(0,P.vv)(Qe)}),(0,ee.jsxs)(l.A,{variant:"body2",sx:{color:"rgba(255,255,255,0.9)"},children:["Estimado: ",(0,P.vv)(Ze)]}),(0,ee.jsx)(d.A,{title:"Ver meses con mayor desv\xedo en ingresos",children:(0,ee.jsx)(u.A,{size:"small",onClick:()=>Le(!0)||Je("Ingresos"),sx:{position:"absolute",top:8,right:8,bgcolor:"rgba(255,255,255,0.9)"},children:(0,ee.jsx)(se,{fontSize:"small"})})})]})}),(0,ee.jsx)(p.A,{item:!0,xs:12,sm:6,md:3,children:(0,ee.jsxs)(v.A,{sx:{p:3,textAlign:"center",bgcolor:Me.egresos,color:"white",position:"relative",height:"100%"},children:[(0,ee.jsx)(A.A,{sx:{width:56,height:56,bgcolor:"white",color:"error.main",mx:"auto",mb:1},children:"-"}),(0,ee.jsx)(l.A,{variant:"h6",children:"Egresos"}),(0,ee.jsx)(l.A,{variant:"body2",sx:{display:"block",color:"rgba(255,255,255,0.9)"},children:"Real acumulado"}),(0,ee.jsx)(l.A,{variant:"h4",fontWeight:"bold",children:(0,P.vv)(et)}),(0,ee.jsxs)(l.A,{variant:"body2",sx:{color:"rgba(255,255,255,0.9)"},children:["Estimado: ",(0,P.vv)(Ye)]}),(0,ee.jsx)(d.A,{title:"Ver meses con mayor desv\xedo en egresos",children:(0,ee.jsx)(u.A,{size:"small",onClick:()=>Le(!0)||Je("egresos"),sx:{position:"absolute",top:8,right:8,bgcolor:"rgba(255,255,255,0.9)"},children:(0,ee.jsx)(re,{fontSize:"small"})})})]})}),(0,ee.jsx)(p.A,{item:!0,xs:12,sm:6,md:3,children:(0,ee.jsxs)(v.A,{sx:{p:3,textAlign:"center",bgcolor:tt>=0?Me.resultadoPos:Me.resultadoNeg,color:"white",position:"relative",height:"100%"},children:[(0,ee.jsx)(A.A,{sx:{width:56,height:56,bgcolor:"white",color:tt>=0?"info.main":"warning.main",mx:"auto",mb:1},children:tt>=0?"\u2713":"\u26a0"}),(0,ee.jsx)(l.A,{variant:"h6",children:"Resultado"}),(0,ee.jsx)(l.A,{variant:"h4",fontWeight:"bold",children:(0,P.vv)(tt)}),(0,ee.jsx)(l.A,{variant:"body2",children:tt>=0?"Super\xe1vit":"D\xe9ficit"}),(0,ee.jsx)(d.A,{title:"Ver meses ordenados por impacto en resultado",children:(0,ee.jsx)(u.A,{size:"small",onClick:()=>Le(!0)||Je("resultado"),sx:{position:"absolute",top:8,right:8,bgcolor:"rgba(255,255,255,0.9)"},children:(0,ee.jsx)(oe,{fontSize:"small"})})})]})}),(0,ee.jsx)(p.A,{item:!0,xs:12,sm:6,md:3,children:(0,ee.jsxs)(v.A,{sx:{p:3,textAlign:"center"},children:[(0,ee.jsx)(l.A,{variant:"overline",children:"Marcador de salud"}),(0,ee.jsxs)(c.A,{alignItems:"center",spacing:1,children:[(0,ee.jsx)(j.A,{label:"".concat(rt.label),color:rt.color}),(0,ee.jsxs)(l.A,{variant:"body2",color:"text.secondary",children:["Cumplimiento: ",(100*ot).toFixed(0),"%"]})]})]})})]}),(0,ee.jsx)(b.A,{sx:{mb:2}}),(0,ee.jsxs)(v.A,{sx:{p:3,mb:3},children:[(0,ee.jsxs)(c.A,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[(0,ee.jsx)(l.A,{variant:"h6",fontWeight:"600",children:"Ingresos: Estimado vs Real"}),(0,ee.jsx)(j.A,{size:"small",label:Oe?"Foco: Estimados":"Todos"})]}),(0,ee.jsx)(n.A,{sx:{mt:2},children:lt.map((e,t)=>{const s=1.2*Math.max(e.estimado,e.real)||1,o=Xe[t];return(0,ee.jsxs)(n.A,{sx:{mb:3},children:[(0,ee.jsx)(l.A,{variant:"subtitle1",fontWeight:"600",gutterBottom:!0,children:e.mes}),(0,ee.jsxs)(n.A,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,ee.jsxs)(n.A,{sx:{display:"flex",alignItems:"center",gap:2,cursor:"pointer"},onClick:()=>o&&ct(o),children:[(0,ee.jsx)(l.A,{variant:"body2",sx:{minWidth:80},children:"Estimado:"}),(0,ee.jsx)(n.A,{sx:{flex:1,height:30},children:(0,ee.jsx)(H.u,{width:"100%",height:30,children:(0,ee.jsxs)(U.E,{data:[{name:e.mes,valor:e.estimado}],layout:"vertical",children:[(0,ee.jsx)(q.W,{type:"number",domain:[0,s],hide:!0}),(0,ee.jsx)(V.h,{type:"category",dataKey:"name",hide:!0}),(0,ee.jsx)(L.m,{formatter:e=>[(0,P.vv)(e),""]}),(0,ee.jsx)(G.y,{dataKey:"valor",fill:ce,radius:[4,4,4,4],label:{position:"right",formatter:e=>(0,P.vv)(e)}})]})})})]}),!Oe&&(0,ee.jsxs)(n.A,{sx:{display:"flex",alignItems:"center",gap:2,cursor:"pointer"},onClick:()=>o&&ct(o),children:[(0,ee.jsx)(l.A,{variant:"body2",sx:{minWidth:80},children:"Real:"}),(0,ee.jsx)(n.A,{sx:{flex:1,height:30},children:(0,ee.jsx)(H.u,{width:"100%",height:30,children:(0,ee.jsxs)(U.E,{data:[{name:e.mes,valor:e.real}],layout:"vertical",children:[(0,ee.jsx)(q.W,{type:"number",domain:[0,s],hide:!0}),(0,ee.jsx)(V.h,{type:"category",dataKey:"name",hide:!0}),(0,ee.jsx)(L.m,{formatter:e=>[(0,P.vv)(e),""]}),(0,ee.jsx)(G.y,{dataKey:"valor",fill:de,radius:[4,4,4,4],label:{position:"right",formatter:e=>(0,P.vv)(e)}})]})})})]})]})]},"".concat(e.mes,"-").concat(t))})})]}),(0,ee.jsxs)(v.A,{sx:{p:3,mb:3},children:[(0,ee.jsx)(l.A,{variant:"h6",gutterBottom:!0,fontWeight:"600",children:"Egresos: Estimado vs Real"}),(0,ee.jsx)(n.A,{sx:{mt:2},children:at.map((e,t)=>{const s=1.2*Math.max(e.estimado,e.real)||1,o=Xe[t];return(0,ee.jsxs)(n.A,{sx:{mb:3},children:[(0,ee.jsx)(l.A,{variant:"subtitle1",fontWeight:"600",gutterBottom:!0,children:e.mes}),(0,ee.jsxs)(n.A,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,ee.jsxs)(n.A,{sx:{display:"flex",alignItems:"center",gap:2,cursor:"pointer"},onClick:()=>o&&ct(o),children:[(0,ee.jsx)(l.A,{variant:"body2",sx:{minWidth:80},children:"Estimado:"}),(0,ee.jsx)(n.A,{sx:{flex:1,height:30},children:(0,ee.jsx)(H.u,{width:"100%",height:30,children:(0,ee.jsxs)(U.E,{data:[{name:e.mes,valor:e.estimado}],layout:"vertical",children:[(0,ee.jsx)(q.W,{type:"number",domain:[0,s],hide:!0}),(0,ee.jsx)(V.h,{type:"category",dataKey:"name",hide:!0}),(0,ee.jsx)(L.m,{formatter:e=>[(0,P.vv)(e),""]}),(0,ee.jsx)(G.y,{dataKey:"valor",fill:ue,radius:[4,4,4,4],label:{position:"right",formatter:e=>(0,P.vv)(e)}})]})})})]}),!Oe&&(0,ee.jsxs)(n.A,{sx:{display:"flex",alignItems:"center",gap:2,cursor:"pointer"},onClick:()=>o&&ct(o),children:[(0,ee.jsx)(l.A,{variant:"body2",sx:{minWidth:80},children:"Real:"}),(0,ee.jsx)(n.A,{sx:{flex:1,height:30},children:(0,ee.jsx)(H.u,{width:"100%",height:30,children:(0,ee.jsxs)(U.E,{data:[{name:e.mes,valor:e.real}],layout:"vertical",children:[(0,ee.jsx)(q.W,{type:"number",domain:[0,s],hide:!0}),(0,ee.jsx)(V.h,{type:"category",dataKey:"name",hide:!0}),(0,ee.jsx)(L.m,{formatter:e=>[(0,P.vv)(e),""]}),(0,ee.jsx)(G.y,{dataKey:"valor",fill:he,radius:[4,4,4,4],label:{position:"right",formatter:e=>(0,P.vv)(e)}})]})})})]})]})]},"".concat(e.mes,"-").concat(t))})})]}),(0,ee.jsxs)(v.A,{sx:{p:3},children:[(0,ee.jsx)(l.A,{variant:"h6",gutterBottom:!0,fontWeight:"600",children:"Tendencia del Resultado Mensual"}),(0,ee.jsx)(H.u,{width:"100%",height:300,children:(0,ee.jsxs)(J.b,{data:it,margin:{top:10,right:30,left:0,bottom:0},children:[(0,ee.jsx)("defs",{children:(0,ee.jsxs)("linearGradient",{id:"splitColor",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,ee.jsx)("stop",{offset:"50%",stopColor:"#4caf50",stopOpacity:.1}),(0,ee.jsx)("stop",{offset:"50%",stopColor:"#f44336",stopOpacity:.1})]})}),(0,ee.jsx)($.Gk,{dataKey:"superavit",fill:"url(#splitColor)",stroke:"none",yAxisId:"left"}),(0,ee.jsx)(X.N,{type:"monotone",dataKey:"superavit",stroke:"#2196f3",strokeWidth:2,dot:{r:6,cursor:"pointer"},activeDot:{r:8},yAxisId:"left",onClick:(e,t)=>{const s=Xe[t];s&&ct(s)}}),(0,ee.jsx)(Z.e,{y:0,stroke:"#666",strokeDasharray:"3 3",label:{value:"Punto de equilibrio",position:"right",fill:"#666",fontSize:12}}),(0,ee.jsx)(q.W,{dataKey:"mes"}),(0,ee.jsx)(V.h,{yAxisId:"left",domain:[e=>Math.min(e,0),e=>Math.max(e,0)],tickFormatter:e=>(0,P.vv)(e),width:70}),(0,ee.jsx)(L.m,{formatter:e=>[Number(e)>=0?"Super\xe1vit: ".concat((0,P.vv)(e)):"D\xe9ficit: ".concat((0,P.vv)(e)),"Resultado"],contentStyle:{color:"black"}}),(0,ee.jsx)(Q.s,{payload:[{value:"Resultado mensual",type:"line",color:"#2196f3"},{value:"Punto de equilibrio",type:"dashedLine",color:"#666"}]})]})})]})]}),1===Pe&&(0,ee.jsx)(v.A,{sx:{overflowX:"auto"},children:(0,ee.jsxs)(f.A,{sx:pe,children:[(0,ee.jsx)(y.A,{children:(0,ee.jsxs)(E.A,{children:[(0,ee.jsx)(w.A,{sx:Ae,children:"Mes"}),(0,ee.jsx)(w.A,{sx:Ae,children:"Ingreso Est."}),(0,ee.jsx)(w.A,{sx:Ae,children:"Ingreso Real"}),(0,ee.jsx)(w.A,{sx:Ae,children:"Egreso Est."}),(0,ee.jsx)(w.A,{sx:Ae,children:"Egreso Real"}),(0,ee.jsx)(w.A,{sx:Ae,children:"Resultado"}),(0,ee.jsx)(w.A,{sx:Ae,children:"Acciones"})]})}),(0,ee.jsx)(R.A,{children:Xe.length>0?Xe.map((e,t)=>{var s,r;const n=ie(e.ingresoEst),l=ie(e.ingresoReal),a=ie(e.egresoEst),i=ie(e.egresoReal),d=ie(null!==(s=e.totalReal)&&void 0!==s?s:l-i),u=ie(null!==(r=e.totalEst)&&void 0!==r?r:n-a),h=d-u,m=Math.abs(u)>0?h/Math.abs(u)*100:0;return(0,ee.jsxs)(E.A,{children:[(0,ee.jsxs)(w.A,{sx:ve,children:[e.mes,d<0&&(0,ee.jsx)(j.A,{size:"small",icon:(0,ee.jsx)(le.A,{fontSize:"small"}),sx:(0,o.A)({ml:1},ge),label:"Mes con d\xe9ficit"})]}),(0,ee.jsx)(w.A,{sx:ve,children:(0,P.vv)(n)}),(0,ee.jsx)(w.A,{sx:ve,children:(0,P.vv)(l)}),(0,ee.jsx)(w.A,{sx:ve,children:(0,P.vv)(a)}),(0,ee.jsx)(w.A,{sx:ve,children:(0,P.vv)(i)}),(0,ee.jsxs)(w.A,{sx:e=>(0,o.A)((0,o.A)({},ve(e)),{},{fontWeight:700,color:m>=0?"#66bb6a":"#ef5350"}),children:[(0,P.vv)(d)," ",(0,ee.jsxs)("span",{style:{color:m>=0?"#66bb6a":"#ef5350"},children:["(",m.toFixed(0),"%)"]})]}),(0,ee.jsx)(w.A,{sx:ve,children:(0,ee.jsx)(c.A,{direction:"row",spacing:1,children:(0,ee.jsx)(C.A,{size:"small",variant:"contained",onClick:()=>ct(e),children:"Ver mes"})})})]},e.mes||t)}):(0,ee.jsx)(E.A,{children:(0,ee.jsx)(w.A,{colSpan:7,sx:e=>(0,o.A)((0,o.A)({},ve(e)),{},{textAlign:"center",padding:"20px",color:(e.vars||e).palette.text.secondary}),children:"No hay datos mensuales con los filtros actuales."})})})]})}),(0,ee.jsx)(n.A,{mt:4,display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:1,children:(0,ee.jsx)(C.A,{variant:"outlined",onClick:()=>Ee(-1),children:"Volver"})}),(0,ee.jsx)(M.Ay,{anchor:"right",open:Ve,onClose:()=>Le(!1),children:(0,ee.jsxs)(n.A,{sx:{width:360,p:2},children:[(0,ee.jsxs)(c.A,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{mb:1},children:[(0,ee.jsx)(l.A,{variant:"h6",children:"Meses con mayor desv\xedo"}),(0,ee.jsx)(u.A,{onClick:()=>Le(!1),children:(0,ee.jsx)(ne.A,{})})]}),(0,ee.jsxs)(l.A,{variant:"body2",color:"text.secondary",sx:{mb:2},children:["Ingresos"===Ge&&"Ordenado por diferencia Ingreso Real vs Estimado.","Egresos"===Ge&&"Ordenado por diferencia Egreso Real vs Estimado.","resultado"===Ge&&"Ordenado por diferencia de Resultado Real vs Estimado."]}),(0,ee.jsx)(S.A,{dense:!0,children:dt.map((e,t)=>{var s,o;const r=ie(e.ingresoReal)-ie(e.ingresoEst),n=ie(e.egresoReal)-ie(e.egresoEst),l=ie(null!==(s=e.totalEst)&&void 0!==s?s:ie(e.ingresoEst)-ie(e.egresoEst)),a=ie(null!==(o=e.totalReal)&&void 0!==o?o:ie(e.ingresoReal)-ie(e.egresoReal)),i="Ingresos"===Ge?r:"egresos"===Ge?n:a-l;return(0,ee.jsx)(k.Ay,{secondaryAction:(0,ee.jsx)(C.A,{size:"small",variant:"text",onClick:()=>{Le(!1),ct(e)},children:"Ajustar mes"}),children:(0,ee.jsx)(I.A,{primary:e.mes,secondary:(0,ee.jsxs)("span",{style:{color:i>=0?"#66bb6a":"#ef5350"},children:[i>=0?"+":"-",(0,P.vv)(Math.abs(i))]})})},e.mes||t)})})]})})]})}},47436:(e,t,s)=>{s.d(t,{F:()=>l});var o=s(79722);const r=s(13658).A.REGISTRO;function n(){const e={},t=sessionStorage.getItem("sub"),s=sessionStorage.getItem("accessToken");return t&&(e["X-Usuario-Sub"]=t),s&&(e.Authorization="Bearer ".concat(s)),e}async function l(e){let{fechaDesde:t,fechaHasta:s,tipos:l}=e;const a=new URLSearchParams;a.set("page",0),a.set("size",500),t&&a.set("fechaDesde",t),s&&a.set("fechaHasta",s),Array.isArray(l)&&l.length>0?a.set("tipos",l.join(",")):"string"===typeof l&&l&&a.set("tipos",l);const i="".concat(r,"/movimientos?").concat(a.toString()),{data:c}=await o.A.get(i,{headers:n()});return c}}}]);
//# sourceMappingURL=7006.2072b1d8.chunk.js.map