"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[8875],{78875:(e,o,r)=>{r.r(o),r.d(o,{default:()=>C});var s=r(89379),t=r(65043),a=r(55895),n=r(53089),i=r(91449),c=r(32911),l=r(79722),m=r(23892),d=r(53969),u=r(80172),f=r(70579);const h=e=>{let{children:o}=e;return(0,f.jsx)(t.Suspense,{fallback:(0,f.jsx)(d.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:200,width:"100%"},children:(0,f.jsx)(u.A,{size:40})}),children:o})};var p=r(13658),v=r(60446),g=r.n(v);const j=t.lazy(()=>Promise.all([r.e(7060),r.e(2815),r.e(2793),r.e(8051)]).then(r.bind(r,58051))),x=t.lazy(()=>Promise.all([r.e(7060),r.e(2815),r.e(2793),r.e(9599)]).then(r.bind(r,61980))),D=t.lazy(()=>Promise.all([r.e(7060),r.e(2815),r.e(2793),r.e(2188)]).then(r.bind(r,82188))),y=t.lazy(()=>Promise.all([r.e(7060),r.e(2815),r.e(2793),r.e(2428)]).then(r.bind(r,52428))),b=t.lazy(()=>Promise.all([r.e(7060),r.e(2815),r.e(2793),r.e(4214)]).then(r.bind(r,74214))),E=t.lazy(()=>Promise.all([r.e(7060),r.e(2815),r.e(2793),r.e(8182)]).then(r.bind(r,78182))),A={Factura:["numeroDocumento","versionDocumento","tipoFactura","fechaEmision","montoTotal","categoria","vendedorNombre","compradorNombre"],Movimiento:["montoTotal","fechaEmision"],Ingreso:["montoTotal","fechaEmision"],Egreso:["montoTotal","fechaEmision"],Deuda:["montoTotal","fechaEmision"],Acreencia:["montoTotal","fechaEmision"]};function C(e){let{tipoDoc:o,endpoint:r,formData:d,setFormData:u,errors:v,setErrors:C}=e;const[w,S]=t.useState(v),[F,T]=t.useState({open:!1,severity:"info",message:""}),[k,z]=t.useState({open:!1,message:""});t.useEffect(()=>{u(e=>{const o=e||{};return"ARS"===o.moneda?o:(0,s.A)((0,s.A)({},o),{},{moneda:"ARS"})})},[u]),t.useEffect(()=>{if(!k.open)return;const e=setTimeout(()=>z({open:!1,message:""}),3500);return()=>clearTimeout(e)},[k.open]),t.useEffect(()=>{S(v)},[v]),t.useEffect(()=>{C(w)},[w,C]);const P=t.useCallback(e=>{const o={};return Object.entries(e||{}).forEach(e=>{let[r,s]=e;g().isDayjs(s)?o[r]=s.format("YYYY-MM-DD"):Array.isArray(s)?o[r]=s.map(e=>g().isDayjs(e)?e.format("YYYY-MM-DD"):null!==e&&void 0!==e?e:""):o[r]=s&&"object"===typeof s||null!==s&&void 0!==s?s:""}),o.moneda="ARS",o},[]);return(0,f.jsxs)(n.A,{sx:{mt:3,width:"100%"},children:[(()=>{switch(o){case"factura":return(0,f.jsx)(h,{children:(0,f.jsx)(j,{formData:d,setFormData:u,errors:w})});case"movimiento":return(0,f.jsx)(h,{children:(0,f.jsx)(x,{tipoDoc:o,formData:d,setFormData:u,errors:w})});case"ingreso":return(0,f.jsx)(h,{children:(0,f.jsx)(D,{formData:d,setFormData:u,errors:w})});case"egreso":return(0,f.jsx)(h,{children:(0,f.jsx)(y,{formData:d,setFormData:u,errors:w})});case"deuda":return(0,f.jsx)(h,{children:(0,f.jsx)(b,{formData:d,setFormData:u,errors:w})});case"acreencia":return(0,f.jsx)(h,{children:(0,f.jsx)(E,{formData:d,setFormData:u,errors:w})});default:return(0,f.jsxs)(a.A,{children:["No hay formulario definido para ",o]})}})(),(0,f.jsx)(m.A,{label:"Enviar ".concat(o),width:"100%",onClick:async()=>{const e={};if((A[o]||[]).forEach(o=>{d[o]||(e[o]="Campo obligatorio")}),C(e),Object.keys(e).length>0)alert("\u26a0\ufe0f Por favor completa todos los campos obligatorios");else try{const e=sessionStorage.getItem("sub");if(!e)return void alert("\u274c Error: No se encontr\xf3 el usuario en la sesi\xf3n. Por favor, inicia sesi\xf3n nuevamente.");const r={"X-Usuario-Sub":e},s=P(d);let t,a=null;["ingreso","egreso","deuda","acreencia"].includes(o.toLowerCase())?(a=o.charAt(0).toUpperCase()+o.slice(1),t={tipo:"movimiento",metodo:"formulario",datos:s,tipoMovimiento:a}):t="factura"===o.toLowerCase()?{tipo:"factura",metodo:"formulario",datos:s}:{tipo:"movimiento",metodo:"formulario",datos:s},console.log("\ud83d\udce4 Enviando datos:",t),console.log("\ud83d\udd10 Headers:",r);const n="".concat(p.A.REGISTRO,"/api/carga-datos"),i=await l.A.post(n,t,{headers:r});console.log("\u2705 Respuesta del servidor:",i.data),z({open:!0,message:i.data.mensaje||"Datos guardados exitosamente"}),u({}),S({})}catch(t){var r,s;console.error("\u274c Error en env\xedo:",t);const e=(null===(r=t.response)||void 0===r||null===(s=r.data)||void 0===s?void 0:s.mensaje)||t.message||"Error desconocido";T({open:!0,severity:"error",message:e})}}}),k.open&&(0,f.jsx)(i.A,{severity:"success",variant:"outlined",sx:{width:"100%",mt:2},onClose:()=>z({open:!1,message:""}),children:k.message}),(0,f.jsx)(c.A,{open:F.open,autoHideDuration:4e3,onClose:()=>T({open:!1,severity:"info",message:""}),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:(0,f.jsx)(i.A,{onClose:()=>T({open:!1,severity:"info",message:""}),severity:F.severity,variant:"filled",sx:{width:"100%"},children:F.message})})]})}}}]);
//# sourceMappingURL=8875.2515c769.chunk.js.map