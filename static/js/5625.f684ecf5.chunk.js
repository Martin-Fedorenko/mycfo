"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[5625],{45625:(e,r,t)=>{t.r(r),t.d(r,{default:()=>x});var o=t(65043),n=t(53969),i=t(55895),s=t(91449),a=t(95315),l=t(82394),c=t(66185),d=t(46898),u=t(23892),p=t(79722),h=t(70579);function x(e){var r,t;let{tipoDoc:x,endpoint:v}=e;const[m,A]=(0,o.useState)(null),[g,b]=(0,o.useState)(""),[f,j]=(0,o.useState)(!1),[y,C]=(0,o.useState)(null),S="string"===typeof x&&x.length?x.charAt(0).toUpperCase()+x.slice(1):"registro";return(0,h.jsxs)(n.A,{sx:{mt:3},children:[(0,h.jsxs)(i.A,{variant:"subtitle1",sx:{mb:1},children:["Carg\xe1 un archivo Excel o CSV con tus ",S]}),(0,h.jsx)(d.A,{onFileSelected:e=>{A(e),b(""),C(null)},width:"100%",height:140,accept:{"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[],"application/vnd.ms-excel":[],"text/csv":[],"application/csv":[]}}),(0,h.jsx)(u.A,{label:f?"Subiendo...":"Subir documento",width:"100%",sx:{mt:2},onClick:async()=>{if(!m)return void b("Seleccion\xe1 un archivo Excel o CSV antes de continuar.");if(!v)return void b("No se encontr\xf3 el endpoint de carga para este tipo.");const e=sessionStorage.getItem("sub");if(e)try{j(!0),b("");const r=new FormData;r.append("file",m);const t="string"===typeof v?v.toLowerCase():"";t.includes("/movimientos/documento")&&!t.includes("/facturas/")&&r.append("tipoMovimiento",x);const o={"X-Usuario-Sub":e},{data:n}=await p.A.post(v,r,{headers:o});C(n)}catch(i){var r,t,o,n;console.error("\u274c Error en env\xedo:",i);const e=(null===(r=i.response)||void 0===r||null===(t=r.data)||void 0===t?void 0:t.mensaje)||(null===(o=i.response)||void 0===o||null===(n=o.data)||void 0===n?void 0:n.error)||i.message||"Ocurri\xf3 un error al procesar el archivo.";b(e)}finally{j(!1)}else b("No se encontr\xf3 la sesi\xf3n del usuario. Inici\xe1 sesi\xf3n nuevamente para continuar.")},disabled:f}),g&&(0,h.jsx)(s.A,{severity:"error",sx:{mt:2},children:g}),y&&(0,h.jsxs)(n.A,{sx:{mt:3,p:2,border:"1px solid",borderColor:"divider",borderRadius:2},children:[(0,h.jsx)(i.A,{variant:"subtitle1",sx:{mb:1,fontWeight:600},children:"Resumen de la importaci\xf3n"}),(0,h.jsxs)(i.A,{variant:"body2",children:["Total de filas procesadas: ",null!==(r=y.totalFilas)&&void 0!==r?r:0]}),(0,h.jsxs)(i.A,{variant:"body2",children:["Movimientos guardados: ",null!==(t=y.registrosCargados)&&void 0!==t?t:0]}),Array.isArray(y.errores)&&y.errores.length>0&&(0,h.jsxs)(n.A,{sx:{mt:2},children:[(0,h.jsxs)(i.A,{variant:"subtitle2",sx:{fontWeight:600},children:["Errores detectados (",y.errores.length,")"]}),(0,h.jsx)(a.A,{dense:!0,children:y.errores.map((e,r)=>(0,h.jsx)(l.Ay,{children:(0,h.jsx)(c.A,{primary:"Fila ".concat(e.fila,": ").concat(e.mensaje)})},"".concat(e.fila,"-").concat(r)))})]})]})]})}},46898:(e,r,t)=>{t.d(r,{A:()=>x});var o=t(89379),n=t(65043),i=t(8789),s=t(53969),a=t(94799),l=t(55895),c=t(56647),d=t(60267),u=t(51697),p=t(5362),h=t(70579);function x(e){let{onFileSelected:r,initialFile:t=null,width:x="100%",height:v=100,accept:m}=e;const A=(0,d.A)(),[g,b]=(0,n.useState)(t),f=(0,n.useCallback)(e=>{if(e.length>0){const t=e[0];b(t),null===r||void 0===r||r(t)}},[r]),{getRootProps:j,getInputProps:y,isDragActive:C}=(0,i.VB)({onDrop:f,multiple:!1,accept:m||void 0});return(0,n.useEffect)(()=>{t&&b(t)},[t]),(0,h.jsxs)(s.A,{sx:{width:x},children:[(0,h.jsxs)(a.A,(0,o.A)((0,o.A)({variant:"outlined"},j()),{},{sx:(0,o.A)({width:"100%",height:v,p:3,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",textAlign:"center",border:"2px dashed",borderColor:C?"primary.main":"grey.400",bgcolor:C?"grey.100":"inherit",cursor:"pointer"},"dark"===A.palette.mode&&{borderColor:C?"primary.light":"grey.700",bgcolor:C?"grey.900":"inherit"}),children:[(0,h.jsx)("input",(0,o.A)({},y())),(0,h.jsx)(u.A,{sx:{fontSize:60,mb:1},color:"action"}),C?(0,h.jsx)(l.A,{variant:"body1",children:"Suelta el archivo aqu\xed..."}):(0,h.jsx)(l.A,{variant:"body1",children:"Arrastr\xe1 y solt\xe1 un archivo aqu\xed o hac\xe9 clic para seleccionarlo"})]})),g&&(0,h.jsxs)(s.A,{sx:(0,o.A)({mt:2,width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",p:1.5,border:"1px solid",borderColor:"grey.300",borderRadius:1},"dark"===A.palette.mode&&{borderColor:"grey.700"}),children:[(0,h.jsx)(l.A,{variant:"body2",children:g.name}),(0,h.jsx)(c.A,{onClick:()=>{b(null),null===r||void 0===r||r(null)},size:"small",color:"error",children:(0,h.jsx)(p.A,{})})]})]})}}}]);
//# sourceMappingURL=5625.f684ecf5.chunk.js.map